const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TodoList-lD_hLxSo.js","assets/index-EIBSd4Hj.js","assets/react-kX_YxI4E.js","assets/dom-to-image-more-CfDXlNbO.js","assets/react-dom-B5MLDbn_.js","assets/scheduler-CzFDRTuY.js","assets/react-redux-BEmJlIGA.js","assets/hoist-non-react-statics-DQogQWOa.js","assets/react-is-DUDD-a5e.js","assets/use-sync-external-store-BPp6CH6k.js","assets/@reduxjs-DhFEcpJw.js","assets/immer-C0GRqQ_d.js","assets/redux-CE3tqztX.js","assets/@babel-DF5_wy6Y.js","assets/redux-thunk-CY0Q9z1Q.js","assets/axios-CCb-kr4I.js","assets/react-icons-D7bD3W54.js","assets/react-router-dom-StiqOUIT.js","assets/react-router-DUuhLvki.js","assets/@remix-run-DTnHqtaE.js","assets/index-Dgb_yWai.css"])))=>i.map(i=>d[i]);
import{u as ue,i as he,bp as ye,bq as _,o as p,br as Te,bs as K,bt as f,bu as be,bv as F,bw as Se,bx as xe,by as we,bz as W,bA as g,bB as Ee,bC as Ne,bD as je,bE as ve,bF as Ce,bG as _e,d as ge,bH as Oe,e as q,_ as ke,bI as B,bJ as H,bK as U,bL as Y,bM as Ae,bN as Ie,bO as $e,bP as De,bQ as J,bR as Pe,bS as Fe,bT as Je}from"./index-EIBSd4Hj.js";import{r as c,j as n}from"./react-kX_YxI4E.js";import{a as O}from"./react-redux-BEmJlIGA.js";import{x as Le}from"./react-icons-D7bD3W54.js";import{v as ze}from"./uuid-Dv1xt2bl.js";import"./react-dom-B5MLDbn_.js";import"./dom-to-image-more-CfDXlNbO.js";import"./scheduler-CzFDRTuY.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";const Re=c.lazy(()=>ke(()=>import("./TodoList-lD_hLxSo.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))),S=300;function dt({language:r}){const o=ue(),a=O(e=>{var t;return(t=e.auth)==null?void 0:t.user});c.useEffect(()=>{o(he())},[]);const i=O(e=>e.todos.todos),k=O(e=>e.todos.status),L=O(e=>e.todos.error),[j,G]=c.useState("low"),[z,Me]=c.useState(""),[A,Q]=c.useState("other"),[x,V]=c.useState("all"),[w,X]=c.useState("all"),T="ReactTodos",Z=i==null?void 0:i.some(e=>e.complete);c.useEffect(()=>{if(i.length===0&&!a){const e=JSON.parse(window.localStorage.getItem(T)||"[]"),t=new Set(i.map(s=>s.key));e.forEach(s=>{t.has(s.key)||o(ye(s))})}},[o,i,a]),c.useEffect(()=>{window.localStorage.setItem(T,JSON.stringify(i))},[i]);const ee=e=>{const t=new Set,s=[];return e.forEach(l=>{t.has(l.key)?s.push(l):t.add(l.key)}),s},te=e=>{if(!e){o(p("Error: no key",!0,8));return}if(a!=null&&a._id)o(B(a._id,e));else{o(H(e));const t=i.filter(s=>s.key!==e);window.localStorage.setItem(T,JSON.stringify(t))}};c.useEffect(()=>{const e=ee(i),t=new Set;e.forEach(s=>{t.has(s.key)||(te(s.key),t.add(s.key))})},[i]);const[E,se]=c.useState([]),I=i.filter(e=>{const t=x==="all"||e.priority===x,s=w==="all"||e.category===w;return t&&s});c.useEffect(()=>{const e=I==null?void 0:I.slice().sort((t,s)=>(t.order??0)-(s.order??0)).map(t=>({...t,id:t.order,status:"todos"}));se(e)},[i,x,w]);const oe=["all","low","medium","high"],re=["all","work","personal","shopping","other"],ae=["low","medium","high"],ie=["work","personal","shopping","other"],$=_(oe,r),D=_(re,r),v=_(ae,r),C=_(ie,r);c.useEffect(()=>{k==="failed"&&o(p(`There was an error: ${L}`,!0,8))},[k,L,o]);const[R,u]=c.useState(!1);c.useEffect(()=>{a!=null&&a._id&&o(Te(a._id)).then(()=>{o(K(a._id))}).catch(e=>{var t,s;console.error(e),(s=(t=e.response)==null?void 0:t.data)!=null&&s.message?o(p(e.response.data.message,!0,8)):o(p(`${e.message}`,!0,8))})},[a==null?void 0:a._id]);function ne(e){const t=i.find(s=>s.key===e);if(t){const s={...t,complete:!t.complete};o(a?U(a._id,e,s):Y(s))}}const de=async(e,t,s,l,y)=>{if(u(!0),!e){o(p("Error: no key",!0,8)),u(!1);return}const m=i.find(d=>d.key===e);if(m){const d={...m,name:t,priority:s,deadline:l,category:y};if(a)await o(U(a._id,e,d)).then(()=>{o(p(`${Ae[r]}`,!1,3)),u(!1)}).catch(h=>{var N,M;console.error(h),(M=(N=h.response)==null?void 0:N.data)!=null&&M.message?o(p(h.response.data.message,!0,8)):o(p(`${h}`,!0,8)),u(!1)});else{o(Y(d));const h=i.map(N=>N.key===e?d:N);window.localStorage.setItem(T,JSON.stringify(h)),u(!1)}}},le=e=>{var t,s;if(a)o(async l=>{var y,m;try{await Ie(a._id,e).then(()=>{l(K(a._id))})}catch(d){console.error(d),(m=(y=d.response)==null?void 0:y.data)!=null&&m.message?l(p(d.response.data.message,!0,8)):l(p(`${d}`,!0,8))}});else try{o($e(e))}catch(l){console.error(l),(s=(t=l.response)==null?void 0:t.data)!=null&&s.message?o(p(l.response.data.message,!0,8)):o(p(`${l}`,!0,8))}finally{window.localStorage.setItem(T,JSON.stringify(i))}},P=c.useRef(null),[b,ce]=c.useState(""),fe=e=>{if(e.preventDefault(),u(!0),b===""){u(!1),o(p(F[r],!0,3));return}if(b.length>S){u(!1),o(p(`${W[r]} (${S} max)`,!0,8));return}const t=ze(),s=i.reduce((m,d)=>d.order>m?d.order:m,0),l=i.reduce((m,d)=>d.order<m?d.order:m,0);let y;if(j==="high"?y={key:t,name:b,complete:!1,order:l-1,priority:j,deadline:z,category:A}:y={key:t,name:b,complete:!1,order:s+1,priority:j,deadline:z,category:A},a)o(De(a._id,y)),u(!1);else{const m=[...i,y].sort((d,h)=>d.order-h.order).map((d,h)=>({...d,order:h}));o(J(m)),window.localStorage.setItem(T,JSON.stringify(m)),J(m),u(!1)}P.current&&(P.current.value="")};async function me(e){if(e.preventDefault(),window.confirm(Pe[r]))if(a)await o(Fe(a._id));else{o(Je());const t=i.filter(s=>!s.complete);window.localStorage.setItem(T,JSON.stringify(t))}}function pe(e){if(!e){o(p("Error: no key",!0,8));return}if(a!=null&&a._id)o(B(a._id,e));else{o(H(e));let t=i.filter(s=>s.key!==e);t=t.map((s,l)=>({...s,order:l+1})),o(J(t)),window.localStorage.setItem(T,JSON.stringify(t))}}return n.jsxs(n.Fragment,{children:[n.jsx("form",{onSubmit:fe,className:f.form,children:n.jsxs("fieldset",{children:[n.jsx("legend",{className:"scr",children:be[r]}),n.jsxs("div",{className:f["todo-input-area"],children:[n.jsx("label",{htmlFor:"taskinput",children:F[r]}),n.jsx("textarea",{ref:P,id:"taskinput",className:"bg",rows:3,name:"task",value:b,onChange:e=>ce(e.target.value),required:!0,autoComplete:"off",placeholder:`${Se[r]}...`}),n.jsxs("p",{className:f.small,children:[S-b.length," ",xe[r]," (",we[r],":"," ",S,")"," ",b.length>S&&n.jsx("span",{className:f.warning,children:W[r]})]}),n.jsx(g,{z:E.length+5,id:"category",className:`${f.select} ${f["category-select"]}`,hideDelete:!0,instructions:Ee[r],value:C.find(e=>e.value===A)||C[0],onChange:e=>Q(e==null?void 0:e.value),options:C,language:r}),n.jsx(g,{id:"priority",className:f.select,hideDelete:!0,instructions:Ne[r],value:v.find(e=>e.value===j)||v[0],onChange:e=>G(e==null?void 0:e.value),options:v,language:r,z:E.length+4}),n.jsxs("button",{id:f["submit-todo"],className:f["submit-todo"],type:"submit",disabled:R,children:[F[r]," ",n.jsx(Le,{})]})]})]})}),n.jsxs("div",{className:f["controls-wrap"],children:[n.jsx(g,{id:"category-filter",className:`${f.select} ${f["category-select"]}`,hideDelete:!0,instructions:je[r],value:D.find(e=>e.value===w)||D[0],onChange:e=>X(e==null?void 0:e.value),options:D,language:r,z:E.length+3}),n.jsx(g,{id:"priority-filter",className:f.select,hideDelete:!0,instructions:ve[r],value:$.find(e=>e.value===x)||$[0],onChange:e=>V(e==null?void 0:e.value),options:$,language:r,z:E.length+2}),n.jsx("button",{className:`danger ${f["clear-completed"]}`,disabled:!Z,onClick:e=>me(e),children:Ce[r]})]}),n.jsxs("div",{className:f["list-wrap"],children:[n.jsxs("p",{className:f["left-to-do"],children:[i==null?void 0:i.filter(e=>!(e!=null&&e.complete)).length," ",_e[r]]}),(x!=="all"||w!=="all")&&n.jsxs("p",{className:f["filter-notification"],children:[ge[r]," ",Oe[r]]}),n.jsx(c.Suspense,{fallback:n.jsxs("p",{className:"flex center margin0auto textcenter",children:[q[r],"..."]}),children:n.jsx(Re,{sending:R,todosWithIdAndStatus:E,toggleTodo:ne,deleteTodo:pe,language:r,modifyTodo:de,modifyTodoOrder:le,priorityOptions:v,categoryOptions:C,maxCharacters:S})}),k==="loading"&&n.jsxs("p",{className:"flex center margin0auto textcenter",children:[q[r],"..."]})]})]})}export{dt as default};
