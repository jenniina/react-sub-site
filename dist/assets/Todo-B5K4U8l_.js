import{r as m,j as i}from"./react-A9DAvxly.js";import{dp as ne,an as G,ar as L,dq as oe,dr as ie,E as le,u as I,n as b,t as ce}from"./AccessibleColors-CRBQVtI_.js";import{A as de}from"./Accordion-DsZcHxu2.js";import{E as ue}from"./UserEdit-CMC3bHRb.js";import{aY as fe,F as pe}from"./react-icons-5ULj0WcV.js";import{u as me}from"./DragAndDrop-BVfMHRnl.js";import{c as he}from"./@reduxjs-DhFEcpJw.js";import{a as J}from"./axios-CCb-kr4I.js";import{a as Z}from"./react-redux-CHm9GgGE.js";import{a as ye}from"./Blob-DEVQxHac.js";import{v as ve}from"./uuid-Dv1xt2bl.js";const ge="http://localhost:4000",F=`${ge}/api/todo`,be=async e=>(await J.get(`${F}/${e}`)).data,we=async(e,t)=>(await J.put(`${F}/${e}`,t)).data,je=async(e,t)=>(await J.post(`${F}/${e}`,t)).data,xe=async(e,t)=>(await J.delete(`${F}/${e}/${t}`)).data,Se=async(e,t,s)=>(await J.put(`${F}/${e}/${t}`,s)).data,ke=async e=>(await J.delete(`${F}/${e}`)).data,_e=async(e,t)=>(await J.post(`${F}/${e}/order`,{todos:t})).data,O={getTodos:be,updateAllTodos:we,addTodo:je,deleteTodo:xe,editTodo:Se,clearCompletedTodos:ke,editTodoOrder:_e},$e={todos:[],status:"idle",error:null},A=he({name:"todos",initialState:$e,reducers:{getTodosStart:e=>{e.status="loading"},getTodosSuccess:(e,t)=>{e.status="idle",e.todos=t.payload},getTodosFailure:(e,t)=>{e.status="failed",e.error=t.payload},addTodo:(e,t)=>({...e,todos:[...e.todos,t.payload]}),deleteTodo:(e,t)=>{e.todos=e.todos.filter(s=>s.key!==t.payload)},clearCompletedTodos:e=>{e.todos=e.todos.filter(t=>!t.complete)},editTodo:(e,t)=>{const s=e.todos.findIndex(a=>a.key===t.payload.key);s!==-1&&(e.todos[s]=t.payload)},changeTodoOrder:(e,t)=>{const s=e.todos.map(a=>{const l=t.payload.find(p=>p.key===a.key);return l?{...a,order:l.order}:a});s.sort((a,l)=>a.order-l.order),e.todos=s},setAllTodos:(e,t)=>{e.todos=t.payload}}}),Ne=e=>async(t,s)=>{t(Pe());try{const a=await O.getTodos(e);let l=s().todos.todos;a&&(l=[...a,...l.filter(f=>!a.find(k=>k.key===f.key))]),l=l.filter(f=>f!==null);const p=await O.updateAllTodos(e,l);return t(C(p)),p}catch(a){console.error(a),t(B(a.message))}},ze=(e,t)=>async s=>{const a=await O.addTodo(e,t);s(U({key:a.key,name:a.name,complete:a.complete,order:a.order,user:e}))},Oe=async(e,t)=>await O.editTodoOrder(e,t),W=(e,t)=>async s=>{const a=await O.deleteTodo(e,t);return s(T(t)),a},Y=e=>async t=>{t(T(e))},qe=e=>async(t,s)=>{await O.clearCompletedTodos(e),t(E())},R=(e,t,s)=>async a=>{const l=await O.editTodo(e,t,s);a(D({key:l.key,name:l.name,complete:l.complete,order:l.order,user:e}))},Me=e=>async(t,s)=>{try{const a=await O.getTodos(e),l=s().todos.todos,p=[...a,...l.filter(k=>!a.some(M=>M.key===k.key))],f=await O.updateAllTodos(e,p);t(C(f))}catch(a){console.error(a),t(B(a.message))}},{getTodosStart:Pe,getTodosSuccess:C,getTodosFailure:B,addTodo:U,deleteTodo:T,clearCompletedTodos:E,editTodo:D,changeTodoOrder:Je,setAllTodos:Fe}=A.actions,lt=A.reducer;var ee=(e=>(e.en="Clear Completed Tasks",e.es="Borrar Tareas Completadas",e.fr="Effacer les Tâches Terminées",e.de="Abgeschlossene Aufgaben Löschen",e.pt="Limpar Tarefas Completas",e.cs="Vymazat Dokončené Úkoly",e.fi="Poista valmiit tehtävät",e))(ee||{}),Q=(e=>(e.en="Add Task",e.es="Agregar Tarea",e.fr="Ajouter une Tâche",e.de="Aufgabe hinzufügen",e.pt="Adicionar Tarefa",e.cs="Přidat Úkol",e.fi="Lisää tehtävä",e))(Q||{}),X=(e=>(e.en="Task",e.es="Tarea",e.fr="Tâche",e.de="Aufgabe",e.pt="Tarefa",e.cs="Úkol",e.fi="Tehtävä",e))(X||{}),te=(e=>(e.en="left to do",e.es="restantes",e.fr="restantes",e.de="übrig",e.pt="restantes",e.cs="zbývá",e.fi="jäljellä",e))(te||{}),ae=(e=>(e.en="Add task to the task list",e.es="Agregar tarea a la lista de tareas",e.fr="Ajouter une tâche à la liste des tâches",e.de="Aufgabe zur Aufgabenliste hinzufügen",e.pt="Adicionar tarefa à lista de tarefas",e.cs="Přidat úkol do seznamu úkolů",e.fi="Lisää tehtävä tehtäväluetteloon",e))(ae||{}),Ke=(e=>(e.en="Todo App",e.es="Aplicación de Tareas",e.fr="Application de Tâches",e.de="Aufgaben App",e.pt="Aplicativo de Tarefas",e.cs="Úkolová Aplikace",e.fi="Tehtäväsovellus",e))(Ke||{}),Ve=(e=>(e.en="Get organized, one task at a time!",e.es="¡Organízate, una tarea a la vez!",e.fr="Organisez-vous, une tâche à la fois!",e.de="Organisieren Sie sich, eine Aufgabe nach der anderen!",e.pt="Organize-se, uma tarefa de cada vez!",e.cs="Zorganizujte se, jedna úloha za druhou!",e.fi="Järjestäydy, yksi tehtävä kerrallaan!",e))(Ve||{}),Ze=(e=>(e.en="Remove task either individually or clear all completed tasks at once",e.es="Eliminar la tarea individualmente o borrar todas las tareas completadas a la vez",e.fr="Supprimer la tâche individuellement ou effacer toutes les tâches terminées à la fois",e.de="Entfernen Sie die Aufgabe einzeln oder löschen Sie alle abgeschlossenen Aufgaben auf einmal",e.pt="Remover tarefa individualmente ou limpar todas as tarefas concluídas de uma só vez",e.cs="Odstraňte úkol buď jednotlivě, nebo všechny dokončené úkoly najednou",e.fi="Poista tehtävä joko yksittäin tai poista kaikki valmiit tehtävät kerralla",e))(Ze||{}),Ue=(e=>(e.en="Shows how many tasks are left to do",e.es="Muestra cuántas tareas quedan por hacer",e.fr="Montre combien de tâches il reste à faire",e.de="Zeigt an, wie viele Aufgaben noch zu erledigen sind",e.pt="Mostra quantas tarefas restam para fazer",e.cs="Ukazuje, kolik úkolů zbývá",e.fi="Näyttää, kuinka monta tehtävää on jäljellä",e))(Ue||{}),De=(e=>(e.en="Stores tasks in MongoDB if the user is logged in",e.es="Almacena las tareas en MongoDB si el usuario ha iniciado sesión",e.fr="Stocke les tâches dans MongoDB si l'utilisateur est connecté",e.de="Speichert Aufgaben in MongoDB, wenn der Benutzer angemeldet ist",e.pt="Armazena tarefas no MongoDB se o usuário estiver conectado",e.cs="Pokud je uživatel přihlášen, uloží úkoly do MongoDB",e.fi="Säilyttää tehtävät MongoDB:ssä, jos käyttäjä on kirjautunut sisään",e))(De||{}),Qe=(e=>(e.en="Add tasks by tabbing to the input field and pressing either Enter or by tabbing to the Add Task button and pressing Space",e.es="Agregue tareas haciendo clic en el campo de entrada y presionando Enter o haciendo clic en el botón Agregar tarea y presionando Espacio",e.fr="Ajoutez des tâches en cliquant sur le champ de saisie et en appuyant sur Entrée ou en cliquant sur le bouton Ajouter une tâche et en appuyant sur Espace",e.de="Fügen Sie Aufgaben hinzu, indem Sie auf das Eingabefeld klicken und die Eingabetaste drücken oder auf die Schaltfläche Aufgabe hinzufügen klicken und die Leertaste drücken",e.pt="Adicione tarefas clicando no campo de entrada e pressionando Enter ou clicando no botão Adicionar tarefa e pressionando Espaço",e.cs="Přidejte úkoly klepnutím na vstupní pole a stisknutím klávesy Enter nebo klepnutím na tlačítko Přidat úkol a stisknutím mezerníku",e.fi="Lisää tehtäviä siirtymällä syöttökenttään, kirjoittamalla ja painamalla Enter tai tai kirjoitettuasi siirtymällä Lisää tehtävä -painikkeeseen ja painamalla välilyöntiä",e))(Qe||{}),Xe=(e=>(e.en="Remove a task by tabbing to the remove-button and pressing Space, or remove all completed tasks by pressing Space on the Clear Completed Tasks button",e.es="Elimine una tarea haciendo clic en el botón Eliminar y presionando Espacio, o elimine todas las tareas completadas presionando Espacio en el botón Borrar tareas completadas",e.fr="Supprimez une tâche en cliquant sur le bouton Supprimer et en appuyant sur Espace, ou supprimez toutes les tâches terminées en appuyant sur Espace sur le bouton Effacer les tâches terminées",e.de="Entfernen Sie eine Aufgabe, indem Sie auf die Schaltfläche Entfernen klicken und die Leertaste drücken, oder entfernen Sie alle abgeschlossenen Aufgaben, indem Sie die Leertaste auf die Schaltfläche Abgeschlossene Aufgaben löschen drücken",e.pt="Remova uma tarefa clicando no botão Remover e pressionando Espaço, ou remova todas as tarefas concluídas pressionando Espaço no botão Limpar tarefas concluídas",e.cs="Odstraňte úkol klepnutím na tlačítko Odstranit a stisknutím mezerníku nebo odstraňte všechny dokončené úkoly stisknutím mezerníku na tlačítku Vymazat dokončené úkoly",e.fi="Poista tehtävä napsauttamalla Poista-painiketta ja painamalla välilyöntiä tai poista kaikki valmiit tehtävät painamalla välilyöntiä Poista valmiit tehtävät -painikkeessa",e))(Xe||{}),se=(e=>(e.en="Delete Task",e.es="Eliminar Tarea",e.fr="Supprimer la Tâche",e.de="Aufgabe Löschen",e.pt="Excluir Tarefa",e.cs="Odstranit Úkol",e.fi="Poista Tehtävä",e))(se||{}),He=(e=>(e.en="Tasks can be edited",e.es="Las tareas se pueden editar",e.fr="Les tâches peuvent être modifiées",e.de="Aufgaben können bearbeitet werden",e.pt="As tarefas podem ser editadas",e.cs="Úkoly lze upravit",e.fi="Tehtäviä voi muokata",e))(He||{}),Ge=(e=>(e.en="Tasks can be reorganized by dragging and dropping",e.es="Las tareas se pueden reorganizar arrastrando y soltando",e.fr="Les tâches peuvent être réorganisées par glisser-déposer",e.de="Aufgaben können durch Ziehen und Ablegen neu organisiert werden",e.pt="As tarefas podem ser reorganizadas arrastando e soltando",e.cs="Úkoly lze přeuspořádat přetažením a upuštěním",e.fi="Tehtäviä voi järjestellä raahaamalla ja pudottamalla",e))(Ge||{}),re=(e=>(e.en="Are you sure you want to clear all completed tasks?",e.es="¿Estás seguro de que quieres borrar todas las tareas completadas?",e.fr="Êtes-vous sûr de vouloir effacer toutes les tâches terminées?",e.de="Möchten Sie wirklich alle abgeschlossenen Aufgaben löschen?",e.pt="Tem certeza de que deseja limpar todas as tarefas concluídas?",e.cs="Opravdu chcete vymazat všechny dokončené úkoly?",e.fi="Oletko varma, että haluat poistaa kaikki valmiit tehtävät?",e))(re||{});const Le="_form_155x1_1",We="_closed_155x1_171",Ye="_open_155x1_187",Re="_modify_155x1_171",h={form:Le,"list-wrap":"_list-wrap_155x1_31","todo-input-area":"_todo-input-area_155x1_37","todo-ul":"_todo-ul_155x1_49","drag-handle":"_drag-handle_155x1_83","btn-wrap":"_btn-wrap_155x1_139",closed:We,"modify-todo":"_modify-todo_155x1_171",open:Ye,delete:"_delete_155x1_241","left-to-do":"_left-to-do_155x1_265",modify:Re};function Ie({todo:e,toggleTodo:t,deleteTodo:s,language:a,modifyTodo:l,isDragging:p,handleUpdate:f,handleDragging:k,sending:M}){const[q,$]=m.useState((e==null?void 0:e.name)??""),[w,N]=m.useState(!1);function u(){t(e==null?void 0:e.key)}function v(){window.confirm(ue[a]+' "'+(e==null?void 0:e.name)+'"?')&&($(""),s(e==null?void 0:e.key),N(!1))}const g=c=>{c.preventDefault(),l(e==null?void 0:e.key,q),N(!1)},K=c=>{$(c.target.value)};m.useEffect(()=>{(e==null?void 0:e.name)!==q&&$((e==null?void 0:e.name)||"")},[e]);const[z,j]=m.useState(!0),[x,S]=m.useState(!1),P=()=>{j(!0),S(!1)},V=()=>{j(!0)},r=()=>{j(!1)},n=()=>{j(!1),S(!0)},o=()=>{var c;(c=window.getSelection())!=null&&c.toString()?(j(!1),S(!0)):(j(!0),S(!1))},d=c=>{x&&c.preventDefault()};return i.jsxs("li",{className:`${p?"dragging":""}`,draggable:z,onDragStart:c=>{var y;z?(c.dataTransfer.setData("application/my-app",(y=e==null?void 0:e.order)==null?void 0:y.toString()),k(!0)):c.preventDefault()},onDragEnd:()=>k(!1),children:[i.jsxs("span",{onMouseOver:V,onMouseDown:P,className:`${h["drag-handle"]} tooltip-wrap`,children:[i.jsx(fe,{}),i.jsx("span",{className:"tooltip narrow2 below right",children:ne[a]})]}),i.jsxs("label",{className:`${w?h.open:h.closed}`,onClick:d,children:[i.jsx("input",{type:"checkbox",id:`check_${G(e==null?void 0:e.name)}`,checked:(e==null?void 0:e.complete)??!1,onChange:u}),i.jsx("span",{onMouseOver:r,onMouseDown:n,onMouseUp:o,children:e==null?void 0:e.name})]}),i.jsxs("div",{className:`${w?h.open:h.closed} ${h["btn-wrap"]}`,children:[i.jsx(de,{language:a,className:`${h["modify-todo"]} modify-todo`,wrapperClass:"modify-todo-wrap",text:L[a],isOpen:w,setIsFormOpen:N,hideBrackets:!1,onClick:()=>{$((e==null?void 0:e.name)??"")},children:i.jsxs("form",{onSubmit:g,className:`${h.modify}`,children:[i.jsxs("label",{children:[i.jsx("textarea",{id:`task_${G(e==null?void 0:e.name)}`,required:!0,name:"task",rows:4,value:q,onChange:K}),i.jsxs("span",{className:"scr",children:[L[a]," ",oe((e==null?void 0:e.name)??X[a],a)]})]}),i.jsx("button",{type:"submit",disabled:M,className:"modify",children:ie[a]})]})}),i.jsxs("button",{className:`${h.delete} tooltip-wrap`,onClick:w?()=>N(!1):v,children:[i.jsx("span",{"aria-hidden":"true",children:w?i.jsx(pe,{style:{fontSize:"0.8em"}}):i.jsx(i.Fragment,{children:"×"})}),i.jsx("span",{className:"tooltip below left narrow2",children:w?le[a]:se[a]})]})]})]})}function Ae({toggleTodo:e,deleteTodo:t,language:s,modifyTodo:a,modifyTodoOrder:l,todosWithIdAndStatus:p,sending:f}){var w,N;const{isDragging:k,listItemsByStatus:M,handleUpdate:q,handleDragging:$}=me(p,["todos"]);return I(),i.jsx("ul",{className:`${h["todo-ul"]} todo-ul`,onDragOver:u=>u.preventDefault(),onDrop:u=>{var j;u.preventDefault();const v=u.dataTransfer.getData("application/my-app"),g=(j=Array.from(u.currentTarget.querySelectorAll(".todo-ul > li")))==null?void 0:j.reduce((x,S)=>{const P=S.getBoundingClientRect(),V=Math.abs(P.top-u.clientY);return V<x.offset?{offset:V,element:S}:x},{offset:Number.POSITIVE_INFINITY}),K=Array.from(u.currentTarget.querySelectorAll(".todo-ul > li")).indexOf(g.element);if(Number(v)===K)return;const z=q(Number(v),"todos",K);if(Array.isArray(z)){const x=z==null?void 0:z.map((S,P)=>({key:S.key,order:P}));l(x)}else console.error("Order is not an array");$(!1)},children:(N=(w=M.todos)==null?void 0:w.items)==null?void 0:N.slice().sort((u,v)=>u.order??0>(v.order??0)?1:-1).sort((u,v)=>u.complete===v.complete?0:u.complete?1:-1).map(u=>i.jsx(Ie,{sending:f,toggleTodo:e,deleteTodo:t,todo:p==null?void 0:p.find(v=>v.key===u.key),language:s,modifyTodo:a,isDragging:k,handleUpdate:q,handleDragging:$},u==null?void 0:u.key))})}function Ce({language:e}){const t=I(),s=Z(r=>{var n;return(n=r.auth)==null?void 0:n.user});m.useEffect(()=>{t(ye())},[]);const a=Z(r=>r.todos.todos),l=Z(r=>r.todos.status),p=Z(r=>r.todos.error),f="ReactTodos",k=a==null?void 0:a.some(r=>r.complete);m.useEffect(()=>{if(a.length===0&&!s){const r=JSON.parse(window.localStorage.getItem(f)||"[]"),n=new Set(a.map(o=>o.key));r.forEach(o=>{n.has(o.key)||t(U(o))})}},[t,a,s]),m.useEffect(()=>{window.localStorage.setItem(f,JSON.stringify(a))},[a]);const M=r=>{const n=new Set,o=[];return r.forEach(d=>{n.has(d.key)?o.push(d):n.add(d.key)}),o},q=r=>{if(!r){t(b("Error: no key",!0,8));return}if(s!=null&&s._id)t(W(s._id,r));else{t(Y(r));const n=a.filter(o=>o.key!==r);window.localStorage.setItem(f,JSON.stringify(n))}};m.useEffect(()=>{const r=M(a),n=new Set;r.forEach(o=>{n.has(o.key)||(q(o.key),n.add(o.key))})},[a]);const[$,w]=m.useState([]);m.useEffect(()=>{const r=a==null?void 0:a.slice().sort((n,o)=>(n.order??0)-(o.order??0)).map(n=>({...n,id:n.order,status:"todos"}));w(r)},[a]),m.useEffect(()=>{l==="failed"&&t(b(`There was an error: ${p}`,!0,8))},[l,p,t]);const[N,u]=m.useState(!1),[v,g]=m.useState(!1);m.useEffect(()=>{s!=null&&s._id&&!N&&t(Me(s._id)).then(()=>{u(!0)}).catch(r=>{var n,o;console.error(r),(o=(n=r.response)==null?void 0:n.data)!=null&&o.message?t(b(r.response.data.message,!0,8)):t(b(`${r.message}`,!0,8))})},[s==null?void 0:s._id]);function K(r){const n=a.find(o=>o.key===r);if(n){const o={...n,complete:!n.complete};t(s?R(s._id,r,o):D(o))}}const z=async(r,n)=>{if(g(!0),!r){t(b("Error: no key",!0,8)),g(!1);return}const o=a.find(d=>d.key===r);if(o){const d={...o,name:n};if(s)await t(R(s._id,r,d)).then(()=>{t(b("Todo updated",!1,3)),g(!1)}).catch(c=>{var y,_;console.error(c),(_=(y=c.response)==null?void 0:y.data)!=null&&_.message?t(b(c.response.data.message,!0,8)):t(b(`${c}`,!0,8)),g(!1)});else{t(D(d));const c=a.map(y=>y.key===r?d:y);window.localStorage.setItem(f,JSON.stringify(c)),g(!1)}}},j=r=>{var n,o;if(s)t(async d=>{var c,y;try{await Oe(s._id,r).then(()=>{d(Ne(s._id))})}catch(_){console.error(_),(y=(c=_.response)==null?void 0:c.data)!=null&&y.message?d(b(_.response.data.message,!0,8)):d(b(`${_}`,!0,8))}});else try{t(Je(r))}catch(d){console.error(d),(o=(n=d.response)==null?void 0:n.data)!=null&&o.message?t(b(d.response.data.message,!0,8)):t(b(`${d}`,!0,8))}finally{window.localStorage.setItem(f,JSON.stringify(a))}},x=m.useRef(null),S=r=>{var y;r.preventDefault(),g(!0);const n=((y=x.current)==null?void 0:y.value)??"";if(n===""){g(!1);return}const o=ve(),d=a.reduce((_,H)=>H.order>_?H.order:_,0),c={key:o,name:n,complete:!1,order:d+1};s?(t(ze(s._id,c)),g(!1)):(t(U(c)),window.localStorage.setItem(f,JSON.stringify([...a,c])),g(!1)),x.current&&(x.current.value="")};async function P(r){if(r.preventDefault(),window.confirm(re[e]))if(s)await t(qe(s._id));else{t(E());const n=a.filter(o=>!o.complete);window.localStorage.setItem(f,JSON.stringify(n))}}function V(r){if(!r){t(b("Error: no key",!0,8));return}if(s!=null&&s._id)t(W(s._id,r));else{t(Y(r));let n=a.filter(o=>o.key!==r);n=n.map((o,d)=>({...o,order:d+1})),t(Fe(n)),window.localStorage.setItem(f,JSON.stringify(n))}}return i.jsxs(i.Fragment,{children:[i.jsx("form",{onSubmit:S,className:h.form,children:i.jsxs("fieldset",{children:[i.jsx("legend",{className:"scr",children:ae[e]}),i.jsxs("div",{className:h["todo-input-area"],children:[i.jsx("label",{htmlFor:"taskinput",children:Q[e]}),i.jsx("textarea",{ref:x,id:"taskinput",className:"bg",rows:3,name:"task",required:!0,autoComplete:"off",placeholder:`${X[e]}...`}),i.jsx("button",{id:h["submit-todo"],type:"submit",disabled:v,children:Q[e]}),i.jsx("button",{className:"danger",disabled:!k,onClick:r=>P(r),children:ee[e]})]})]})}),i.jsxs("div",{className:h["list-wrap"],children:[i.jsxs("p",{className:h["left-to-do"],children:[a==null?void 0:a.filter(r=>!(r!=null&&r.complete)).length," ",te[e]]}),i.jsx(Ae,{sending:v,todosWithIdAndStatus:$,toggleTodo:K,deleteTodo:V,language:e,modifyTodo:z,modifyTodoOrder:j}),l==="loading"&&i.jsxs("p",{className:"flex center margin0auto textcenter",children:[ce[e],"..."]})]})]})}const ct=Object.freeze(Object.defineProperty({__proto__:null,default:Ce},Symbol.toStringTag,{value:"Module"}));export{Ke as E,ct as T,He as a,Ge as b,Ze as c,Ue as d,De as e,Qe as f,Xe as g,Ve as h,lt as t};
