import{j as r,r as a}from"./react-A9DAvxly.js";import{Y as ze,Z as $e,_ as wo,$ as ct,a0 as Eo,a1 as jo,a2 as Bo,a3 as No,a4 as Co,a5 as So,a6 as Lo,a7 as Do,a8 as Po,a9 as Mo,K as To,aa as Ao,ab as or,W as w,ac as sr,ad as Ue,ae as Ro,af as Io,ag as Fo,ah as Oo,ai as Vo,aj as Ho,ak as zo,al as Uo,am as Yo,an as Wo,ao as Jo,ap as _o,aq as Go,ar as Xo,as as qo,at as Zo,au as Qo,av as Ko,aw as es,ax as ar,ay as nr,az as ts,aA as rs,aB as os,aC as ss,aD as as,aE as ns,aF as lr,aG as ls,aH as cs,aI as is,aJ as ds,aK as us,aL as ms,aM as hs,aN as fs,aO as bs,aP as ps,aQ as ys,aR as Ye,aS as vs,aT as cr,aU as gs,aV as xs,aW as $s,aX as ks,aY as ws,aZ as Es,a_ as js,a$ as Bs,b0 as ir,b1 as dr,b2 as K,b3 as Ns,b4 as Cs,b5 as Ss,b6 as Ls,b7 as Ds,b8 as Ps,b9 as ur,ba as mr,bb as hr,bc as Ms,bd as fr,be as br,bf as Ts,bg as As,bh as Rs,bi as Is,bj as Fs,bk as Os,bl as Vs,bm as Hs,bn as zs,bo as de,bp as Us,bq as Ys,br as Ws,bs as pr,bt as Js,bu as _s,bv as Gs,bw as Xs,bx as qs,by as Zs,bz as Qs,bA as Ks,bB as ea,bC as ta,bD as ra,bE as oa}from"./index-uFuhXg81.js";import{a8 as sa,a9 as aa,aa as na,ab as la,ac as ca,ad as ia,ae as yr,af as vr,W as da,V as ua,ag as ma,ah as ha,u as fa,$ as ba,ai as pa}from"./react-icons-DfNghVim.js";import{a as gr}from"./react-redux-CHm9GgGE.js";import{a as ke}from"./axios-CCb-kr4I.js";import{a as ya}from"./react-router-S1Hdk0kP.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./react-dom-yh0erWL-.js";import"./scheduler-CzFDRTuY.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./react-router-dom-CYs6befe.js";import"./@remix-run-DTnHqtaE.js";import"./react-is-DUDD-a5e.js";import"./uuid-Dv1xt2bl.js";import"./use-sync-external-store-DEc9BFqZ.js";function va(e,t,j){return Math.min(Math.max(t,e),j)}const ga=({d:e,layer:t,language:j,item:u,index:k,start:v,movement:M,stopMovementCheck:V,stopMoving:h,wheel:g,focused:E,blurred:re,selectedvalue0:m,setFocusedBlob:ee,dragUlRef:S})=>{const te=e===0?33:va(22,u.i*2.6,50),oe={background:`${u.background}`,display:"block",left:`${u.x}`,top:`${u.y}`,zIndex:`${u.z}`,"--i":isNaN(Number(u.i))?"7":`${u.i}`,"--layer":`${t}`,WebkitFilter:`blur(${te}px)`,filter:`blur(${te}px)`},A=e===0?["5.9px","8.2px","9.9px","10.8px","10.7px","10.5px","10px"]:["5.1px","5.4px","6.5px","7px","7.8px","8.4px","8.6px"];return r.jsxs("li",{onFocus:f=>{var p;S&&S.current&&((p=S.current)==null||p.setAttribute("aria-activedescendant",`${f.target.id}`));const y=f.target;y.parentNode,setTimeout(()=>{var b,x;const H=y.getBoundingClientRect(),ne=(b=y.parentNode)==null?void 0:b.getBoundingClientRect(),R=y.closest(".drag-wrap-outer"),l=R==null?void 0:R.scrollLeft,i=R==null?void 0:R.scrollTop;ee({top:H.top-ne.top-i,left:H.left-ne.left-l,width:H.width,height:H.height}),m.current&&(m.current.textContent=`${ze[j]}: ${(x=y.querySelector("span"))==null?void 0:x.textContent}`)},500),E(y)},onBlur:f=>{var y;ee(null),re(f.target),S&&S.current&&((y=S.current)==null||y.removeAttribute("aria-activedescendant")),m.current&&(m.current.textContent=`${$e[j]}`)},className:"dragzone animation",id:u.id,role:"option",tabIndex:0,style:oe,children:[r.jsx("div",{className:"draggable-overlay",style:Number(u.i)<8?{width:`calc(var(--i) * ${A[0]})`,height:`calc(var(--i) * ${A[0]})`}:Number(u.i)<10?{width:`calc(var(--i) * ${A[1]})`,height:`calc(var(--i) * ${A[1]})`}:Number(u.i)<20?{width:`calc(var(--i) * ${A[2]})`,height:`calc(var(--i) * ${A[2]})`}:Number(u.i)<24?{width:`calc(var(--i) * ${A[3]})`,height:`calc(var(--i) * ${A[3]})`}:Number(u.i)<28?{width:`calc(var(--i) * ${A[4]})`,height:`calc(var(--i) * ${A[4]})`}:Number(u.i)<32?{width:`calc(var(--i) * ${A[5]})`,height:`calc(var(--i) * ${A[5]})`}:isNaN(Number(u.i))||u.i===null||u.i===void 0?{width:`7 * ${A[6]})`,height:`7 * ${A[6]})`}:{width:`calc(var(--i) * ${A[6]})`,height:`calc(var(--i) * ${A[6]})`},onMouseDown:f=>{var p,H;f.stopPropagation();const y=f.currentTarget.parentElement;y.draggable=!0,m.current&&(m.current.textContent=`${ze[j]}: ${(p=y==null?void 0:y.querySelector("span"))==null?void 0:p.textContent}`),S&&S.current&&((H=S.current)==null||H.setAttribute("aria-activedescendant",`${y.id}`)),v(f,y)},onMouseMove:f=>{var y;if(f.buttons===1){f.stopPropagation();const p=f.currentTarget.parentElement;p.draggable=!0,M(f,p),m.current&&(m.current.textContent=`${ze[j]}: ${(y=p==null?void 0:p.querySelector("span"))==null?void 0:y.textContent}`)}},onMouseLeave:f=>{var p;f.stopPropagation();const y=f.currentTarget.parentElement;y.draggable=!1,S&&S.current&&((p=S.current)==null||p.removeAttribute("aria-activedescendant")),h(f,y),m.current&&(m.current.textContent=`${$e[j]}`)},onMouseUp:f=>{var p;const y=f.currentTarget.parentElement;y.draggable=!1,V(f,y),S&&S.current&&((p=S.current)==null||p.removeAttribute("aria-activedescendant")),m.current&&(m.current.textContent=`${$e[j]}`)},onTouchStart:f=>{var p,H;f.preventDefault(),f.stopPropagation();const y=f.currentTarget.parentElement;y.draggable=!0,S&&S.current&&((p=S.current)==null||p.setAttribute("aria-activedescendant",`${y.id}`)),v(f,y),m.current&&(m.current.textContent=`${ze[j]}: ${(H=y==null?void 0:y.querySelector("span"))==null?void 0:H.textContent}`)},onTouchMove:f=>{f.preventDefault(),f.stopPropagation();const y=f.currentTarget.parentElement;y.draggable=!0,M(f,y)},onTouchEnd:f=>{var p;const y=f.currentTarget.parentElement;y.draggable=!1,S&&S.current&&((p=S.current)==null||p.removeAttribute("aria-activedescendant")),V(f,y),m.current&&(m.current.textContent=`${$e[j]}`)},onWheel:f=>{const y=f.currentTarget.parentElement;g(y)}}),r.jsxs("span",{className:"scr",children:[wo[j]," ",u.number]})]},k)},xa=e=>{var u;const t=e.d===0?0:1,j={WebkitFilter:`url(#svgfilter${t})`,filter:`url(#svgfilter${t})`,backgroundColor:"transparent",position:"absolute",top:0,left:0,height:"100%",width:"100%",pointerEvents:"none"};return r.jsxs(r.Fragment,{children:[r.jsxs("span",{id:`listbox${e.d}-layer${e.layer}-label`,className:"scr",children:[ct[e.language]," ",e.layer+1]}),r.jsx("ul",{ref:e.dragUlRef,role:"listbox",id:`listbox${e.d}-layer${e.layer}`,className:`drag-container-layer drag-container${e.d}-layer drag-container${e.d}-layer${e.layer} ${e.className}`,"aria-labelledby":`listbox${e.d}-layer${e.layer}-label`,"aria-activedescendant":"",style:j,children:(u=e.items)==null?void 0:u.map((k,v)=>{if(k!=null)return r.jsx(ga,{layer:e.layer,d:e.d,language:e.language,item:k,index:v,start:e.start,movement:e.movement,stopMovementCheck:e.stopMovementCheck,stopMoving:e.stopMoving,wheel:e.wheel,focused:e.focused,blurred:e.blurred,selectedvalue0:e.selectedvalue0,setFocusedBlob:e.setFocusedBlob,dragUlRef:e.dragUlRef},v)})})]})};let We,C=!0,ot=0,st=0,ve,De=0,at=null,Je="90deg",P;const ge=e=>{e.preventDefault(),e.stopImmediatePropagation()},$a=e=>{const j=[...e.items].sort((l,i)=>l.layer-i.layer).reduce((l,i)=>(l[i.layer]||(l[i.layer]=[]),l[i.layer].push(i),l),{}),u=Array.from({length:e.layerAmount},(l,i)=>i),k=a.useRef({});a.useEffect(()=>{const l=u.reduce((i,b)=>(i[b]=a.createRef(),i),{});k.current=l},[e.layerAmount]);const v=()=>{try{return document.createEvent("TouchEvent"),!0}catch{return!1}};a.useEffect(()=>{v()},[]);const M=l=>{let i=l.layer;i<e.layerAmount-1&&(i+=1,e.changeBlobLayer(l,i))},V=l=>{let i=l.layer;i>0&&(i-=1,e.changeBlobLayer(l,i))};function h(l,i){const b=l.getBoundingClientRect(),x=i.getBoundingClientRect();return!(b.top+5>x.bottom-5||b.right<x.left||b.bottom-5<x.top+5||b.left>x.right)}const g=a.useCallback(l=>{C=!0,document.removeEventListener("keydown",f),document.removeEventListener("touchmove",ge)},[f]);Eo({ref:e.clickOutsideRef,onOutsideClick:g}),a.useEffect(()=>{v()&&!P&&e.scroll&&(document.body.style.overflowY="auto",document.body.style.overflowX="hidden",document.removeEventListener("keydown",f),document.removeEventListener("touchmove",ge))},[P,e.scroll,v,f]);const E=a.useCallback((l,i)=>{l.stopPropagation(),l.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),We=!0,P=i,ot=v()?l.touches[0].clientX:l.clientX,st=v()?l.touches[0].clientY:l.clientY,i.classList.add("drag");const b=e.highestZIndex[e.layer];if(v()){let B=(i==null?void 0:i.style.getPropertyValue("--i"))??"7";ve=parseFloat(B),ve=isNaN(ve)?7:ve}e.dispatch({type:"partialUpdate",payload:{d:e.d,id:i.id,update:{z:`${Math.max(1,b+1)}`}}}),document.addEventListener("keydown",f);const x=i.style.getPropertyValue("--layer");e.setActiveLayer(isNaN(parseInt(x))?1:parseInt(x)),v()&&(document.addEventListener("touchmove",ge,{passive:!1}),document.body.style.overflow="hidden")},[f,v]),re=a.useCallback(l=>{if(l.stopPropagation(),v()&&(l.preventDefault(),document.body.style.overflow="hidden"),We){let i=v()?l.touches[0].clientX:l.clientX,b=v()?l.touches[0].clientY:l.clientY;P.style.top=P.offsetTop-(st-b)+"px",P.style.left=P.offsetLeft-(ot-i)+"px",ot=i,st=b,e.dispatch({type:"partialUpdate",payload:{d:e.d,id:P==null?void 0:P.id,update:{x:P.style.left,y:P.style.top}}})}},[v]),m=a.useCallback((l,i)=>{l.stopPropagation(),l.preventDefault(),We=!1,De++,at&&clearTimeout(at),at=setTimeout(()=>{if(De===2){let N=ve-.8;N=Math.max(7,N),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:P==null?void 0:P.id,update:{i:N}}})}else if(De===3){let N=ve+.8;N=Math.min(36,N),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:P==null?void 0:P.id,update:{i:N}}})}De=0},300),document.removeEventListener("keydown",f);let b=i.style.getPropertyValue("--i")??"7",x=parseFloat(b);x=isNaN(x)?7:x;const B=i.querySelector("div"),Z={layer:parseInt(i.style.getPropertyValue("--layer")),id:i.id,number:parseInt(i.id.replace("blob","").split("-")[0],10),i:x,x:i.style.left,y:i.style.top,z:i.style.zIndex,background:i.style.background||"linear-gradient(90deg, cyan, greenyellow)"};v()&&e.scroll?(document.removeEventListener("touchmove",ge),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):v()&&!e.scroll&&(document.body.style.overflow="hidden"),e.layerIncrease.current&&h(B,e.layerIncrease.current)&&M(Z),e.layerDecrease.current&&h(B,e.layerDecrease.current)&&V(Z),e.colorPairs[e.d].forEach((N,Y)=>{const z=e.colorBlockProps[e.d][Y];if(z.current&&h(B,z.current)){const{color1:J,color2:Q}=N;i.style.background=`linear-gradient(${Je}, ${J},${Q})`}}),e.makeLarger0.current&&h(B,e.makeLarger0.current)&&(x+=.4,x=Math.min(Math.max(7,x),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:i.id,update:{i:x}}})),e.makeSmaller0.current&&h(B,e.makeSmaller0.current)&&(x-=.4,x=Math.min(Math.max(7,x),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:i.id,update:{i:x}}})),e.makeMore0.current&&h(B,e.makeMore0.current)&&p(Z),e.deleteBlob0.current&&h(B,e.deleteBlob0.current)&&R(Z),i.classList.remove("drag"),i.blur(),De===0?P=null:P=i,e.setFocusedBlob(null)},[Je,h,f,p,e.colorBlockProps,e.colorPairs,R,e.scroll]),ee=a.useCallback((l,i)=>{l.stopPropagation(),We=!1,P=null,v()&&e.scroll?(document.removeEventListener("touchmove",ge),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):v()&&!e.scroll&&(document.body.style.overflow="hidden"),e.getPosition(i),i.classList.remove("drag"),document.removeEventListener("keydown",f),i.blur()},[f]);a.useEffect(()=>{v()&&!P&&e.scroll&&(document.removeEventListener("touchmove",ge),document.body.style.overflowY="auto",document.body.style.overflowX="hidden")},[m,ee,P,e.scroll]);function S(l){l.classList.remove("drag"),document.removeEventListener("keydown",f),e.getPosition(l),l.draggable=!1,P=null}function te(l){P=l,l.classList.add("drag");const i=l.style.getPropertyValue("--layer");e.setActiveLayer(parseInt(i)??2),document.addEventListener("keydown",f),l.draggable=!0}function oe(l){const i=b=>A(b,l);return l.addEventListener("wheel",i,{passive:!1}),()=>{l.removeEventListener("wheel",i)}}function A(l,i){if(C){C=!1;let x=window.getComputedStyle(i).getPropertyValue("--i")??i.style.getPropertyValue("--i")??"7",B=parseFloat(x);B=isNaN(B)?7:B,l.deltaY<0?B*=1.04:B*=.96,B=Math.min(Math.max(7,B),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:i.id,update:{i:B}}}),setTimeout(()=>{C=!0},100)}}a.useEffect(()=>{const l=P;if(l){const{color1:i,color2:b}=e.colorPairs[e.d][e.colorIndex],x=`linear-gradient(${Je}, ${i}, ${b})`;e.dispatch({type:"partialUpdate",payload:{d:e.d,id:l.id,update:{background:x}}})}},[e.colorIndex]);function f(l){var O,le;const b=P;if(!b)return;const x=window.getComputedStyle(b),B=T=>{var me;const U=parseFloat(x.marginTop),ce=parseFloat(x.marginLeft),q=T.getBoundingClientRect(),fe=(me=T.parentNode)==null?void 0:me.getBoundingClientRect();e.setFocusedBlob({top:q.top-fe.top-U,left:q.left-fe.left-ce,width:q.width,height:q.height})};let Z=x.getPropertyValue("--i")??b.style.getPropertyValue("--i")??"7",N=parseFloat(Z);N=isNaN(N)?7:N;let Y=parseFloat(x.getPropertyValue("left"))??parseFloat(b.style.getPropertyValue("left"))??0,z=parseFloat(x.getPropertyValue("top"))??parseFloat(b.style.getPropertyValue("top"))??0;const J=b.style.getPropertyValue("--layer"),Q={layer:parseInt(J)??e.layer,id:b.id,number:parseInt(b.id.replace("blob","").split("-")[0],10),i:N,x:b.style.getPropertyValue("left").toString(),y:b.style.getPropertyValue("top").toString(),z:b.style.zIndex??"0",background:b.style.background??"linear-gradient(90deg, cyan, greenyellow)"},ue=(T,U)=>{e.dispatch({type:"partialUpdate",payload:{d:e.d,id:b.id,update:{x:`${T}px`,y:`${U}px`}}}),B(b)},F=()=>{C=!0},Ee=T=>{l.preventDefault(),C&&(C=!1,e.changeBlobLayer(Q,T),setTimeout(F,100))},X=l.key;switch(parseInt(X)>=1&&parseInt(X)<=e.layerAmount&&Ee(parseInt(X)-1),l.key){case"ArrowLeft":l.preventDefault(),C&&(ue(Y-4,z),setTimeout(F,100));break;case"ArrowRight":l.preventDefault(),C&&(ue(Y+4,z),setTimeout(F,100));break;case"ArrowUp":l.preventDefault(),C&&(ue(Y,z-4),setTimeout(F,100));break;case"ArrowDown":l.preventDefault(),C&&(ue(Y,z+4),setTimeout(F,100));break;case"Escape":l.preventDefault(),e.setScroll(!0),document.body.style.overflowY="auto",document.body.style.overflowX="hidden",e.exitApp.current&&(e.exitApp.current.setAttribute("tabindex","0"),e.exitApp.current.addEventListener("blur",y)),b.blur(),(O=e.dragWrap.current)==null||O.blur(),e.exitApp.current&&(e.exitApp.current.textContent=jo[e.language]),(le=e.exitApp.current)==null||le.focus();break;case"Enter":l.preventDefault(),l.stopPropagation(),C&&(C=!1,b.closest(`#drag-wrap${e.d}`)&&e.setColorIndex(T=>(T+1)%e.colorPairs[e.d].length),setTimeout(F,100));break;case"R":case"r":case" ":if(l.preventDefault(),l.stopPropagation(),C){if(C=!1,b.closest(`#drag-wrap${e.d}`)){const T=e.colorswitch();let U=e.colorswitch();U===T&&(U=e.colorswitch());const ce=`linear-gradient(${Je}, ${T}, ${U})`;e.dispatch({type:"partialUpdate",payload:{d:e.d,id:b.id,update:{background:ce}}})}setTimeout(F,100)}break;case"Z":case"z":l.preventDefault(),C&&(C=!1,e.dispatch({type:"partialUpdate",payload:{d:e.d,id:b.id,update:{z:"0"}}}),setTimeout(F,100));break;case"T":case"t":l.preventDefault(),C&&(C=!1,e.dispatch({type:"partialUpdate",payload:{d:e.d,id:b.id,update:{z:`${Math.max(1,e.highestZIndex[e.layer]+1)}`}}}),setTimeout(F,100));break;case"S":case"s":l.preventDefault(),C&&(C=!1,N-=.4,N=Math.min(Math.max(7,N),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:b.id,update:{i:N}}}),setTimeout(F,100));break;case"B":case"b":case"L":case"l":l.preventDefault(),C&&(C=!1,N+=.4,N=Math.min(Math.max(7,N),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:b.id,update:{i:N}}}),setTimeout(F,100));break;case"C":case"c":case"D":case"d":l.preventDefault(),C&&(C=!1,p(Q),setTimeout(F,100));break;case"+":l.preventDefault(),C&&(C=!1,e.addRandomDraggable(Q.x,Q.y,Q.layer),setTimeout(F,200));break;case"Delete":case"-":l.preventDefault(),C&&(C=!1,R(Q),setTimeout(F,100));break}}function y(){var l,i;e.exitApp.current&&((l=e.exitApp.current)==null||l.removeAttribute("tabindex"),(i=e.exitApp.current)==null||i.removeEventListener("blur",y),e.exitApp.current.textContent="")}function p(l){e.dispatch({type:"duplicateDraggable",payload:{d:e.d,draggable:l}})}const[H,ne]=a.useState("");function R(l){ne(l.id),e.selectedvalue0.current&&(e.selectedvalue0.current.textContent=`${$e[e.language]}`)}return a.useEffect(()=>{H&&(e.dispatch({type:"removeDraggable",payload:{d:e.d,id:H}}),ne(""))},[H,e.d,e.dispatch]),r.jsx(r.Fragment,{children:u.map(l=>r.jsx(xa,{layer:l,dragUlRef:k.current[l],items:j[l]||[],className:e.hiddenLayers.has(l)?"hidden":"",language:e.language,d:e.d,saveDraggables:e.saveDraggables,selectedvalue0:e.selectedvalue0,setFocusedBlob:e.setFocusedBlob,start:E,movement:re,stopMovementCheck:m,stopMoving:ee,wheel:oe,focused:te,blurred:S},l))})},ka="http://localhost:4000",we=`${ka}/api/blobs`,wa=async(e,t,j)=>(await ke.get(`${we}/${e}/${t}`,{params:{language:j}})).data,Ea=async(e,t,j,u)=>(await ke.get(`${we}/${e}/${t}/${j}/${u}`)).data,ja=async(e,t,j,u,k,v)=>(await ke.post(`${we}/${e}/${t}/${u}/${v}`,{draggables:j,backgroundColor:k})).data,Ba=async(e,t,j,u,k,v,M)=>(await ke.put(`${we}/${e}/${t}/${u}/${v}`,{d:t,versionName:u,draggables:j,backgroundColor:k,newVersionName:M})).data,Na=async(e,t,j,u)=>(await ke.delete(`${we}/${e}/${t}/${j}/${u}`)).data,Ca=async(e,t,j)=>(await ke.post(`${we}/screenshot`,{url:e,selector:t,language:j})).data,Pe={getAllBlobsByUser:wa,getBlobsVersionByUser:Ea,saveBlobsByUser:ja,editBlobsByUser:Ba,deleteBlobsVersionByUser:Na,takeScreenshot:Ca},Sa=({d:e,language:t,controlsVisible:j,colorBlockProps:u,colorPairs:k,getRefName:v,map:M})=>r.jsx(r.Fragment,{children:u[e].map((V,h)=>{var g;return r.jsx("div",{ref:V,className:`colorblock ${(g=v(M[e],V))==null?void 0:g.toLowerCase()} tooltip-wrap ${j?"":"hidden"}`,id:`color${h}-${e}`,style:{background:`linear-gradient(45deg, ${k[e][h].color1}, ${k[e][h].color2})`,borderRadius:`${h<4?"5rem 6.7rem 6.7rem 5rem / 0.7rem 8.7rem 8.7rem 0.7rem":"6.7rem 5rem 5rem 6.7rem / 8.7rem 0.7rem 0.7rem 8.7rem"}`},children:r.jsx("span",{className:`tooltip below ${h<4?"right":"left"}`,children:Bo[t]})},`${k[e][h].color1}${h}-${e}`)})}),La=({d:e,language:t,sliderLightnessInput:j,setSliderLightVal:u,sliderLightness:k,sliderLightVal:v,defaultLightness:M,sliderLightnessReset:V,sliderSaturationInput:h,setSliderSatVal:g,sliderSaturation:E,sliderSatVal:re,defaultSaturation:m,sliderSaturationReset:ee,sliderHueInput:S,setSliderHueVal:te,sliderHue:oe,sliderHueVal:A,defaultHue:f,sliderHueReset:y})=>r.jsx(r.Fragment,{children:r.jsxs("div",{id:`drag-slider-wrap${e}`,className:"drag-slider-wrap",children:[r.jsxs("div",{className:"drag-slider-single",children:[r.jsx("label",{htmlFor:`drag-slider-hue${e}`,id:`huedescription${e}`,children:No[t]}),r.jsx("input",{ref:S,onChange:p=>{te(p.target.value),oe()},onMouseUp:p=>{te(p.target.value),oe()},onPointerUp:p=>{te(p.target.value),oe()},type:"range",min:0,max:359,value:A,className:"drag-slider drag-slider-hue",id:`drag-slider-hue${e}`}),r.jsx("span",{children:A}),r.jsx("button",{onClick:()=>{te(f),y()},children:Co[t]})]}),r.jsxs("div",{className:"drag-slider-single",children:[r.jsx("label",{htmlFor:`drag-slider-saturation${e}`,id:`saturationdescription${e}`,children:So[t]}),r.jsx("input",{ref:h,onChange:p=>{g(p.target.value),E()},onMouseUp:p=>{g(p.target.value),E()},onPointerUp:p=>{g(p.target.value),E()},type:"range",min:0,max:100,value:re,className:"drag-slider drag-slider-saturation",id:`drag-slider-saturation${e}`}),r.jsx("span",{children:re}),r.jsx("button",{onClick:()=>{g(m),ee()},children:Lo[t]})]}),r.jsxs("div",{className:"drag-slider-single",children:[r.jsx("label",{htmlFor:`drag-slider-lightness${e}`,id:`lightnessdescription${e}`,children:Do[t]}),r.jsx("input",{ref:j,onChange:p=>{u(p.target.value),k()},onMouseUp:p=>{u(p.target.value),k()},onPointerUp:p=>{u(p.target.value),k()},type:"range",min:0,max:100,value:v,className:"drag-slider drag-slider-lightness",id:`drag-slider-lightness${e}`}),r.jsx("span",{children:v}),r.jsx("button",{onClick:()=>{u(M),V()},children:Po[t]})]})]})}),Da=[{color1:"darkorange",color2:"orange"},{color1:"orangered",color2:"palevioletred"},{color1:"magenta",color2:"violet"},{color1:"blue",color2:"cyan"},{color1:"greenyellow",color2:"lemonchiffon"},{color1:"cyan",color2:"greenyellow"},{color1:"cyan",color2:"pink"},{color1:"lemonchiffon",color2:"pink"}],Pa=[{color1:"indianred",color2:"palevioletred"},{color1:"sienna",color2:"peru"},{color1:"chocolate",color2:"burlywood"},{color1:"darkkhaki",color2:"moccasin"},{color1:"slateblue",color2:"mediumpurple"},{color1:"royalblue",color2:"turquoise"},{color1:"cadetblue",color2:"mediumaquamarine"},{color1:"lightslategray",color2:"lightsteelblue"}],Ma=[{color1:"indigo",color2:"mediumorchid"},{color1:"darkmagenta",color2:"palevioletred"},{color1:"crimson",color2:"indianred"},{color1:"chocolate",color2:"orangered"},{color1:"darkcyan",color2:"olivedrab"},{color1:"midnightblue",color2:"darkturquoise"},{color1:"mediumblue",color2:"cadetblue"},{color1:"darkblue",color2:"mediumslateblue"}],nt=[Da,Pa,Ma];let xr="90deg";const lt=3,xe=e=>{e.preventDefault()};function Ta({language:e,d:t,ds:j,dragWrapOuter:u}){var Kt,er,tr;const k="214",v=t===0?"80":t===2?"50":"45",M=t===0?"30":t===2?"5":"25",{state:V,dispatch:h}=a.useContext(Mo),g=To(),E=gr(o=>{var s;return(s=o.auth)==null?void 0:s.user}),re=gr(o=>o.users),m=a.useRef(),ee=a.useRef(),S=a.useRef(),te=a.useRef(),oe=a.useRef(),A=a.useRef(),f=a.useRef(),y=a.useRef(),[p,H]=a.useState(!1),ne=a.useRef(),R=a.useRef(),l=a.useRef(),i=a.useRef(),b=a.useRef(),x=a.useRef(),B=a.useRef(),Z=a.useRef(),N=a.useRef(null),Y=a.useRef(),z=a.useRef(),J=a.useRef(),Q=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",ue=`${Q?"local-":""}BlobLayerAmount${[t]}`,F=`${Q?"local-":""}BackgroundColor${[t]}`,Ee=`${Q?"local-":""}Draggables${[t]}`,X=V.backgroundColor,O=V.draggables,{windowHeight:le,windowWidth:T}=Ao(),[U,ce]=a.useState(0),[q,fe]=a.useState(new Set),[me,$r]=a.useState({}),[kr,wr]=a.useState(0),[W,it]=a.useState(null),[_e,dt]=a.useState(!1),[je,Er]=a.useState(!0),[_,jr]=a.useState(!0),[se,Me]=a.useState(!0),[ut,Ge]=a.useState(!1),[mt,Xe]=a.useState(!1),[ht,ft]=a.useState(!1),bt=a.useRef(),pt=a.useRef(),yt=a.useRef(),vt=a.useRef(),gt=a.useRef(),xt=a.useRef(),$t=a.useRef(),kt=a.useRef(),wt=a.useRef(),Et=a.useRef(),jt=a.useRef(),Bt=a.useRef(),Nt=a.useRef(),Ct=a.useRef(),St=a.useRef(),Lt=a.useRef(),Dt=a.useRef(),Pt=a.useRef(),Mt=a.useRef(),Tt=a.useRef(),At=a.useRef(),Rt=a.useRef(),It=a.useRef(),Ft=a.useRef(),Br=[new Map([[bt,"colorBlockOrange"],[pt,"colorBlockRed"],[yt,"colorBlockPurple"],[vt,"colorBlockBlue"],[gt,"colorBlockYellowLime"],[xt,"colorBlockCyanYellow"],[$t,"colorBlockCyanPink"],[kt,"colorBlockPinkYellow"]]),new Map([[wt,"colorBlockReddish"],[Et,"colorBlockBrown"],[St,"colorBlockTan"],[jt,"colorBlockKhaki"],[Nt,"colorBlockPurplish"],[Bt,"colorBlockBluish"],[Ct,"colorBlockGreenish"],[Lt,"colorBlockGray"]]),new Map([[Dt,"colorBlockDarkPurple"],[Pt,"colorBlockDarkPink"],[Mt,"colorBlockDarkRed"],[Tt,"colorBlockDarkOrange"],[At,"colorBlockDarkGreen"],[Rt,"colorBlockGreenishBlue"],[It,"colorBlockDarkBlue"],[Ft,"colorBlockPurplishBlue"]])],Nr=(o,s)=>o.get(s),qe=[[bt,pt,yt,vt,gt,xt,$t,kt],[wt,Et,St,jt,Nt,Bt,Ct,Lt],[Dt,Pt,Mt,Tt,At,Rt,It,Ft]],Cr=(o,s)=>{const n=me[s]+1;h({type:"partialUpdate",payload:{d:t,id:o.id,update:{layer:s,z:n}}}),ce(s)},Sr=o=>{fe(s=>{const n=new Set(s);return n.has(o)?n.delete(o):n.add(o),n})};a.useEffect(()=>{const o=()=>dt(!0),s=()=>{dt(!1)},n=()=>{it(null)};return window.addEventListener("keyup",o),window.addEventListener("mousedown",s),window.addEventListener("mouseup",n),()=>{window.removeEventListener("keyup",o),window.removeEventListener("mousedown",s),window.removeEventListener("mouseup",n)}},[]);function Lr(){return new Promise(o=>{setTimeout(()=>{const s=localStorage.getItem(Ee);if(s==null||s==null||s==="undefined")o(null);else{const n=JSON.parse(s);o(n.map(c=>({...c,layer:c.layer??0})))}},300)})}function Dr(){return new Promise(o=>{setTimeout(()=>{var n;const s=localStorage.getItem(ue);s!=null?o(parseInt(s)):((n=O[t])==null?void 0:n.length)>0?o(Math.max(...O[t].map(c=>c.layer))+1):o(lt)},100)})}function Pr(){return new Promise(o=>{setTimeout(()=>{const s=localStorage.getItem(F);s==null||s==null||s==="undefined"?o(null):o(JSON.parse(s))},300)})}function Te(o=he){localStorage.setItem(ue,JSON.stringify(o))}function ae(o=X[t]){localStorage.setItem(F,JSON.stringify(o))}function Ot(o=O[t]){localStorage.setItem(Ee,JSON.stringify(o))}const[be,Vt]=a.useState(or[e]),[Ae,Ht]=a.useState(be),[Mr,Tr]=a.useState(""),[Ar,zt]=a.useState(!0),[Ut,Rr]=a.useState(!1),[Re,Ze]=a.useState(!1),[Ie,Ir]=a.useState({}),[he,pe]=a.useState(0),Fr=async()=>{var o,s;zt(!0);try{E!=null&&E._id&&Pe.getAllBlobsByUser(E==null?void 0:E._id,t,e).then(n=>{if(n){const c={};n.forEach(d=>{const{d:$,versionName:D}=d;c[$]||(c[$]={}),c[$][D]=d}),Ir(c),Rr(Object.keys(c).length>0)}}).catch(n=>{var c,d;(d=(c=n.response)==null?void 0:c.data)!=null&&d.message?h(w(n.response.data.message,!0,8)):g(w(`${K[e]}: ${n.message}`,!0,8))})}catch(n){(s=(o=n.response)==null?void 0:o.data)!=null&&s.message?h(w(n.response.data.message,!0,8)):g(w(K[e],!0,8))}finally{zt(!1)}},Or=o=>{for(const s in Ie)if(Ie[s][o])return!0;return!1},Yt=/^[\w\s\u00C0-\u024F\u1E00-\u1EFF-_]*$/,Vr=o=>{const s=o.target.value;Yt.test(s)?Vt(s):g(w(ur[e],!0,8))},Hr=o=>{const s=o.target.value;Yt.test(s)?Ht(s):g(w(ur[e],!0,8))},zr=async o=>{var s,n;o.preventDefault();try{if(be.trim()===""){g(w(Ye[e],!0,8));return}else if(be.trim().length>30){g(w(`${mr[e]}. ${hr[e]}`,!0,8));return}else if(E!=null&&E._id){const c=be.trim();if(Or(c)&&!window.confirm(Ms[e]))return;Pe.saveBlobsByUser(E==null?void 0:E._id,t,O[t],be,X[t],e).then(()=>{Ze(!Re),g(w(fr[e],!1,8))}).catch(d=>{var $,D;(D=($=d.response)==null?void 0:$.data)!=null&&D.message?h(w(d.response.data.message,!0,8)):g(w(`${K[e]}: ${d.message}`,!0,8))})}else g(w(br[e],!0,8))}catch(c){(n=(s=c.response)==null?void 0:s.data)!=null&&n.message?h(w(c.response.data.message,!0,8)):g(w(K[e],!0,8))}},Ur=async(o,s)=>{var c,d;const n=s.trim();if(s.trim()===""){g(w(Ye[e],!0,8));return}else if(s.trim().length>30){g(w(`${mr[e]}. ${hr[e]}`,!0,8));return}else try{E!=null&&E._id?Pe.editBlobsByUser(E==null?void 0:E._id,t,O[t],o,X[t],e,n).then(()=>{Ze(!Re),g(w(fr[e],!1,8))}).catch($=>{var D,I;(I=(D=$.response)==null?void 0:D.data)!=null&&I.message?h(w($.response.data.message,!0,8)):g(w(`${K[e]}: ${$.message}`,!0,8))}):g(w(br[e],!0,8))}catch($){(d=(c=$.response)==null?void 0:c.data)!=null&&d.message?h(w($.response.data.message,!0,8)):g(w(K[e],!0,8))}},Yr=(o,s)=>{const n=s.trim();E!=null&&E._id&&window.confirm(Ts[e])&&Pe.getBlobsVersionByUser(E==null?void 0:E._id,o,n,e).then(c=>{const d=Math.max(...c.draggables.map($=>$.layer));pe(d+1),setTimeout(()=>{Te(d+1)},300),h({type:"setDraggablesAtD",payload:{d:o,draggables:c.draggables}}),h({type:"setBackgroundColor",payload:{d:o,backgroundColor:c.backgroundColor}}),ae(c.backgroundColor),Be(c.backgroundColor[0]),Ne(c.backgroundColor[1]),Ce(c.backgroundColor[2]),Ke({[`--hue${o}`]:`${c.backgroundColor[0]}`}),et({[`--saturation${o}`]:`${c.backgroundColor[1]}`}),tt({[`--lightness${o}`]:`${c.backgroundColor[2]}`})}).then(()=>{Vt(n),bo(),setTimeout(()=>{ye()},300)}).catch(c=>{var d,$;($=(d=c.response)==null?void 0:d.data)!=null&&$.message?h(w(c.response.data.message,!0,8)):g(w(`${K[e]}: ${c.message}`,!0,8))})},Wr=(o,s)=>{E._id&&window.confirm(As[e])&&Pe.deleteBlobsVersionByUser(E._id,o,s,e).then(()=>{g(w(Rs[e],!1,8)),Ze(!Re)}).catch(n=>{var c,d;(d=(c=n.response)==null?void 0:c.data)!=null&&d.message?h(w(n.response.data.message,!0,8)):g(w(`${K[e]}: ${n.message}`,!0,8))})};a.useEffect(()=>{(async()=>{await g(Is()),await g(Fs())})()},[g]),a.useEffect(()=>{E&&Fr()},[E,Re]);function Jr(o){return o.reduce((s,n)=>{const c=parseInt(n.z,10),d=n.layer;return(!s[d]||c>s[d])&&(s[d]=c),s},{})}a.useEffect(()=>{(async()=>{const s=await Lr(),n=await Pr(),c=setTimeout(async()=>{var $,D,I;const d=await Dr();n&&n.length===3?(h({type:"setBackgroundColor",payload:{d:t,backgroundColor:n}}),ae(n),Be(n[0]),Ne(n[1]),Ce(n[2]),($=u.current)==null||$.style.setProperty(`--hue${t}`,`${n[0]}`),(D=u.current)==null||D.style.setProperty(`--saturation${t}`,`${n[1]}`),(I=u.current)==null||I.style.setProperty(`--lightness${t}`,`${n[2]}`)):(h({type:"setBackgroundColor",payload:{d:t,backgroundColor:[k,v,M]}}),ae([k,v,M])),d?pe(d):s&&s.length>0&&pe(Math.max(...s.map(L=>L.layer))+1),s&&s.length>0?(s&&s.length>0&&_r(s),Ge(!0)):s==null&&!ut&&(Gt(Wt,t),Ge(!0))},300);return()=>clearTimeout(c)})()},[]),a.useEffect(()=>{var o;if(O[t]!==void 0&&((o=O[t])==null?void 0:o.length)>0){Ot();const s=Jr(O[t]);$r(s)}},[O[t]]);function _r(o){if(!ut&&o&&(o==null?void 0:o.length)>0){for(let s=0;s<(o==null?void 0:o.length);s++)if(o[s]!==null&&o[s]!==void 0){const n={layer:o[s].layer,id:`${o[s].id}`,number:o[s].number,i:o[s].i,x:`${o[s].x}`,y:`${o[s].y}`,z:`${o[s].z}`,background:`${o[s].background??"linear-gradient(90deg, cyan, greenyellow)"}`};h({type:"addDraggable",payload:{d:t,draggable:n}})}}Ge(!0)}const Gr=()=>{h({type:"moveDraggablesLeft",payload:{d:t}})},Xr=()=>{h({type:"moveDraggablesRight",payload:{d:t}})},qr=()=>{h({type:"moveDraggablesUp",payload:{d:t}})},Zr=()=>{h({type:"moveDraggablesDown",payload:{d:t}})};function Qr(o){var n;o.preventDefault();const s=(n=u.current)==null?void 0:n.querySelectorAll(".dragzone");s&&!mt?(s.forEach(c=>{c.classList.remove("animation"),c.offsetWidth}),Xe(!0)):s&&(s.forEach(c=>{c.classList.add("animation"),c.offsetWidth}),Xe(!1))}a.useEffect(()=>{ht&&m.current&&(m.current.classList.add("paused"),Xe(!0))},[ht]),a.useEffect(()=>{const o=window.matchMedia("(prefers-reduced-motion: reduce)");ft(o.matches);const s=()=>ft(o.matches);return o.addEventListener("change",s),()=>{o.removeEventListener("change",s)}},[]);const Wt=T>700?10:6,Jt=o=>{switch(o.key){case"Escape":Me(!0),document.body.style.overflowY="auto",document.body.style.overflowX="hidden";break}};a.useEffect(()=>(window.addEventListener("keyup",Jt),()=>{window.removeEventListener("keyup",Jt)}),[]);const _t=o=>{const s=O[t].some(d=>d.layer===0&&o<0),n=O[t].some(d=>d.layer===he-1&&o>0);if(s){g(w(Os[e],!0,8));return}if(n){g(w(Vs[e],!0,8));return}const c=O[t].map(d=>{const $=d.layer+o;return $>=0&&$<he?{...d,layer:$}:d});h({type:"setDraggablesAtD",payload:{d:t,draggables:c}})};function Kr(o){o.preventDefault(),window.confirm(`${Hs[e]}?`)&&(window.localStorage.removeItem(Ee),h({type:"resetDraggables",payload:{d:t}}),h({type:"setDraggablesAtD",payload:{d:t,draggables:[]}}),Gt(Wt,t),setTimeout(()=>{ye(),Te(lt)},300))}const Gt=(o,s)=>{ce(0);for(let n=0;n<o;n++){const c=()=>{const I=nt[s],L=Math.floor(Math.random()*I.length);return[I[L].color1,I[L].color2]},[d,$]=c(),D={layer:0,id:`blob${n+1}-${s}`,number:n+1,i:T>400?Math.round(de(7,20)):Math.round(de(7,10)),x:T>le?`${T/100*Math.round(de(2,70))}px`:`${T/100*Math.round(de(2,50))}px`,y:`${le/100*Math.round(de(2,60))}px`,z:"1",background:`linear-gradient(${xr}, ${d??"cyan"},${$??"greenyellow"})`};h({type:"addDraggable",payload:{d:s,draggable:D}})}pe(lt)},Qe=()=>{const o=["cyan","lemonchiffon","pink","orangered","magenta","deepskyblue","darkorange","tomato","violet","dodgerblue","greenyellow","orange","silver","darkgray","gray","hotpink","wheat","sandybrown","rosybrown","dimgray","darkkhaki","darkseagreen","slateblue","royalblue","moccasin","burlywood","chocolate","cadetblue","mediumpurple","sienna","peru","indianred","palevioletred","plum","palegreen","mediumaquamarine","lightsteelblue","aquamarine","yellowgreen"],s=Math.floor(Math.random()*o.length);return o[s]};a.useEffect(()=>{},[V.draggables]);const Xt=(o=`${T/100*Math.round(de(25,55))}px`,s=`${le/100*Math.round(de(2,10))}px`,n=U)=>{if(document.activeElement instanceof HTMLElement&&document.activeElement.id===`make-random${t}`&&document.activeElement.blur(),q.has(U)){g(w(zs[e],!0,8));return}const c=Qe(),d=Qe(),$=Math.max(...V.draggables[t].map(L=>parseInt(L.id.split("-")[0].replace("blob",""),10))),D=isNaN(me[n])?1:me[n]+1,I={layer:n,id:`blob${$+1}-${t}`,number:$+1,i:Math.ceil(de(6.5,10)),x:o,y:s,z:`${D}`,background:`linear-gradient(${xr}, ${c??"cyan"},${d??"greenyellow"})`};h({type:"duplicateDraggable",payload:{d:t,draggable:I}})},eo=o=>{const s=o.id,n=window.getComputedStyle(o),c=parseInt(o.id.replace("blob","").split("-")[0],10),d=n.getPropertyValue("--i")??o.style.getPropertyValue("--i")??"7",$=n.getPropertyValue("left")??o.style.getPropertyValue("left"),D=n.getPropertyValue("top")??o.style.getPropertyValue("top"),I=n.getPropertyValue("z-index")??o.style.getPropertyValue("z-index"),L=n.getPropertyValue("background")??o.style.getPropertyValue("background"),ie=n.getPropertyValue("--layer")??o.style.getPropertyValue("--layer"),Le={layer:ie?parseInt(ie):U,id:s,number:c,i:isNaN(parseFloat(d))?7:parseFloat(d),x:$,y:D,z:I,background:L??"linear-gradient(90deg, cyan, greenyellow)"};h({type:"updateDraggable",payload:{d:t,draggable:Le}})};a.useEffect(()=>{var o,s;return se?se&&(document.body.style.overflowY="auto",document.body.style.overflowX="hidden",document.removeEventListener("touchmove",xe),u.current&&(u.current.style.overflow="auto"),(s=u.current)==null||s.removeEventListener("touchmove",xe)):(document.addEventListener("touchmove",xe,{passive:!1}),document.body.style.overflow="hidden",(o=u.current)==null||o.addEventListener("touchmove",xe,{passive:!1}),u.current&&(u.current.style.overflow="hidden")),()=>{var n;document.removeEventListener("touchmove",xe),(n=u.current)==null||n.removeEventListener("touchmove",xe)}},[se]);function to(){Me(!se)}const[Fe,Be]=a.useState(()=>{const o=localStorage.getItem(F),s=o?JSON.parse(o):null;return(s==null?void 0:s[0])??k}),[Oe,Ne]=a.useState(()=>{const o=localStorage.getItem(F),s=o?JSON.parse(o):null;return(s==null?void 0:s[1])??v}),[Ve,Ce]=a.useState(()=>{const o=localStorage.getItem(F),s=o?JSON.parse(o):null;return(s==null?void 0:s[2])??M}),ro={backgroundColor:`hsl(var(--hue${t}), calc(var(--saturation${t}) * 1%), calc(var(--lightness${t}) * 1%))`},[oo,Ke]=a.useState(J.current?{[`--hue${t}`]:`${J.current.value}`}:{[`--hue${t}`]:`${Fe}`}),[so,et]=a.useState(z.current?{[`--saturation${t}`]:`${z.current.value}`}:{[`--saturation${t}`]:`${Oe}`}),[ao,tt]=a.useState(Y.current?{[`--lightness${t}`]:`${Y.current.value}`}:{[`--lightness${t}`]:`${Ve}`});function no(){if(u.current){Ke({[`--hue${t}`]:`${Fe}`});const o=JSON.parse(JSON.stringify(X));o[t][0]=Fe,h({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}}),ae(o[t])}}function lo(){if(u.current){et({[`--saturation${t}`]:`${Oe}`});const o=JSON.parse(JSON.stringify(X));o[t][1]=Oe,h({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}}),ae(o[t])}}function co(){if(u.current){tt({[`--lightness${t}`]:`${Ve}`});const o=JSON.parse(JSON.stringify(X));o[t][2]=Ve,h({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}}),ae(o[t])}}a.useEffect(()=>{Y.current&&Ce(Y.current.value)},[(Kt=Y==null?void 0:Y.current)==null?void 0:Kt.value]),a.useEffect(()=>{z.current&&Ne(z.current.value)},[(er=z==null?void 0:z.current)==null?void 0:er.value]),a.useEffect(()=>{J.current&&Be(J.current.value)},[(tr=J==null?void 0:J.current)==null?void 0:tr.value]);function io(){tt({[`--lightness${t}`]:`${M}`}),Y.current&&(Y.current.value=M),Ce(M);const o=JSON.parse(JSON.stringify(X));o[t][2]=M,ae(o[t]),h({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}})}function uo(){et({[`--saturation${t}`]:`${v}`}),z.current&&(z.current.value=v),Ne(v);const o=JSON.parse(JSON.stringify(X));o[t][1]=v,ae(o[t]),h({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}})}function mo(){Ke({[`--hue${t}`]:`${k}`}),J.current&&(J.current.value=k),Be(k);const o=JSON.parse(JSON.stringify(X));o[t][0]=k,ae(o[t]),h({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}})}a.useEffect(()=>{ye()},[T,le,se]);const ye=()=>{const n=[12,34,56,78];i.current&&m.current&&T<250?G(i.current,15,0):i.current&&m.current&&G(i.current,23,0),Z.current&&m.current&&G(Z.current,50-Z.current.offsetWidth/m.current.offsetWidth*50,0),l.current&&m.current&&T<250?G(l.current,85-l.current.offsetWidth/m.current.offsetWidth*100,.3):l.current&&m.current&&G(l.current,77-l.current.offsetWidth/m.current.offsetWidth*100,.3),B.current&&m.current&&T<300?G(B.current,27,100-B.current.offsetHeight/m.current.offsetHeight*100):B.current&&m.current&&G(B.current,32,100-B.current.offsetHeight/m.current.offsetHeight*100),x.current&&m.current&&T<300?G(x.current,73-x.current.offsetWidth/m.current.offsetWidth*100,100-x.current.offsetHeight/m.current.offsetHeight*100):x.current&&m.current&&G(x.current,68-x.current.offsetWidth/m.current.offsetWidth*100,100-x.current.offsetHeight/m.current.offsetHeight*100),b.current&&m.current&&T<300?G(b.current,2,100-b.current.offsetHeight/m.current.offsetHeight*100):b.current&&m.current&&G(b.current,10,100-b.current.offsetHeight/m.current.offsetHeight*100),R.current&&m.current&&T<300?G(R.current,98-R.current.offsetWidth/m.current.offsetWidth*100,100-R.current.offsetHeight/m.current.offsetHeight*100):R.current&&m.current&&G(R.current,90-R.current.offsetWidth/m.current.offsetWidth*100,100-R.current.offsetHeight/m.current.offsetHeight*100),qe.forEach(c=>{c.forEach((d,$)=>{if(d.current&&ee.current){const D=$<4?0:100-d.current.offsetWidth/ee.current.offsetWidth*100,I=n[$%4];G(d.current,D,I)}})})};function G(o,s,n){o&&m.current&&(o.style.left=m.current.offsetWidth/100*s+"px",o.style.top=m.current.offsetHeight/100*n+"px")}a.useEffect(()=>{W&&je&&_e&&W&&N.current&&(N.current.style.top=`${W.top+W.width*-.05}px`,N.current.style.left=`${W.left+W.width*-.05}px`,N.current.style.width=`${W.width*1.1}px`,N.current.style.height=`${W.height*1.1}px`)},[W,je,_e]);const qt=ya(),ho=()=>{qt("/portfolio/blob?register=register")},fo=()=>{qt("/portfolio/blob?login=login")},bo=()=>{const o=document.getElementById(`button-container${t}`);o&&o.scrollIntoView({behavior:"smooth",block:"start"})},po={width:"100%",height:"auto",margin:"0 auto"},yo=async()=>{var s,n;if(document.getElementById("drag-wrap"+t)&&!p)try{let c={};for(let Le=0;Le<localStorage.length;Le++){const rt=localStorage.key(Le);if(rt){const rr=localStorage.getItem(rt);rr!==null&&(c[rt]=rr)}}H(!0);const D=await fetch("http://localhost:4000/api/blobs/screenshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:window.location.href,selector:`#drag-wrap${t}`,language:e,localStorageData:c,width:T,height:le})});if(!D.ok)throw g(w(K[e],!0,8)),H(!1),new Error(`Error: ${D.statusText}`);const I=await D.json(),L=f.current,ie=y.current;L&&ie&&(ie.src=`data:image/png;base64,${I.screenshot}`,L.style.display="block",ie.scrollIntoView({behavior:"smooth",block:"start"}),g(w(`${Us[e]}; ${Ys[e]}`,!1,10)),H(!1),Me(!0))}catch(c){(n=(s=c.response)==null?void 0:s.data)!=null&&n.message?h(w(c.response.data.message,!0,8)):g(w(K[e],!0,8)),console.error(K[e],c)}},Zt=()=>{const o=y.current;if(o&&o.src){const s=document.createElement("a");s.href=o.src,s.download="blobs.png",document.body.appendChild(s),s.click(),document.body.removeChild(s),g(w(Ws[e],!1,8))}else g(w(pr[e],!0,8)),console.error(pr[e])};a.useEffect(()=>{p&&g(w(`${sr[e]}...`,!1,20))},[p]);const[Se,vo]=a.useState(5),[go,xo]=a.useState({[t]:1}),He=(o,s)=>{xo(n=>({...n,[o]:s}))},$o=()=>{if(q.size===0){g(w("Please hide the layers you want to delete.",!0,8));return}if(Array.from(q).filter(d=>O[t].some($=>$.layer===d)).length>0&&!window.confirm(`${Js[e]}. ${_s[e]}`))return;const s=O[t].filter(d=>!q.has(d.layer)),n=he-q.size;if(n<1){g(w(Gs[e],!0,8));return}const c=s.map(d=>{const $=d.layer;let D=$;return q.forEach(I=>{$>I&&(D-=1)}),{...d,layer:D}});h({type:"setDraggablesAtD",payload:{d:t,draggables:c}}),pe(n),Te(n),fe(new Set),setTimeout(()=>{ye()},300)},ko=o=>{const s=he+o;if(s>9){g(w(Xs[e],!0,8));return}const n=O[t].map(c=>{const d=c.layer>U?c.layer+o:c.layer;return{...c,layer:d}});h({type:"setDraggablesAtD",payload:{d:t,draggables:n}}),pe(s),Te(s),fe(new Set),setTimeout(()=>{ye()},300)},Qt=(o,s,n)=>{const c=Math.random().toString(36).substr(2,9);return Ut?r.jsxs("div",{className:"pagination-controls",children:[s!==1?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>He(Number(o),1),disabled:s===1,className:"btn-small pagination-btn",children:["« ",r.jsx("span",{className:"scr",children:qs[e]})]}),r.jsxs("button",{onClick:()=>He(Number(o),Math.max(s-1,1)),disabled:s===1,className:"btn-small pagination-btn",children:[" ‹ ",r.jsx("span",{className:"scr",children:Zs[e]})]})]}):r.jsx(r.Fragment,{}),r.jsxs("span",{children:[Qs[e]," ",s," / ",n]}),s!==n?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>He(Number(o),Math.min(s+1,n)),disabled:s===n,className:"btn-small pagination-btn",children:[r.jsx("span",{className:"scr",children:Ks[e]})," › "]}),r.jsxs("button",{onClick:()=>He(Number(o),n),disabled:s===n,className:"btn-small pagination-btn",children:[r.jsx("span",{className:"scr",children:ea[e]})," »"]})]}):r.jsx(r.Fragment,{}),r.jsx("div",{className:"input-wrap items-per-page",children:r.jsxs("label",{htmlFor:`items-per-page${t}-${c}`,children:[r.jsx("input",{id:`items-per-page${t}-${c}`,className:"",type:"number",value:Se,placeholder:Se.toString(),min:1,max:100,onChange:d=>vo(Number(d.target.value))}),r.jsx("span",{children:ta[e]})]})})]}):r.jsx(r.Fragment,{})};return r.jsx(r.Fragment,{children:r.jsx("section",{className:"card",children:r.jsx("div",{children:r.jsxs("div",{id:`drag-container${t}`,className:`drag-container drag-container${t}`,children:[r.jsxs("div",{className:"blob-title-wrap",children:[r.jsxs("h2",{className:"blob-title",children:[or[e]," ",t+1]}),t===0?r.jsxs("p",{children:[Ue[e]," "]}):t===1?r.jsxs("p",{children:[Ro[e],"."," ",Ue[e]," "]}):t===2?r.jsxs("p",{children:[Io[e],"."," ",Ue[e]," "]}):r.jsx("p",{children:Ue[e]})]}),r.jsxs("div",{className:"label-container",children:[r.jsx("span",{id:`blobdescription${t}`,className:"scr",children:Fo[e]}),r.jsxs("span",{children:["[",ct[e],": ",U+1,"]"," "]}),r.jsx("span",{ref:S,id:`selectedvalue${t}`,className:"selectedvalue",children:$e[e]})]}),r.jsxs("div",{id:`button-container${t}`,className:"button-container",children:[r.jsxs("button",{ref:te,id:`stop-blobs${t}`,className:"stop-blobs tooltip-wrap ",onClick:o=>{Qr(o)},"aria-labelledby":`stop-blobs${t}-span`,children:[r.jsx("span",{id:`stop-blobs${t}-span`,className:"tooltip above space",children:Oo[e]}),mt?Vo[e]:Ho[e]]}),r.jsxs("button",{ref:A,id:`reset-blobs${t}`,"aria-labelledby":`reset-blobs${t}-span`,className:"reset-blobs tooltip-wrap",onClick:o=>{Kr(o)},children:[r.jsx("span",{id:`reset-blobs${t}-span`,className:"tooltip above space",children:zo[e]})," ",Uo[e]]}),r.jsxs("button",{id:`toggle-marker${t}`,"aria-labelledby":`toggle-marker${t}-span`,className:"toggle-marker tooltip-wrap",onClick:()=>Er(!je),children:[r.jsx("span",{id:`toggle-marker${t}-span`,className:"tooltip above space",children:`${Yo[e]}`}),je?Wo[e]:Jo[e]]}),r.jsxs("button",{ref:oe,id:`disable-scroll${t}`,"aria-labelledby":`disable-scroll${t}-span`,className:`disable-scroll tooltip-wrap ${se?"":"active"}`,onClick:()=>{to()},children:[r.jsx("span",{id:`disable-scroll${t}-span`,className:"tooltip above space",children:se?_o[e]:Go[e]}),se?Xo[e]:qo[e]]}),r.jsx("button",{id:`toggle-controls${t}`,"aria-labelledby":`toggle-controls${t}-span`,className:`toggle-controls ${_?"":"active"}`,onClick:()=>{jr(!_),_||setTimeout(()=>{ye()},200)},children:r.jsxs("span",{id:`toggle-controls${t}-span`,children:[" ",_?Zo[e]:Qo[e]]})}),r.jsxs("button",{id:`take-screenshot${t}`,"aria-labelledby":`take-screenshot${t}-span`,disabled:p,onClick:yo,className:"reset screenshot tooltip-wrap",children:[r.jsx(sa,{}),r.jsx("span",{id:`take-screenshot${t}-span`,className:"tooltip left below space",children:p?sr[e]:Ko[e]})]})]}),r.jsxs("div",{ref:ee,className:`drag-wrap-outest drag-wrap-outest${t}`,children:[r.jsxs("div",{ref:u,id:`drag-wrap-outer${t}`,className:"drag-wrap-outer",style:{...ao,...so,...oo,...ro},children:[r.jsxs("div",{tabIndex:0,ref:l,className:`make-smaller tooltip-wrap reset ${_?"":"hidden"}`,id:`make-smaller${t}`,children:[r.jsx(aa,{}),r.jsx("span",{id:`make-smaller${t}-span`,className:"tooltip left below",children:`${es[e]}. ${ar[e]}: ${nr[e]}`})]}),r.jsxs("div",{ref:R,className:`make-larger tooltip-wrap reset ${_?"":"hidden"}`,id:`make-larger${t}`,children:[r.jsx(na,{}),r.jsx("span",{id:`make-larger${t}-span`,className:"tooltip left above",children:`${ts[e]}. ${ar[e]}: ${nr[e]}`})]}),r.jsxs("div",{ref:i,className:`make-more tooltip-wrap reset ${_?"":"hidden"}`,id:`make-more${t}`,children:[r.jsx(la,{}),r.jsx("span",{id:`make-more${t}-span`,className:"tooltip right below",children:rs[e]})]}),r.jsxs("button",{ref:Z,className:`make-random tooltip-wrap ${_?"":"hidden"}`,id:`make-random${t}`,"aria-labelledby":`make-random${t}-span`,onClick:()=>Xt(),children:[r.jsx(ca,{}),r.jsx("span",{id:`make-random${t}-span`,className:"tooltip below",children:`${os[e]}. ${ss[e]}!`})]}),r.jsxs("div",{ref:b,className:`delete-blob tooltip-wrap reset ${_?"":"hidden"}`,id:`delete-blob${t}`,children:[r.jsx(ia,{}),r.jsx("span",{id:`delete-blob${t}-span`,className:"tooltip right above",children:as[e]})]}),r.jsxs("div",{ref:B,id:`layer-decrease${t}`,className:`layer-adjust layer-decrease tooltip-wrap ${_?"":"hidden"}`,children:[r.jsx("span",{id:`layer-decrease${t}-span`,className:"tooltip above",children:`${ns[e]} ${lr[e]}`}),r.jsx(yr,{})]}),r.jsxs("div",{ref:x,id:`layer-increase${t}`,className:`layer-adjust layer-increase tooltip-wrap ${_?"":"hidden"}`,children:[r.jsx("span",{id:`layer-increase${t}-span`,className:"tooltip above",children:`${ls[e]} ${lr[e]}`}),r.jsx(vr,{})]}),je&&_e&&W&&r.jsx("div",{ref:N,style:{position:"absolute",top:`${W.top+W.width*-.05}px`,left:`${W.left+W.width*-.05}px`,width:`${W.width*1.1}px`,height:`${W.height*1.1}px`,outline:"3px dashed black",outlineOffset:"2px",border:"3px dashed white",borderRadius:"50%",zIndex:999}}),r.jsx("div",{ref:m,id:`drag-wrap${t}`,className:"drag-wrap",children:r.jsx($a,{layerAmount:he,layer:U,hiddenLayers:q,changeBlobLayer:Cr,setActiveLayer:ce,highestZIndex:me,language:e,dispatch:h,d:t,items:O[t]??[],saveDraggables:Ot,getPosition:eo,colorBlockProps:qe,makeLarger0:R,makeSmaller0:l,makeMore0:i,deleteBlob0:b,layerIncrease:x,layerDecrease:B,dragWrap:m,exitApp:ne,selectedvalue0:S,setFocusedBlob:it,colorIndex:kr,setColorIndex:wr,colorPairs:nt,colorswitch:Qe,scroll:se,setScroll:Me,clickOutsideRef:m,addRandomDraggable:Xt})})]}),r.jsx(Sa,{d:t,language:e,getRefName:Nr,map:Br,colorBlockProps:qe,colorPairs:nt,controlsVisible:_})]}),r.jsxs("div",{className:"layer-mover-control-wrap",children:[r.jsxs("div",{className:`movers-wrap movers-wrap1 ${_?"":"hidden"}`,children:[r.jsxs("button",{id:`moveleft${t}`,"aria-labelledby":`moveleft${t}-span`,className:"moveleft mover tooltip-wrap narrow2",onClick:Xr,children:[r.jsx(da,{}),r.jsx("span",{id:`moveleft${t}-span`,className:"tooltip above",children:cs[e]})]}),r.jsxs("button",{id:`moveright${t}`,"aria-labelledby":`moveright${t}-span`,className:"moveright mover tooltip-wrap narrow2",onClick:Gr,children:[r.jsx(ua,{}),r.jsx("span",{id:`moveright${t}-span`,className:"tooltip above",children:is[e]})]})]}),r.jsxs("div",{className:"layer-btn-wrap layer-tools layer-tools1",children:[r.jsxs("button",{id:`decrease-layer-amount${t}`,"aria-labelledby":`decrease-layer-amount${t}-span`,className:"layer-tool layer-amount decrease-layer-amount tooltip-wrap narrow2",onClick:$o,children:[r.jsx("span",{id:`decrease-layer-amount${t}-span`,className:"tooltip above",children:ds[e]}),r.jsx(ma,{})]}),r.jsxs("button",{id:`every-layer-minus${t}`,"aria-labelledby":`every-layer-minus${t}-span`,className:"layer-tool every-layer tooltip-wrap narrow2",onClick:()=>_t(-1),children:[r.jsx("span",{id:`every-layer-minus${t}-span`,className:"tooltip above",children:us[e]}),r.jsx(yr,{})]})]}),r.jsx("div",{className:"layer-btn-wrap layers",children:Array.from({length:he},(o,s)=>s).map((o,s)=>r.jsx("button",{id:`layer-button${o}`,"aria-labelledby":`layer-button${o}-span`,onClick:()=>{U===o?Sr(o):ce(o)},className:`layer-button tooltip-wrap narrow2 ${U===o?"active":""} ${q.has(o)?"dim":""}`,children:r.jsxs("span",{id:`layer-button${o}-span`,children:[r.jsx("span",{className:"scr",children:ct[e]})," ",o+1," ",r.jsx("span",{className:"tooltip above",children:U===o?ms[e]:hs[e]})]})},`${o}*${s}`))}),r.jsxs("div",{className:"layer-btn-wrap layer-tools layer-tools2",children:[r.jsxs("button",{id:`every-layer-plus${t}`,"aria-labelledby":`every-layer-plus${t}-span`,className:"layer-tool every-layer tooltip-wrap narrow2",onClick:()=>_t(1),children:[r.jsx("span",{id:`every-layer-plus${t}-span`,className:"tooltip above",children:fs[e]}),r.jsx(vr,{})]}),r.jsxs("button",{id:`increase-layer-amount${t}`,"aria-labelledby":`increase-layer-amount${t}-span`,className:"layer-tool layer-amount increase-layer-amount tooltip-wrap narrow2",onClick:()=>ko(1),children:[r.jsx("span",{id:`increase-layer-amount${t}-span`,className:"tooltip above",children:bs[e]}),r.jsx(ha,{})]})]}),r.jsxs("div",{className:`movers-wrap movers-wrap2 ${_?"":"hidden"}`,children:[r.jsxs("button",{id:`moveup${t}`,"aria-labelledby":`moveup${t}-span`,className:"moveup mover tooltip-wrap narrow2",onClick:Zr,children:[r.jsx(fa,{}),r.jsx("span",{id:`moveup${t}-span`,className:"tooltip above",children:ps[e]})]}),r.jsxs("button",{id:`movedown${t}`,"aria-labelledby":`movedown${t}-span`,className:"movedown mover tooltip-wrap narrow2",onClick:qr,children:[r.jsx(ba,{}),r.jsx("span",{id:`movedown${t}-span`,className:"tooltip above",children:ys[e]})]})]})]}),r.jsx(La,{d:t,defaultHue:k,defaultSaturation:v,defaultLightness:M,setSliderHueVal:Be,setSliderSatVal:Ne,setSliderLightVal:Ce,language:e,sliderLightness:co,sliderSaturation:lo,sliderHue:no,sliderLightnessReset:io,sliderSaturationReset:uo,sliderHueReset:mo,sliderLightVal:Ve,sliderSatVal:Oe,sliderHueVal:Fe,sliderLightnessInput:Y,sliderSaturationInput:z,sliderHueInput:J}),r.jsx("div",{ref:ne,id:`exitblob${t}`,className:"exitblob"}),E?r.jsxs("div",{className:"blob-handling",children:[r.jsx("div",{className:"full wide flex column center gap",children:r.jsxs("form",{onSubmit:o=>zr(o),children:[r.jsx("div",{className:"input-wrap",children:r.jsxs("label",{htmlFor:`blobname${t}`,children:[r.jsx("input",{id:`blobname${t}`,type:"text",value:be,onChange:Vr,placeholder:Ye[e],maxLength:30}),r.jsxs("span",{children:[Ye[e],":"]})]})}),r.jsx("button",{type:"submit",children:vs[e]})]})}),r.jsxs("div",{ref:f,id:`blob-screenshot${t}`,style:{display:"none"},children:[r.jsx("button",{onClick:Zt,children:cr[e]}),r.jsx("img",{src:"",ref:y,alt:gs[e],style:po}),r.jsx("button",{onClick:Zt,children:cr[e]})]}),r.jsx("h3",{children:xs[e]}),Ar?r.jsx("p",{children:$s[e]}):!re||re.length<1?r.jsx("p",{children:ks[e]}):Ut?Object.keys(Ie).map((o,s)=>{const n=Object.keys(Ie[Number(o)]),c=Math.ceil(n.length/Se),d=go[Number(o)]??1,$=(d-1)*Se,D=$+Se,I=n.slice($,D);return r.jsxs("div",{className:"flex center margin0auto",children:[Qt(o,d,c),r.jsx("ul",{className:"blob-versions-wrap",children:I.map((L,ie)=>r.jsxs("li",{className:"blob-version-item",children:[r.jsx("span",{children:L}),r.jsxs("div",{className:"button-wrap",children:[r.jsxs("button",{onClick:()=>Yr(Number(o),L),children:[Es[e]," ",r.jsx("span",{className:"scr",children:L})]}),r.jsxs("button",{onClick:()=>Wr(Number(o),L),children:[js[e]," ",r.jsx("span",{className:"scr",children:L})]}),r.jsxs(Bs,{language:e,id:`accordion-blobnewname-${L.replace(/\s/g,"-")}`,className:"blobnewname",wrapperClass:"blobnewname-wrap",text:ir[e],hideBrackets:!0,onClick:()=>{Ht(L),Tr(L)},isOpen:Mr===L,children:[r.jsx("div",{className:"input-wrap",children:r.jsxs("label",{htmlFor:`blobnewname-${L.replace(/\s/g,"-")}`,children:[r.jsx("input",{id:`blobnewname-${L.replace(/\s/g,"-")}`,type:"text",value:Ae,onChange:Hr,placeholder:dr[e],maxLength:30}),r.jsxs("span",{children:[ir[e],":"]})," ",r.jsx("span",{className:"scr",children:L})]})}),r.jsxs("button",{onClick:()=>{L!==Ae?Ur(L,Ae):g(w(`${K[e]}: ${dr[e]}`,!0,5))},children:[Ns[e]," ",r.jsxs("span",{className:"scr",children:[L,": ",Cs[e]," ",Ae]})]})]})]})]},`${L}+${ie}`))},`${o}+${s}`),Qt(o,d,c)]},`${o}:${s}`)}):r.jsx("p",{children:ws[e]})]}):r.jsxs("div",{className:"wide flex column center gap",children:[r.jsxs("div",{className:"login-to-save wide flex column center gap-half",children:[r.jsx(pa,{}),Ss[e]]}),r.jsxs("div",{className:"blob-register-login-wrap",children:[r.jsx("button",{onClick:fo,children:Ls[e]}),r.jsx("big",{children:Ds[e]}),r.jsx("button",{onClick:ho,children:Ps[e]})]})]}),r.jsx("svg",{className:"filter",children:r.jsxs("filter",{id:"svgfilter0",children:[r.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"7"}),r.jsx("feColorMatrix",{values:`\r
1 0 0 0 0\r
0 1 0 0 0\r
0 0 1 0 0\r
0 0 0 50 -18\r
`})]})}),r.jsx("svg",{className:"filter",children:r.jsxs("filter",{id:"svgfilter1",children:[r.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"8"}),r.jsx("feColorMatrix",{values:`\r
1 0 0 0 0\r
0 1 0 0 0\r
0 0 1 0 0\r
0 0 0 46 -28\r
`})]})})]})})})})}const nn=({language:e})=>{const t=Array.from({length:3},(k,v)=>v),j=a.useRef(t.reduce((k,v)=>(k[v]=a.createRef(),k),{})),u=k=>r.jsx("div",{className:"to-blob-art-btn-wrap flex center gap-half",children:t.map((v,M)=>k===M?r.jsx(a.Fragment,{},M):r.jsxs("button",{style:{borderRadius:"1rem",flex:"0 0 auto"},className:"to-blob-art-btn grayer",onClick:()=>{const V=document.getElementById(`drag-container${M}`);V&&V.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},children:[ra[e]," ",oa[e]," ",M+1]},M))});return r.jsxs(r.Fragment,{children:[t.map((k,v)=>r.jsxs(a.Fragment,{children:[u(v),r.jsx(Ta,{language:e,d:k,ds:t.length,dragWrapOuter:j.current[k]})]},k)),u(-1)]})};export{nn as default};
