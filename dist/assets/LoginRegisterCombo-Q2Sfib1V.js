import{r as t,j as e}from"./react-kX_YxI4E.js";import{L as b,j as M,k as y,u as A,g as H,i as O,A as U,aE as k,e as m,aF as z,aG as D,aH as I}from"./index-BkJ1lIJR.js";import{a as P}from"./react-redux-BEmJlIGA.js";import{s as h}from"./quiz.module-DCrCubZg.js";import{L as _}from"./react-router-dom-StiqOUIT.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-CzVo0GbG.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";import"./use-sync-external-store-BPp6CH6k.js";const q=({easy:a,medium:l,hard:n,language:f})=>{const{t:o}=t.useContext(b),{windowWidth:s}=M(),[i,u]=t.useState(!0);return t.useEffect(()=>{s<y?u(!1):u(!0)},[s]),e.jsxs("table",{className:h.highscores,children:[e.jsx("caption",{children:o("YourHighscores")}),e.jsx("thead",{children:e.jsxs("tr",{className:h.th,children:[e.jsx("th",{children:o("Difficulty")}),e.jsx("th",{className:h.score,children:o("Score")}),i&&e.jsx("th",{className:h.percentage,children:"%"}),e.jsx("th",{children:o("Speed")})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:o("Easy")}),e.jsxs("td",{children:[a?a.score:0,"/300"]}),i&&e.jsxs("td",{children:[+(a.score*100/300).toFixed(1),"%"]}),e.jsx("td",{children:a.score===0||a.time===0?o("NA"):e.jsxs(e.Fragment,{children:[Math.floor(a.time/60)<10&&"0",Math.floor(a.time/60),":",a.time%60<10&&"0",a.time%60]})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:o("Medium")}),e.jsxs("td",{children:[l?l.score:0,"/300"]}),i&&e.jsxs("td",{children:[+(l.score*100/300).toFixed(1),"%"]}),e.jsx("td",{children:l.score===0||l.time===0?o("NA"):e.jsxs(e.Fragment,{children:[Math.floor(l.time/60)<10&&"0",Math.floor(l.time/60),":",l.time%60<10&&"0",l.time%60]})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:o("Hard")}),e.jsxs("td",{children:[n?n.score:0,"/300"]}),i&&e.jsxs("td",{children:[+(n.score*100/300).toFixed(1),"%"]}),e.jsx("td",{children:n.score===0||n.time===0?o("NA"):e.jsxs(e.Fragment,{children:[Math.floor(n.time/60)<10&&"0",Math.floor(n.time/60),":",n.time%60<10&&"0",n.time%60]})})]})]})]})},T=({easy:a,medium:l,hard:n,language:f,setIsFormOpen:o})=>{const{t:s}=t.useContext(b),i=A(),[u,S]=t.useState(!1),[E,w]=t.useState(""),[L,p]=t.useState(""),R=t.useRef(null),[g,C]=t.useState({easy:a??{score:0,time:210},medium:l??{score:0,time:210},hard:n??{score:0,time:210}}),[x,F]=t.useState(!1),r=P(d=>{var c;return(c=d.auth)==null?void 0:c.user});t.useEffect(()=>{r!=null&&r._id&&i(H(r._id)).then(d=>{d!==null&&C(d.highscores)})},[r==null?void 0:r._id]),t.useEffect(()=>{i(O())},[]);const j=()=>{i(k())},$=async d=>{d.preventDefault(),S(!0),i(m(s("LoggingIn"),!1,8)),await i(z(E,L,"en")).then(()=>{w(""),p(""),S(!1)}).catch(c=>{var N,v;(v=(N=c.response)==null?void 0:N.data)!=null&&v.message?i(m(c.response.data.message,!0,8)):c.code==="ERR_BAD_REQUEST"?i(m(`${s("Error")}: ${c.response.data.message}`,!0,8)):c.code==="ERR_NETWORK"&&i(m(`${s("Error")}: ${c.message}`,!0,8)),S(!1)})};return e.jsx("div",{className:"login-wrap",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsxs("span",{children:[s("LoggedInAs")," ",r!=null&&r.name?r==null?void 0:r.name:r.username," "]}),e.jsx(_,{to:"/edit",children:`${s("Edit")}`}),e.jsxs("button",{onClick:j,id:"logout",className:"logout danger",children:[s("Logout")," Ã—"]})]}),e.jsx("button",{onClick:()=>F(!x),className:h.showHighscores,children:`${x?"hide":"show"} highscores`}),x&&e.jsx(q,{language:f,easy:g.easy,medium:g.medium,hard:g.hard})]}):e.jsx(e.Fragment,{children:e.jsxs(U,{language:f,className:"accordion-login login-to-save",wrapperClass:"login-to-save-wrap",text:s("LogInToSaveScore"),ref:R,setIsFormOpen:o,hideBrackets:!0,children:[e.jsx("h2",{children:s("LogInToSaveScore")}),e.jsxs("form",{onSubmit:$,className:`login ${h.login}`,children:[e.jsx("div",{className:"input-wrap",children:e.jsxs("label",{htmlFor:"quiz-username",children:[e.jsx("input",{id:"quiz-username",name:"username",type:"text",value:E,required:!0,autoComplete:"email",onChange:({target:d})=>w(d.value.trim())}),e.jsxs("span",{children:[s("Username"),": "]})]})}),e.jsx("div",{className:"input-wrap",children:e.jsxs("label",{children:[e.jsx("input",{name:"password",type:"password",required:!0,autoComplete:"current-password",value:L,onChange:({target:d})=>p(d.value.trim())}),e.jsxs("span",{children:[s("Password"),": "]})]})}),e.jsx("button",{type:"submit",disabled:u,id:"login",className:"login",children:s("Login")})]})]})})})},de=({language:a,user:l,highscoresLocal:n,text:f})=>{const{t:o}=t.useContext(b),s=A(),[i,u]=t.useState(!1),[S,E]=t.useState(!1),[w,L]=t.useState(""),[p,R]=t.useState(""),[g,C]=t.useState(""),[x,F]=t.useState(""),[r,j]=t.useState(!1),$=d=>{if(d.preventDefault(),j(!0),p.trim()!==g.trim()){s(m(o("PasswordsDoNotMatch"),!0,8)),j(!1);return}s(I({name:x,username:w,password:p,language:"en"})).then(async()=>{s(m(o("RegistrationSuccesful"),!1,8)),j(!1)}).catch(c=>{var N,v;console.error(c),(v=(N=c.response)==null?void 0:N.data)!=null&&v.message?s(m(c.response.data.message,!0,8)):s(m(`${o("Error")}: ${c.message}`,!0,8)),j(!1)})};return e.jsxs("div",{className:`quiz-register-login-wrap register-login-wrap ${h["register-login-wrap"]}`,children:[e.jsx("div",{className:`${i?"open":""} ${l?"logged":""}`,children:e.jsx(T,{setIsFormOpen:u,language:a,easy:n.easy,medium:n.medium,hard:n.hard})}),e.jsx("div",{className:`${S?"open":""}`,children:e.jsx(D,{sending:r,setIsFormOpen:E,language:a,handleRegister:$,username:w,setUsername:L,password:p,setPassword:R,confirmPassword:g,setConfirmPassword:C,name:x,setName:F,text:f})})]})};export{de as default};
