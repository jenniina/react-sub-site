const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DragLayer-8RjFx5GY.js","assets/react-kX_YxI4E.js","assets/dom-to-image-more-CfDXlNbO.js","assets/index-C_Hs8uIh.js","assets/react-dom-B5MLDbn_.js","assets/scheduler-CzFDRTuY.js","assets/react-redux-BEmJlIGA.js","assets/hoist-non-react-statics-DQogQWOa.js","assets/react-is-DUDD-a5e.js","assets/use-sync-external-store-BPp6CH6k.js","assets/@reduxjs-DhFEcpJw.js","assets/immer-C0GRqQ_d.js","assets/redux-CE3tqztX.js","assets/@babel-DF5_wy6Y.js","assets/redux-thunk-CY0Q9z1Q.js","assets/axios-CCb-kr4I.js","assets/react-icons-D7bD3W54.js","assets/react-router-dom-StiqOUIT.js","assets/react-router-DUuhLvki.js","assets/@remix-run-DTnHqtaE.js","assets/index-Dgb_yWai.css"])))=>i.map(i=>d[i]);
import{_ as Ee,g$ as Pe,ki as xe,e as Te}from"./index-C_Hs8uIh.js";import{r as i,j as L}from"./react-kX_YxI4E.js";import"./react-dom-B5MLDbn_.js";import"./dom-to-image-more-CfDXlNbO.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-D7bD3W54.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const Ce=i.lazy(()=>Ee(()=>import("./DragLayer-8RjFx5GY.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])));let V,a=!0,N=0,R=0,w,D=0,S=null,X="90deg",r;const h=k=>{k.preventDefault(),k.stopImmediatePropagation()},tt=({layer_:k,layerAmount:E,hiddenLayers:oe,setActiveLayer:z,changeBlobLayer:_,highestZIndex:j,language:M,dispatch:u,d:n,items:ae,saveDraggables:re,getPosition:F,dragWrap:ne,selectedvalue0:le,exitApp:y,colorBlockProps:Ve,colorPairs:B,makeLarger0:Me,makeSmaller0:Ue,makeMore0:Ie,removeBlob:O,mode:se,layerIncrease:Ye,layerDecrease:$e,setFocusedBlob:U,colorIndex:H,setColorIndex:ie,setScroll:ue,scroll:v,clickOutsideRef:de,colorswitch:I,addRandomDraggable:ce,changeColor:pe})=>{const fe=[...ae].sort((e,t)=>e.layer-t.layer).reduce((e,t)=>(e[t.layer]||(e[t.layer]=[]),e[t.layer].push(t),e),{}),Z=Array.from({length:E},(e,t)=>t),q=i.useRef({});i.useEffect(()=>{const e=Z.reduce((t,o)=>(t[o]=i.createRef(),t),{});q.current=e},[E]);const l=()=>{try{return document.createEvent("TouchEvent"),!0}catch{return!1}};i.useEffect(()=>{l()},[]);const me=i.useCallback(e=>{a=!0,document.removeEventListener("keydown",d),document.removeEventListener("touchmove",h)},[d]);Pe({ref:de,onOutsideClick:me}),i.useEffect(()=>{l()&&!r&&v&&(document.body.style.overflowY="auto",document.body.style.overflowX="hidden",document.removeEventListener("keydown",d),document.removeEventListener("touchmove",h))},[r,v,l,d]);const ye=i.useCallback((e,t)=>{e.stopPropagation(),e.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),V=!0,r=t,N=l()?e.touches[0].clientX:e.clientX,R=l()?e.touches[0].clientY:e.clientY,t.classList.add("drag");const o=j[k];if(l()){let p=(t==null?void 0:t.style.getPropertyValue("--i"))??"10";w=parseFloat(p),w=isNaN(w)?10:w}u({type:"partialUpdate",payload:{d:n,id:t.id,update:{z:`${Math.max(1,o+1)}`}}}),document.addEventListener("keydown",d);const c=t.style.getPropertyValue("--layer");z(isNaN(parseInt(c))?1:parseInt(c)),l()&&(document.addEventListener("touchmove",h,{passive:!1}),document.body.style.overflow="hidden")},[d,l]),ve=i.useCallback(e=>{if(e.stopPropagation(),l()&&(e.preventDefault(),document.body.style.overflow="hidden"),V){let t=l()?e.touches[0].clientX:e.clientX,o=l()?e.touches[0].clientY:e.clientY;r.style.top=r.offsetTop-(R-o)+"px",r.style.left=r.offsetLeft-(N-t)+"px",N=t,R=o,u({type:"partialUpdate",payload:{d:n,id:r==null?void 0:r.id,update:{x:r.style.left,y:r.style.top}}})}},[l]),G=i.useCallback((e,t)=>{e.stopPropagation(),e.preventDefault(),V=!1,D++,S&&clearTimeout(S),S=setTimeout(()=>{if(D===2){let o=w-.8;o=Math.max(7,o),u({type:"partialUpdate",payload:{d:n,id:r==null?void 0:r.id,update:{i:o}}})}else if(D===3){let o=w+.8;o=Math.min(36,o),u({type:"partialUpdate",payload:{d:n,id:r==null?void 0:r.id,update:{i:o}}})}D=0},300),document.removeEventListener("keydown",d),t.style.getPropertyValue("--i"),l()&&v?(document.removeEventListener("touchmove",h),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):l()&&!v&&(document.body.style.overflow="hidden"),t.classList.remove("drag"),t.blur(),D===0?r=null:r=t,U(null)},[X,d,v]),J=i.useCallback((e,t)=>{e.stopPropagation(),V=!1,r=null,l()&&v?(document.removeEventListener("touchmove",h),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):l()&&!v&&(document.body.style.overflow="hidden"),F(t),t.classList.remove("drag"),document.removeEventListener("keydown",d),t.blur()},[d]);i.useEffect(()=>{l()&&!r&&v&&(document.removeEventListener("touchmove",h),document.body.style.overflowY="auto",document.body.style.overflowX="hidden")},[G,J,r,v]);function be(e){e.classList.remove("drag"),document.removeEventListener("keydown",d),F(e),e.draggable=!1,r=null}function ke(e){r=e,e.classList.add("drag");const t=e.style.getPropertyValue("--layer");z(parseInt(t)??2),document.addEventListener("keydown",d),e.draggable=!0}function ge(e){const t=o=>we(o,e);return v||e.addEventListener("wheel",t,{passive:!1}),()=>{e.removeEventListener("wheel",t)}}function we(e,t){if(a){a=!1;let c=window.getComputedStyle(t).getPropertyValue("--i")??t.style.getPropertyValue("--i")??"10",p=parseFloat(c);p=isNaN(p)?10:p,e.deltaY<0?p*=1.04:p*=.96,p=Math.min(Math.max(7,p),36),u({type:"partialUpdate",payload:{d:n,id:t.id,update:{i:p}}}),setTimeout(()=>{a=!0},100)}}i.useEffect(()=>{const e=r;if(e){const{color1:t,color2:o}=B[n][H],c=`linear-gradient(${X}, ${t}, ${o})`;u({type:"partialUpdate",payload:{d:n,id:e.id,update:{background:c}}})}},[H]);function d(e){var W,A;const o=r;if(!o)return;const c=window.getComputedStyle(o),p=m=>{var te;const b=parseFloat(c.marginTop),$=parseFloat(c.marginLeft),C=m.getBoundingClientRect(),ee=(te=m.parentNode)==null?void 0:te.getBoundingClientRect();U({top:C.top-ee.top-b,left:C.left-ee.left-$,width:C.width,height:C.height})};let Q=c.getPropertyValue("--i")??o.style.getPropertyValue("--i")??"10",f=parseFloat(Q);f=isNaN(f)?10:f;let P=parseFloat(c.getPropertyValue("left"))??parseFloat(o.style.getPropertyValue("left"))??0,x=parseFloat(c.getPropertyValue("top"))??parseFloat(o.style.getPropertyValue("top"))??0;const Le=o.style.getPropertyValue("--layer"),g={layer:parseInt(Le)??k,id:o.id,number:parseInt(o.id.replace("blob","").split("-")[0],10),i:f,x:o.style.getPropertyValue("left").toString(),y:o.style.getPropertyValue("top").toString(),z:o.style.zIndex??"0",background:o.style.background??"linear-gradient(90deg, cyan, greenyellow)"},T=(m,b)=>{u({type:"partialUpdate",payload:{d:n,id:o.id,update:{x:`${m}px`,y:`${b}px`}}}),p(o)},s=()=>{a=!0},De=m=>{e.preventDefault(),a&&(a=!1,_(g,m),setTimeout(s,100))},Y=e.key;switch(parseInt(Y)>=1&&parseInt(Y)<=E&&De(parseInt(Y)-1),e.key){case"ArrowLeft":e.preventDefault(),a&&(T(P-4,x),setTimeout(s,100));break;case"ArrowRight":e.preventDefault(),a&&(T(P+4,x),setTimeout(s,100));break;case"ArrowUp":e.preventDefault(),a&&(T(P,x-4),setTimeout(s,100));break;case"ArrowDown":e.preventDefault(),a&&(T(P,x+4),setTimeout(s,100));break;case"Escape":e.preventDefault(),ue(!0),document.body.style.overflowY="auto",document.body.style.overflowX="hidden",y.current&&(y.current.setAttribute("tabindex","0"),y.current.addEventListener("blur",K)),o.blur(),(W=ne.current)==null||W.blur(),y.current&&(y.current.textContent=xe[M]),(A=y.current)==null||A.focus();break;case"Enter":e.preventDefault(),e.stopPropagation(),a&&(a=!1,o.closest(`#drag-wrap${n}`)&&ie(m=>(m+1)%B[n].length),setTimeout(s,100));break;case"R":case"r":case" ":if(e.preventDefault(),e.stopPropagation(),a){if(a=!1,o.closest(`#drag-wrap${n}`)){const m=I();let b=I();b===m&&(b=I());const $=`linear-gradient(${X}, ${m}, ${b})`;u({type:"partialUpdate",payload:{d:n,id:o.id,update:{background:$}}})}setTimeout(s,100)}break;case"Z":case"z":e.preventDefault(),a&&(a=!1,u({type:"partialUpdate",payload:{d:n,id:o.id,update:{z:"0"}}}),setTimeout(s,100));break;case"T":case"t":e.preventDefault(),a&&(a=!1,u({type:"partialUpdate",payload:{d:n,id:o.id,update:{z:`${Math.max(1,j[k]+1)}`}}}),setTimeout(s,100));break;case"S":case"s":e.preventDefault(),a&&(a=!1,f-=.4,f=Math.min(Math.max(7,f),36),u({type:"partialUpdate",payload:{d:n,id:o.id,update:{i:f}}}),setTimeout(s,100));break;case"B":case"b":case"L":case"l":e.preventDefault(),a&&(a=!1,f+=.4,f=Math.min(Math.max(7,f),36),u({type:"partialUpdate",payload:{d:n,id:o.id,update:{i:f}}}),setTimeout(s,100));break;case"C":case"c":case"D":case"d":e.preventDefault(),a&&(a=!1,he(g),setTimeout(s,100));break;case"+":e.preventDefault(),a&&(a=!1,ce(g.x,g.y,g.layer),setTimeout(s,200));break;case"Delete":case"-":e.preventDefault(),a&&(a=!1,O(g),setTimeout(s,100));break}}function K(){var e,t;y.current&&((e=y.current)==null||e.removeAttribute("tabindex"),(t=y.current)==null||t.removeEventListener("blur",K),y.current.textContent="")}function he(e){u({type:"duplicateDraggable",payload:{d:n,draggable:e}})}return L.jsx(L.Fragment,{children:Z.map((e,t)=>L.jsx(i.Suspense,{fallback:L.jsxs("div",{className:"flex center margin0auto textcenter",children:[Te[M],"..."]}),children:L.jsx(Ce,{layer_:e,dragUlRef:q.current[e],items:fe[e]||[],className:oe.has(e)?"hidden":"",language:M,d:n,saveDraggables:re,selectedvalue0:le,setFocusedBlob:U,start:ye,movement:ve,stopMovementCheck:G,stopMoving:J,wheel:ge,focused:ke,blurred:be,removeBlob:O,mode:se,changeBlobLayer:_,layerAmount:E,changeColor:pe},e)},t))})};export{tt as default};
