import{r as i,j as a}from"./react-kX_YxI4E.js";import{L as ee,l as le,aT as J,ak as r,S as X,aD as g,aU as E,I as ie,u as te,e as Z}from"./index-CfQMFy_0.js";import{be as ce,bf as me,bg as ue,bh as he,bi as pe,bj as xe,bk as fe,bl as ge,bm as je,bn as be,bo as Ne}from"./react-icons-CzVo0GbG.js";import{R as de}from"./react-dom-B5MLDbn_.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";import"./scheduler-CzFDRTuY.js";const o=ie(6),we=({todo:e,language:h,priorityOptions:$,categoryOptions:N,handleModify:z,sending:B,newCategory:Q,newPriority:L,setNewPriority:q,setNewCategory:W,showDeadline:d,setShowDeadline:U,title:H,newName:s,setNewName:I,newDay:p,setNewDay:w,newMonth:y,setNewMonth:S,newYear:j,setNewYear:F,setIsOpen:P,maxCharacters:C})=>{const{t:l}=i.useContext(ee),[Y,m]=i.useState(null),_=n=>{I(n.target.value)},K=n=>{Number(n)<=31&&n.length<=2?(w(n),m(null)):m(`${l("Set")}: ${l("Day")}`)},A=n=>{Number(n)<=12&&n.length<=2?(S(n),m(null)):m(`${l("Set")}: ${l("Month")}`)},O=n=>{const u=n.target.value;Number(u)<=Number(new Date().getFullYear())+10&&u.length<=4?(F(u),m(null)):m(l("YearMustBeBetweenCurrentYearAnd10YearsFromNow"))};i.useEffect(()=>{if(p&&y&&j){const n=new Date(Number(j),Number(y)-1,Number(p)),u=new Date;u.setHours(0,0,0,0),m(null),n<u&&m(l("TheDateIsInThePast"))}},[p,y,j,h]),i.useEffect(()=>{d?(p||w((new Date().getDate()+1).toString().padStart(2,"0")),y||S((new Date().getMonth()+1).toString().padStart(2,"0")),j||F(new Date().getFullYear().toString())):(w(""),S(""),F(""))},[d]);const b=i.useRef(null),x=i.useRef(null);i.useEffect(()=>{var u;x.current=document.activeElement,(u=b.current)==null||u.focus();const n=c=>{var R,D;if(c.key==="Tab"){const f=(D=(R=b.current)==null?void 0:R.parentElement)==null?void 0:D.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!f||f.length===0){c.preventDefault();return}const T=f==null?void 0:f[0],v=f==null?void 0:f[f.length-1];c.shiftKey?document.activeElement===T&&(c.preventDefault(),v==null||v.focus()):document.activeElement===v&&(c.preventDefault(),T==null||T.focus())}else c.key==="Escape"&&k()};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n),x.current?x.current.focus():document.body.focus()}},[b.current]);const k=()=>{P(!1),x.current?x.current.focus():document.body.focus()},G=le();return de.createPortal(a.jsx("div",{className:`${J["modal-overlay"]} ${G?r.light:""}`,onClick:k,children:a.jsxs("div",{className:`${J["modal-content"]} ${r["todo-modal"]}`,onClick:n=>n.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":H??"Task",children:[a.jsxs("button",{ref:b,className:`${J["close-button"]} tooltip-wrap`,onClick:k,children:[a.jsx("span",{"aria-hidden":"true",children:"Ã—"}),a.jsx("span",{className:"scr",children:l("Close")}),a.jsx("span",{"aria-hidden":"true",className:"tooltip below left narrow2",children:l("Close")})]}),a.jsx("h2",{children:l("Edit")}),a.jsxs("form",{onSubmit:z,className:`${r.modify}`,children:[a.jsx(X,{id:`category_${g(E((e==null?void 0:e.name)??o,h))}`,className:`${r.select} ${r["category-select"]}`,value:N==null?void 0:N.find(n=>n.value===Q),onChange:n=>W(n==null?void 0:n.value),options:N,instructions:l("SelectCategory"),language:h,hideDelete:!0,z:3}),a.jsx(X,{id:`priority_${g(E((e==null?void 0:e.name)??o,h))}`,className:`${r.select}`,value:$==null?void 0:$.find(n=>n.value===L),onChange:n=>q(n==null?void 0:n.value),options:$,instructions:l("Priority"),language:h,hideDelete:!0,z:2}),a.jsxs("fieldset",{className:`${r.fieldset} ${r["deadline-wrap"]}`,children:[a.jsx("legend",{children:a.jsxs("label",{children:[l("Deadline")," ",a.jsx("input",{style:{marginLeft:"0.5em"},type:"checkbox",checked:d,onChange:()=>U(!d)})]})}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:r["deadline-inputs"],children:[a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`day_${g(E((e==null?void 0:e.name)??l("Task"),h))}`,children:l("Day")}),a.jsx("input",{type:"number",id:`day_${g((e==null?void 0:e.name)||"Task")}`,name:"day",min:1,max:31,value:p,placeholder:"DD",onChange:n=>K(n.target.value),required:!0,className:"bg"})]}),a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`month_${g((e==null?void 0:e.name)||"Task")}`,children:l("Month")}),a.jsx("input",{type:"number",id:`month_${g(E((e==null?void 0:e.name)??l("Task"),h))}`,name:"month",min:1,max:12,value:y,placeholder:"MM",onChange:n=>A(n.target.value),required:!0,className:"bg"})]}),a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`year_${g((e==null?void 0:e.name)||"Task")}`,children:l("Year")}),a.jsx("input",{type:"number",id:`year_${g(E((e==null?void 0:e.name)??l("Task"),h))}`,name:"year",min:new Date().getFullYear(),max:new Date().getFullYear()+10,value:j,placeholder:"YYYY",onChange:n=>O(n),required:!0,className:"bg"})]})]})," ",Y&&a.jsx("p",{className:r.error,children:Y})]})]}),a.jsxs("fieldset",{className:`${r.fieldset} ${r.textarea}`,children:[a.jsx("legend",{children:l("Task")}),a.jsxs("label",{children:[a.jsx("textarea",{id:`task_${g(e==null?void 0:e.name)}`,required:!0,name:"task",rows:4,value:s,onChange:_}),a.jsxs("p",{className:r.small,children:[C-s.length," ",l("CharactersLeft")," (",l("Max"),":"," ",C,")"," ",s.length>C&&a.jsx("span",{className:r.warning,children:l("NameTooLong")})]}),a.jsxs("span",{className:"scr",children:[l("Edit")," ",E((e==null?void 0:e.name)??l("Task"),h)]})]})]}),a.jsxs("button",{type:"submit",disabled:B,className:"modify",children:[l("Confirm")," ",a.jsx(ce,{})]}),a.jsxs("button",{onClick:k,className:`reset ${r.cancel}`,type:"button",children:[l("Cancel")," ",a.jsx(me,{})]})]})]})}),document.getElementById("modal-root"))};function ze({todo:e,toggleTodo:h,deleteTodo:$,language:N,modifyTodo:z,isDragging:B,handleUpdate:Q,handleDragging:L,sending:q,priorityOptions:W,categoryOptions:d,zin:U,maxCharacters:H}){const{t:s}=i.useContext(ee),I=te(),[p,w]=i.useState((e==null?void 0:e.name)??""),[y,S]=i.useState(!1),[j,F]=i.useState((e==null?void 0:e.priority)||"low"),[P,C]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getDate().toString().padStart(2,"0"):""),[l,Y]=i.useState(e!=null&&e.deadline?(new Date(e.deadline).getMonth()+1).toString().padStart(2,"0"):""),[m,_]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getFullYear().toString():""),K=P&&l&&m?`${m}-${l}-${P}`:"",[A,O]=i.useState((e==null?void 0:e.category)||"other"),[b,x]=i.useState(!1);function k(){h(e==null?void 0:e.key)}function G(){window.confirm(s("AreYouSureYouWantToDelete")+' "'+(e==null?void 0:e.name)+'"?')&&(w(""),$(e==null?void 0:e.key),x(!1))}const n=t=>{if(t.preventDefault(),p===""){I(Z(s("AddTask"),!0,5));return}if(p.length>H){I(Z(s("NameTooLong"),!0,5));return}z(e==null?void 0:e.key,p,j,K,A),x(!1)};i.useEffect(()=>{e!=null&&e.deadline&&S(!0)},[e]),i.useEffect(()=>{if((e==null?void 0:e.name)!==p&&w((e==null?void 0:e.name)||""),e!=null&&e.deadline){const t=new Date(e.deadline);C(t.getDate().toString().padStart(2,"0")),Y((t.getMonth()+1).toString().padStart(2,"0")),_(t.getFullYear().toString())}},[e]);const[u,c]=i.useState(!0),[R,D]=i.useState(!1),f=()=>{c(!0),D(!1)},T=()=>{c(!0)},v=()=>{c(!1)},ae=()=>{c(!1),D(!0)},se=()=>{var t;(t=window.getSelection())!=null&&t.toString()?(c(!1),D(!0)):(c(!0),D(!1))},ne=t=>{R&&t.preventDefault()};return a.jsx(a.Fragment,{children:a.jsxs("li",{style:{zIndex:`calc(${U} - ${e==null?void 0:e.order})`},className:`${B?"dragging":""} ${b?r.open:r.closed}`,draggable:u,onDragStart:t=>{var M;u?(t.dataTransfer.setData("application/my-app",(M=e==null?void 0:e.order)==null?void 0:M.toString()),L(!0)):t.preventDefault()},onDragEnd:()=>L(!1),children:[a.jsxs("span",{onMouseOver:T,onMouseDown:f,className:`${r["drag-handle"]} tooltip-wrap`,children:[a.jsx(ue,{}),a.jsx("span",{className:"tooltip narrow2 below right",children:s("Draggable")})]}),a.jsxs("label",{onClick:ne,children:[a.jsx("input",{type:"checkbox",id:`check_${g(e==null?void 0:e.name)}`,checked:(e==null?void 0:e.complete)??!1,onChange:k}),a.jsx("span",{onMouseOver:v,onMouseDown:ae,onMouseUp:se,children:e==null?void 0:e.name}),a.jsx("div",{className:`${r["more-info-wrap"]}`,children:(e==null?void 0:e.deadline)&&(e==null?void 0:e.deadline)!==""&&(()=>{const t=new Date(e.deadline),M=new Date;t.setHours(0,0,0,0),M.setHours(0,0,0,0);const re=t<M,V=t.getTime()===M.getTime();return a.jsxs("span",{className:`${r.deadline} ${re?r.overdue:""} ${V?r.today:""}`,children:[s("Deadline"),":"," ",V?s("Today"):new Date(e.deadline).toLocaleDateString(N,{year:"numeric",month:"long",day:"numeric"})]})})()})]}),a.jsxs("div",{className:`${r["btn-wrap"]}`,children:[(e==null?void 0:e.priority)==="high"?a.jsxs("b",{className:`tooltip-wrap ${r.high}`,children:[a.jsx(he,{}),a.jsxs("span",{className:"scr",children:[s("Priority"),": ",s("High")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("Priority"),": ",s("High")]})]}):(e==null?void 0:e.priority)==="medium"?a.jsxs("b",{className:`tooltip-wrap ${r.medium}`,children:[a.jsx(pe,{}),a.jsxs("span",{className:"scr",children:[s("Priority"),": ",s("Medium")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("Priority"),": ",s("Medium")]})]}):(e==null?void 0:e.priority)==="low"?a.jsxs("b",{className:`tooltip-wrap ${r.low}`,children:[a.jsx(xe,{viewBox:"0 0 17 17"}),a.jsxs("span",{className:"scr",children:[s("Priority"),": ",s("Low")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("Priority"),": ",s("Low")]})]}):a.jsx(a.Fragment,{children:"Â "}),(e==null?void 0:e.category)==="personal"?a.jsxs("b",{className:`tooltip-wrap ${r.cat}`,children:[a.jsx(fe,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Personal")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Personal")]})]}):(e==null?void 0:e.category)==="work"?a.jsxs("b",{className:`tooltip-wrap ${r.cat} ${r.bg}`,children:[a.jsx(ge,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Work")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Work")]})]}):(e==null?void 0:e.category)==="shopping"?a.jsxs("b",{className:`tooltip-wrap ${r.cat} ${r.bg}`,children:[a.jsx(je,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Shopping")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Shopping")]})]}):a.jsxs("b",{className:`tooltip-wrap ${r.cat}`,children:[a.jsx(be,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Other")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Other")]})]}),a.jsxs("button",{onClick:()=>x(!0),className:`${r.edit} tooltip-wrap`,disabled:(e==null?void 0:e.complete)??!1,children:[a.jsx(Ne,{}),a.jsx("span",{className:"scr",children:s("Edit")}),a.jsx("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:s("Edit")})]}),a.jsxs("button",{className:`${r.delete} tooltip-wrap`,onClick:b?()=>x(!1):G,children:[a.jsx("span",{className:r["delete-inner"],"aria-hidden":"true",children:"Ã—"}),a.jsx("span",{className:"scr",children:s("DeleteTask")}),a.jsx("span",{className:"tooltip below left narrow2","aria-hidden":"true",children:s("DeleteTask")})]})]}),b&&a.jsx(we,{title:e==null?void 0:e.name,language:N,handleModify:n,newName:p,setNewName:w,newPriority:j,setNewPriority:F,newDay:P,setNewDay:C,newMonth:l,setNewMonth:Y,newYear:m,setNewYear:_,newCategory:A,setNewCategory:O,priorityOptions:W,categoryOptions:d,showDeadline:y,setShowDeadline:S,sending:q,todo:e,setIsOpen:x,maxCharacters:H})]})})}export{ze as default};
