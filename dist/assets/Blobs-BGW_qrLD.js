import{j as r,r as s}from"./react-A9DAvxly.js";import{U as Ue,V as $e,W as $o,X as lt,Y as ko,Z as wo,_ as Eo,$ as jo,a0 as Bo,a1 as No,a2 as So,a3 as Co,a4 as Lo,a5 as Do,H as Po,a6 as To,a7 as tr,R as E,a8 as rr,a9 as ze,aa as Mo,ab as Ao,ac as Ro,ad as Io,ae as Fo,af as Oo,ag as Vo,ah as Ho,ai as Uo,aj as zo,ak as Yo,al as Wo,am as Jo,an as _o,ao as Xo,ap as Go,aq as qo,ar as Zo,as as Qo,at as or,au as ar,av as Ko,aw as ea,ax as ta,ay as ra,az as oa,aA as aa,aB as sr,aC as sa,aD as na,aE as la,aF as ca,aG as ia,aH as da,aI as ua,aJ as ma,aK as ha,aL as fa,aM as ba,aN as Ye,aO as ya,aP as nr,aQ as pa,aR as va,aS as xa,aT as ga,aU as $a,aV as ka,aW as wa,aX as Ea,aY as lr,aZ as cr,a_ as K,a$ as ja,b0 as Ba,b1 as Na,b2 as Sa,b3 as Ca,b4 as La,b5 as ir,b6 as dr,b7 as ur,b8 as Da,b9 as mr,ba as hr,bb as Pa,bc as Ta,bd as Ma,be as Aa,bf as Ra,bg as Ia,bh as Fa,bi as Oa,bj as Va,bk as Ha,bl as Ua,bm as za,bn as fr,bo as Ya,bp as Wa,bq as Ja,br as _a,bs as Xa,bt as Ga,bu as qa,bv as Za,bw as Qa,bx as Ka,by as es,bz as ts}from"./index-Dc1-bH4Q.js";import{V as rs,W as os,X as as,Y as ss,Z as ns,_ as ls,$ as br,a0 as yr,K as cs,J as is,a1 as ds,a2 as us,o as ms,S as hs,a3 as fs}from"./react-icons-B_BWYIjI.js";import{a as pr}from"./react-redux-CHm9GgGE.js";import{a as ke}from"./axios-BimPEqV4.js";import{c as bs}from"./react-router-KETZ66Sq.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./react-dom-yh0erWL-.js";import"./scheduler-CzFDRTuY.js";import"./@reduxjs-DTZ4pglK.js";import"./immer-BNrqi0cU.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./react-router-dom-Dz0dtoa0.js";import"./@remix-run-DTnHqtaE.js";import"./react-is-DUDD-a5e.js";import"./uuid-Dv1xt2bl.js";import"./use-sync-external-store-DEc9BFqZ.js";function ys(e,t,w){return Math.min(Math.max(t,e),w)}const ps=({d:e,layer:t,language:w,item:i,index:$,start:p,movement:P,stopMovementCheck:O,stopMoving:x,wheel:v,focused:k,blurred:re,selectedvalue0:u,setFocusedBlob:ee,dragUlRef:C})=>{const te=e===0?33:ys(22,i.i*2.6,50),oe={background:`${i.background}`,display:"block",left:`${i.x}`,top:`${i.y}`,zIndex:`${i.z}`,"--i":isNaN(Number(i.i))?"7":`${i.i}`,"--layer":`${t}`,WebkitFilter:`blur(${te}px)`,filter:`blur(${te}px)`},M=e===0?["5.9px","8.2px","9.9px","10.8px","10.7px","10.5px","10px"]:["5.1px","5.4px","6.5px","7px","7.8px","8.4px","8.6px"];return r.jsxs("li",{onFocus:m=>{var f;C&&C.current&&((f=C.current)==null||f.setAttribute("aria-activedescendant",`${m.target.id}`));const y=m.target;y.parentNode,setTimeout(()=>{var h,g;const V=y.getBoundingClientRect(),ne=(h=y.parentNode)==null?void 0:h.getBoundingClientRect(),A=y.closest(".drag-wrap-outer"),n=A==null?void 0:A.scrollLeft,c=A==null?void 0:A.scrollTop;ee({top:V.top-ne.top-c,left:V.left-ne.left-n,width:V.width,height:V.height}),u.current&&(u.current.textContent=`${Ue[w]}: ${(g=y.querySelector("span"))==null?void 0:g.textContent}`)},500),k(y)},onBlur:m=>{var y;ee(null),re(m.target),C&&C.current&&((y=C.current)==null||y.removeAttribute("aria-activedescendant")),u.current&&(u.current.textContent=`${$e[w]}`)},className:"dragzone animation",id:i.id,role:"option",tabIndex:0,style:oe,children:[r.jsx("div",{className:"draggable-overlay",style:Number(i.i)<8?{width:`calc(var(--i) * ${M[0]})`,height:`calc(var(--i) * ${M[0]})`}:Number(i.i)<10?{width:`calc(var(--i) * ${M[1]})`,height:`calc(var(--i) * ${M[1]})`}:Number(i.i)<20?{width:`calc(var(--i) * ${M[2]})`,height:`calc(var(--i) * ${M[2]})`}:Number(i.i)<24?{width:`calc(var(--i) * ${M[3]})`,height:`calc(var(--i) * ${M[3]})`}:Number(i.i)<28?{width:`calc(var(--i) * ${M[4]})`,height:`calc(var(--i) * ${M[4]})`}:Number(i.i)<32?{width:`calc(var(--i) * ${M[5]})`,height:`calc(var(--i) * ${M[5]})`}:isNaN(Number(i.i))||i.i===null||i.i===void 0?{width:`7 * ${M[6]})`,height:`7 * ${M[6]})`}:{width:`calc(var(--i) * ${M[6]})`,height:`calc(var(--i) * ${M[6]})`},onMouseDown:m=>{var f,V;m.stopPropagation();const y=m.currentTarget.parentElement;y.draggable=!0,u.current&&(u.current.textContent=`${Ue[w]}: ${(f=y==null?void 0:y.querySelector("span"))==null?void 0:f.textContent}`),C&&C.current&&((V=C.current)==null||V.setAttribute("aria-activedescendant",`${y.id}`)),p(m,y)},onMouseMove:m=>{var y;if(m.buttons===1){m.stopPropagation();const f=m.currentTarget.parentElement;f.draggable=!0,P(m,f),u.current&&(u.current.textContent=`${Ue[w]}: ${(y=f==null?void 0:f.querySelector("span"))==null?void 0:y.textContent}`)}},onMouseLeave:m=>{var f;m.stopPropagation();const y=m.currentTarget.parentElement;y.draggable=!1,C&&C.current&&((f=C.current)==null||f.removeAttribute("aria-activedescendant")),x(m,y),u.current&&(u.current.textContent=`${$e[w]}`)},onMouseUp:m=>{var f;const y=m.currentTarget.parentElement;y.draggable=!1,O(m,y),C&&C.current&&((f=C.current)==null||f.removeAttribute("aria-activedescendant")),u.current&&(u.current.textContent=`${$e[w]}`)},onTouchStart:m=>{var f,V;m.preventDefault(),m.stopPropagation();const y=m.currentTarget.parentElement;y.draggable=!0,C&&C.current&&((f=C.current)==null||f.setAttribute("aria-activedescendant",`${y.id}`)),p(m,y),u.current&&(u.current.textContent=`${Ue[w]}: ${(V=y==null?void 0:y.querySelector("span"))==null?void 0:V.textContent}`)},onTouchMove:m=>{m.preventDefault(),m.stopPropagation();const y=m.currentTarget.parentElement;y.draggable=!0,P(m,y)},onTouchEnd:m=>{var f;const y=m.currentTarget.parentElement;y.draggable=!1,C&&C.current&&((f=C.current)==null||f.removeAttribute("aria-activedescendant")),O(m,y),u.current&&(u.current.textContent=`${$e[w]}`)},onWheel:m=>{const y=m.currentTarget.parentElement;v(y)}}),r.jsxs("span",{className:"scr",children:[$o[w]," ",i.number]})]},$)},vs=e=>{var i;const t=e.d===0?0:1,w={WebkitFilter:`url(#svgfilter${t})`,filter:`url(#svgfilter${t})`,backgroundColor:"transparent",position:"absolute",top:0,left:0,height:"100%",width:"100%",pointerEvents:"none"};return r.jsxs(r.Fragment,{children:[r.jsxs("span",{id:`listbox${e.d}-layer${e.layer}-label`,className:"scr",children:[lt[e.language]," ",e.layer+1]}),r.jsx("ul",{ref:e.dragUlRef,role:"listbox",id:`listbox${e.d}-layer${e.layer}`,className:`drag-container-layer drag-container${e.d}-layer drag-container${e.d}-layer${e.layer} ${e.className}`,"aria-labelledby":`listbox${e.d}-layer${e.layer}-label`,"aria-activedescendant":"",style:w,children:(i=e.items)==null?void 0:i.map(($,p)=>{if($!=null)return r.jsx(ps,{layer:e.layer,d:e.d,language:e.language,item:$,index:p,start:e.start,movement:e.movement,stopMovementCheck:e.stopMovementCheck,stopMoving:e.stopMoving,wheel:e.wheel,focused:e.focused,blurred:e.blurred,selectedvalue0:e.selectedvalue0,setFocusedBlob:e.setFocusedBlob,dragUlRef:e.dragUlRef},p)})})]})};let We,S=!0,rt=0,ot=0,ve,Le=0,at=null,Je="90deg",D;const xe=e=>{e.preventDefault(),e.stopImmediatePropagation()},xs=e=>{const w=[...e.items].sort((n,c)=>n.layer-c.layer).reduce((n,c)=>(n[c.layer]||(n[c.layer]=[]),n[c.layer].push(c),n),{}),i=Array.from({length:e.layerAmount},(n,c)=>c),$=s.useRef({});s.useEffect(()=>{const n=i.reduce((c,h)=>(c[h]=s.createRef(),c),{});$.current=n},[e.layerAmount]);const p=()=>{try{return document.createEvent("TouchEvent"),!0}catch{return!1}};s.useEffect(()=>{p()},[]);const P=n=>{let c=n.layer;c<e.layerAmount-1&&(c+=1,e.changeBlobLayer(n,c))},O=n=>{let c=n.layer;c>0&&(c-=1,e.changeBlobLayer(n,c))};function x(n,c){const h=n.getBoundingClientRect(),g=c.getBoundingClientRect();return!(h.top+5>g.bottom-5||h.right<g.left||h.bottom-5<g.top+5||h.left>g.right)}const v=s.useCallback(n=>{S=!0,document.removeEventListener("keydown",m),document.removeEventListener("touchmove",xe)},[m]);ko({ref:e.clickOutsideRef,onOutsideClick:v}),s.useEffect(()=>{p()&&!D&&e.scroll&&(document.body.style.overflowY="auto",document.body.style.overflowX="hidden",document.removeEventListener("keydown",m),document.removeEventListener("touchmove",xe))},[D,e.scroll,p,m]);const k=s.useCallback((n,c)=>{n.stopPropagation(),n.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),We=!0,D=c,rt=p()?n.touches[0].clientX:n.clientX,ot=p()?n.touches[0].clientY:n.clientY,c.classList.add("drag");const h=e.highestZIndex[e.layer];if(p()){let j=(c==null?void 0:c.style.getPropertyValue("--i"))??"7";ve=parseFloat(j),ve=isNaN(ve)?7:ve}e.dispatch({type:"partialUpdate",payload:{d:e.d,id:c.id,update:{z:`${Math.max(1,h+1)}`}}}),document.addEventListener("keydown",m);const g=c.style.getPropertyValue("--layer");e.setActiveLayer(isNaN(parseInt(g))?1:parseInt(g)),p()&&(document.addEventListener("touchmove",xe,{passive:!1}),document.body.style.overflow="hidden")},[m,p]),re=s.useCallback(n=>{if(n.stopPropagation(),p()&&(n.preventDefault(),document.body.style.overflow="hidden"),We){let c=p()?n.touches[0].clientX:n.clientX,h=p()?n.touches[0].clientY:n.clientY;D.style.top=D.offsetTop-(ot-h)+"px",D.style.left=D.offsetLeft-(rt-c)+"px",rt=c,ot=h,e.dispatch({type:"partialUpdate",payload:{d:e.d,id:D==null?void 0:D.id,update:{x:D.style.left,y:D.style.top}}})}},[p]),u=s.useCallback((n,c)=>{n.stopPropagation(),n.preventDefault(),We=!1,Le++,at&&clearTimeout(at),at=setTimeout(()=>{if(Le===2){let B=ve-.8;B=Math.max(7,B),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:D==null?void 0:D.id,update:{i:B}}})}else if(Le===3){let B=ve+.8;B=Math.min(36,B),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:D==null?void 0:D.id,update:{i:B}}})}Le=0},300),document.removeEventListener("keydown",m);let h=c.style.getPropertyValue("--i")??"7",g=parseFloat(h);g=isNaN(g)?7:g;const j=c.querySelector("div"),Z={layer:parseInt(c.style.getPropertyValue("--layer")),id:c.id,number:parseInt(c.id.replace("blob","").split("-")[0],10),i:g,x:c.style.left,y:c.style.top,z:c.style.zIndex,background:c.style.background||"linear-gradient(90deg, cyan, greenyellow)"};p()&&e.scroll?(document.removeEventListener("touchmove",xe),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):p()&&!e.scroll&&(document.body.style.overflow="hidden"),e.layerIncrease.current&&x(j,e.layerIncrease.current)&&P(Z),e.layerDecrease.current&&x(j,e.layerDecrease.current)&&O(Z),e.colorPairs[e.d].forEach((B,Y)=>{const H=e.colorBlockProps[e.d][Y];if(H.current&&x(j,H.current)){const{color1:J,color2:Q}=B;c.style.background=`linear-gradient(${Je}, ${J},${Q})`}}),e.makeLarger0.current&&x(j,e.makeLarger0.current)&&(g+=.4,g=Math.min(Math.max(7,g),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:c.id,update:{i:g}}})),e.makeSmaller0.current&&x(j,e.makeSmaller0.current)&&(g-=.4,g=Math.min(Math.max(7,g),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:c.id,update:{i:g}}})),e.makeMore0.current&&x(j,e.makeMore0.current)&&f(Z),e.deleteBlob0.current&&x(j,e.deleteBlob0.current)&&A(Z),c.classList.remove("drag"),c.blur(),Le===0?D=null:D=c,e.setFocusedBlob(null)},[Je,x,m,f,e.colorBlockProps,e.colorPairs,A,e.scroll]),ee=s.useCallback((n,c)=>{n.stopPropagation(),We=!1,D=null,p()&&e.scroll?(document.removeEventListener("touchmove",xe),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):p()&&!e.scroll&&(document.body.style.overflow="hidden"),e.getPosition(c),c.classList.remove("drag"),document.removeEventListener("keydown",m),c.blur()},[m]);s.useEffect(()=>{p()&&!D&&e.scroll&&(document.removeEventListener("touchmove",xe),document.body.style.overflowY="auto",document.body.style.overflowX="hidden")},[u,ee,D,e.scroll]);function C(n){n.classList.remove("drag"),document.removeEventListener("keydown",m),e.getPosition(n),n.draggable=!1,D=null}function te(n){D=n,n.classList.add("drag");const c=n.style.getPropertyValue("--layer");e.setActiveLayer(parseInt(c)??2),document.addEventListener("keydown",m),n.draggable=!0}function oe(n){const c=h=>M(h,n);return n.addEventListener("wheel",c,{passive:!1}),()=>{n.removeEventListener("wheel",c)}}function M(n,c){if(S){S=!1;let g=window.getComputedStyle(c).getPropertyValue("--i")??c.style.getPropertyValue("--i")??"7",j=parseFloat(g);j=isNaN(j)?7:j,n.deltaY<0?j*=1.04:j*=.96,j=Math.min(Math.max(7,j),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:c.id,update:{i:j}}}),setTimeout(()=>{S=!0},100)}}s.useEffect(()=>{const n=D;if(n){const{color1:c,color2:h}=e.colorPairs[e.d][e.colorIndex],g=`linear-gradient(${Je}, ${c}, ${h})`;e.dispatch({type:"partialUpdate",payload:{d:e.d,id:n.id,update:{background:g}}})}},[e.colorIndex]);function m(n){var F,le;const h=D;if(!h)return;const g=window.getComputedStyle(h),j=T=>{var me;const U=parseFloat(g.marginTop),ce=parseFloat(g.marginLeft),q=T.getBoundingClientRect(),fe=(me=T.parentNode)==null?void 0:me.getBoundingClientRect();e.setFocusedBlob({top:q.top-fe.top-U,left:q.left-fe.left-ce,width:q.width,height:q.height})};let Z=g.getPropertyValue("--i")??h.style.getPropertyValue("--i")??"7",B=parseFloat(Z);B=isNaN(B)?7:B;let Y=parseFloat(g.getPropertyValue("left"))??parseFloat(h.style.getPropertyValue("left"))??0,H=parseFloat(g.getPropertyValue("top"))??parseFloat(h.style.getPropertyValue("top"))??0;const J=h.style.getPropertyValue("--layer"),Q={layer:parseInt(J)??e.layer,id:h.id,number:parseInt(h.id.replace("blob","").split("-")[0],10),i:B,x:h.style.getPropertyValue("left").toString(),y:h.style.getPropertyValue("top").toString(),z:h.style.zIndex??"0",background:h.style.background??"linear-gradient(90deg, cyan, greenyellow)"},ue=(T,U)=>{e.dispatch({type:"partialUpdate",payload:{d:e.d,id:h.id,update:{x:`${T}px`,y:`${U}px`}}}),j(h)},R=()=>{S=!0},Ee=T=>{n.preventDefault(),S&&(S=!1,e.changeBlobLayer(Q,T),setTimeout(R,100))},G=n.key;switch(parseInt(G)>=1&&parseInt(G)<=e.layerAmount&&Ee(parseInt(G)-1),n.key){case"ArrowLeft":n.preventDefault(),S&&(ue(Y-4,H),setTimeout(R,100));break;case"ArrowRight":n.preventDefault(),S&&(ue(Y+4,H),setTimeout(R,100));break;case"ArrowUp":n.preventDefault(),S&&(ue(Y,H-4),setTimeout(R,100));break;case"ArrowDown":n.preventDefault(),S&&(ue(Y,H+4),setTimeout(R,100));break;case"Escape":n.preventDefault(),e.setScroll(!0),document.body.style.overflowY="auto",document.body.style.overflowX="hidden",e.exitApp.current&&(e.exitApp.current.setAttribute("tabindex","0"),e.exitApp.current.addEventListener("blur",y)),h.blur(),(F=e.dragWrap.current)==null||F.blur(),e.exitApp.current&&(e.exitApp.current.textContent=wo[e.language]),(le=e.exitApp.current)==null||le.focus();break;case"Enter":n.preventDefault(),n.stopPropagation(),S&&(S=!1,h.closest(`#drag-wrap${e.d}`)&&e.setColorIndex(T=>(T+1)%e.colorPairs[e.d].length),setTimeout(R,100));break;case"R":case"r":case" ":if(n.preventDefault(),n.stopPropagation(),S){if(S=!1,h.closest(`#drag-wrap${e.d}`)){const T=e.colorswitch();let U=e.colorswitch();U===T&&(U=e.colorswitch());const ce=`linear-gradient(${Je}, ${T}, ${U})`;e.dispatch({type:"partialUpdate",payload:{d:e.d,id:h.id,update:{background:ce}}})}setTimeout(R,100)}break;case"Z":case"z":n.preventDefault(),S&&(S=!1,e.dispatch({type:"partialUpdate",payload:{d:e.d,id:h.id,update:{z:"0"}}}),setTimeout(R,100));break;case"T":case"t":n.preventDefault(),S&&(S=!1,e.dispatch({type:"partialUpdate",payload:{d:e.d,id:h.id,update:{z:`${Math.max(1,e.highestZIndex[e.layer]+1)}`}}}),setTimeout(R,100));break;case"S":case"s":n.preventDefault(),S&&(S=!1,B-=.4,B=Math.min(Math.max(7,B),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:h.id,update:{i:B}}}),setTimeout(R,100));break;case"B":case"b":case"L":case"l":n.preventDefault(),S&&(S=!1,B+=.4,B=Math.min(Math.max(7,B),36),e.dispatch({type:"partialUpdate",payload:{d:e.d,id:h.id,update:{i:B}}}),setTimeout(R,100));break;case"C":case"c":case"D":case"d":n.preventDefault(),S&&(S=!1,f(Q),setTimeout(R,100));break;case"+":n.preventDefault(),S&&(S=!1,e.addRandomDraggable(Q.x,Q.y,Q.layer),setTimeout(R,200));break;case"Delete":case"-":n.preventDefault(),S&&(S=!1,A(Q),setTimeout(R,100));break}}function y(){var n,c;e.exitApp.current&&((n=e.exitApp.current)==null||n.removeAttribute("tabindex"),(c=e.exitApp.current)==null||c.removeEventListener("blur",y),e.exitApp.current.textContent="")}function f(n){e.dispatch({type:"duplicateDraggable",payload:{d:e.d,draggable:n}})}const[V,ne]=s.useState("");function A(n){ne(n.id),e.selectedvalue0.current&&(e.selectedvalue0.current.textContent=`${$e[e.language]}`)}return s.useEffect(()=>{V&&(e.dispatch({type:"removeDraggable",payload:{d:e.d,id:V}}),ne(""))},[V,e.d,e.dispatch]),r.jsx(r.Fragment,{children:i.map(n=>r.jsx(vs,{layer:n,dragUlRef:$.current[n],items:w[n]||[],className:e.hiddenLayers.has(n)?"hidden":"",language:e.language,d:e.d,saveDraggables:e.saveDraggables,selectedvalue0:e.selectedvalue0,setFocusedBlob:e.setFocusedBlob,start:k,movement:re,stopMovementCheck:u,stopMoving:ee,wheel:oe,focused:te,blurred:C},n))})},gs="http://localhost:4000",we=`${gs}/api/blobs`,$s=async(e,t,w)=>(await ke.get(`${we}/${e}/${t}`,{params:{language:w}})).data,ks=async(e,t,w,i)=>(await ke.get(`${we}/${e}/${t}/${w}/${i}`)).data,ws=async(e,t,w,i,$,p)=>(await ke.post(`${we}/${e}/${t}/${i}/${p}`,{draggables:w,backgroundColor:$})).data,Es=async(e,t,w,i,$,p,P)=>(await ke.put(`${we}/${e}/${t}/${i}/${p}`,{d:t,versionName:i,draggables:w,backgroundColor:$,newVersionName:P})).data,js=async(e,t,w,i)=>(await ke.delete(`${we}/${e}/${t}/${w}/${i}`)).data,Bs=async(e,t,w)=>(await ke.post(`${we}/screenshot`,{url:e,selector:t,language:w})).data,De={getAllBlobsByUser:$s,getBlobsVersionByUser:ks,saveBlobsByUser:ws,editBlobsByUser:Es,deleteBlobsVersionByUser:js,takeScreenshot:Bs},Ns=({d:e,language:t,controlsVisible:w,colorBlockProps:i,colorPairs:$,getRefName:p,map:P})=>r.jsx(r.Fragment,{children:i[e].map((O,x)=>{var v;return r.jsx("div",{ref:O,className:`colorblock ${(v=p(P[e],O))==null?void 0:v.toLowerCase()} tooltip-wrap ${w?"":"hidden"}`,id:`color${x}-${e}`,style:{background:`linear-gradient(45deg, ${$[e][x].color1}, ${$[e][x].color2})`,borderRadius:`${x<4?"5rem 6.7rem 6.7rem 5rem / 0.7rem 8.7rem 8.7rem 0.7rem":"6.7rem 5rem 5rem 6.7rem / 8.7rem 0.7rem 0.7rem 8.7rem"}`},children:r.jsx("span",{className:`tooltip below ${x<4?"right":"left"}`,children:Eo[t]})},`${$[e][x].color1}${x}-${e}`)})}),Ss=({d:e,language:t,sliderLightnessInput:w,setSliderLightVal:i,sliderLightness:$,sliderLightVal:p,defaultLightness:P,sliderLightnessReset:O,sliderSaturationInput:x,setSliderSatVal:v,sliderSaturation:k,sliderSatVal:re,defaultSaturation:u,sliderSaturationReset:ee,sliderHueInput:C,setSliderHueVal:te,sliderHue:oe,sliderHueVal:M,defaultHue:m,sliderHueReset:y})=>r.jsx(r.Fragment,{children:r.jsxs("div",{id:`drag-slider-wrap${e}`,className:"drag-slider-wrap",children:[r.jsxs("div",{className:"drag-slider-single",children:[r.jsx("label",{htmlFor:`drag-slider-hue${e}`,id:`huedescription${e}`,children:jo[t]}),r.jsx("input",{ref:C,onChange:f=>{te(f.target.value),oe()},onMouseUp:f=>{te(f.target.value),oe()},onPointerUp:f=>{te(f.target.value),oe()},type:"range",min:0,max:359,value:M,className:"drag-slider drag-slider-hue",id:`drag-slider-hue${e}`}),r.jsx("span",{children:M}),r.jsx("button",{onClick:()=>{te(m),y()},children:Bo[t]})]}),r.jsxs("div",{className:"drag-slider-single",children:[r.jsx("label",{htmlFor:`drag-slider-saturation${e}`,id:`saturationdescription${e}`,children:No[t]}),r.jsx("input",{ref:x,onChange:f=>{v(f.target.value),k()},onMouseUp:f=>{v(f.target.value),k()},onPointerUp:f=>{v(f.target.value),k()},type:"range",min:0,max:100,value:re,className:"drag-slider drag-slider-saturation",id:`drag-slider-saturation${e}`}),r.jsx("span",{children:re}),r.jsx("button",{onClick:()=>{v(u),ee()},children:So[t]})]}),r.jsxs("div",{className:"drag-slider-single",children:[r.jsx("label",{htmlFor:`drag-slider-lightness${e}`,id:`lightnessdescription${e}`,children:Co[t]}),r.jsx("input",{ref:w,onChange:f=>{i(f.target.value),$()},onMouseUp:f=>{i(f.target.value),$()},onPointerUp:f=>{i(f.target.value),$()},type:"range",min:0,max:100,value:p,className:"drag-slider drag-slider-lightness",id:`drag-slider-lightness${e}`}),r.jsx("span",{children:p}),r.jsx("button",{onClick:()=>{i(P),O()},children:Lo[t]})]})]})}),Cs=[{color1:"darkorange",color2:"orange"},{color1:"orangered",color2:"palevioletred"},{color1:"magenta",color2:"violet"},{color1:"blue",color2:"cyan"},{color1:"greenyellow",color2:"lemonchiffon"},{color1:"cyan",color2:"greenyellow"},{color1:"cyan",color2:"pink"},{color1:"lemonchiffon",color2:"pink"}],Ls=[{color1:"indianred",color2:"palevioletred"},{color1:"sienna",color2:"peru"},{color1:"chocolate",color2:"burlywood"},{color1:"darkkhaki",color2:"moccasin"},{color1:"slateblue",color2:"mediumpurple"},{color1:"royalblue",color2:"turquoise"},{color1:"cadetblue",color2:"mediumaquamarine"},{color1:"lightslategray",color2:"lightsteelblue"}],Ds=[{color1:"indigo",color2:"mediumorchid"},{color1:"darkmagenta",color2:"palevioletred"},{color1:"crimson",color2:"indianred"},{color1:"chocolate",color2:"orangered"},{color1:"darkcyan",color2:"olivedrab"},{color1:"midnightblue",color2:"darkturquoise"},{color1:"mediumblue",color2:"cadetblue"},{color1:"darkblue",color2:"mediumslateblue"}],st=[Cs,Ls,Ds];let vr="90deg";const nt=3,ge=e=>{e.preventDefault()};function Ps({language:e,d:t,ds:w,dragWrapOuter:i}){var Qt,Kt,er;const $="214",p=t===0?"80":t===2?"50":"45",P=t===0?"30":t===2?"5":"25",{state:O,dispatch:x}=s.useContext(Do),v=Po(),k=pr(o=>{var a;return(a=o.auth)==null?void 0:a.user}),re=pr(o=>o.users),u=s.useRef(),ee=s.useRef(),C=s.useRef(),te=s.useRef(),oe=s.useRef(),M=s.useRef(),m=s.useRef(),y=s.useRef(),[f,V]=s.useState(!1),ne=s.useRef(),A=s.useRef(),n=s.useRef(),c=s.useRef(),h=s.useRef(),g=s.useRef(),j=s.useRef(),Z=s.useRef(),B=s.useRef(null),Y=s.useRef(),H=s.useRef(),J=s.useRef(),Q=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",ue=`${Q?"local-":""}BlobLayerAmount${[t]}`,R=`${Q?"local-":""}BackgroundColor${[t]}`,Ee=`${Q?"local-":""}Draggables${[t]}`,G=O.backgroundColor,F=O.draggables,{windowHeight:le,windowWidth:T}=To(),[U,ce]=s.useState(0),[q,fe]=s.useState(new Set),[me,xr]=s.useState({}),[gr,$r]=s.useState(0),[W,ct]=s.useState(null),[_e,it]=s.useState(!1),[je,kr]=s.useState(!0),[_,wr]=s.useState(!0),[ae,Pe]=s.useState(!0),[dt,Xe]=s.useState(!1),[ut,Ge]=s.useState(!1),[mt,ht]=s.useState(!1),ft=s.useRef(),bt=s.useRef(),yt=s.useRef(),pt=s.useRef(),vt=s.useRef(),xt=s.useRef(),gt=s.useRef(),$t=s.useRef(),kt=s.useRef(),wt=s.useRef(),Et=s.useRef(),jt=s.useRef(),Bt=s.useRef(),Nt=s.useRef(),St=s.useRef(),Ct=s.useRef(),Lt=s.useRef(),Dt=s.useRef(),Pt=s.useRef(),Tt=s.useRef(),Mt=s.useRef(),At=s.useRef(),Rt=s.useRef(),It=s.useRef(),Er=[new Map([[ft,"colorBlockOrange"],[bt,"colorBlockRed"],[yt,"colorBlockPurple"],[pt,"colorBlockBlue"],[vt,"colorBlockYellowLime"],[xt,"colorBlockCyanYellow"],[gt,"colorBlockCyanPink"],[$t,"colorBlockPinkYellow"]]),new Map([[kt,"colorBlockReddish"],[wt,"colorBlockBrown"],[St,"colorBlockTan"],[Et,"colorBlockKhaki"],[Bt,"colorBlockPurplish"],[jt,"colorBlockBluish"],[Nt,"colorBlockGreenish"],[Ct,"colorBlockGray"]]),new Map([[Lt,"colorBlockDarkPurple"],[Dt,"colorBlockDarkPink"],[Pt,"colorBlockDarkRed"],[Tt,"colorBlockDarkOrange"],[Mt,"colorBlockDarkGreen"],[At,"colorBlockGreenishBlue"],[Rt,"colorBlockDarkBlue"],[It,"colorBlockPurplishBlue"]])],jr=(o,a)=>o.get(a),qe=[[ft,bt,yt,pt,vt,xt,gt,$t],[kt,wt,St,Et,Bt,jt,Nt,Ct],[Lt,Dt,Pt,Tt,Mt,At,Rt,It]],Br=(o,a)=>{const l=me[a]+1;x({type:"partialUpdate",payload:{d:t,id:o.id,update:{layer:a,z:l}}}),ce(a)},Nr=o=>{fe(a=>{const l=new Set(a);return l.has(o)?l.delete(o):l.add(o),l})};s.useEffect(()=>{const o=()=>it(!0),a=()=>{it(!1)},l=()=>{ct(null)};return window.addEventListener("keyup",o),window.addEventListener("mousedown",a),window.addEventListener("mouseup",l),()=>{window.removeEventListener("keyup",o),window.removeEventListener("mousedown",a),window.removeEventListener("mouseup",l)}},[]);function Sr(){return new Promise(o=>{setTimeout(()=>{const a=localStorage.getItem(Ee);if(a==null||a==null||a==="undefined")o(null);else{const l=JSON.parse(a);o(l.map(d=>({...d,layer:d.layer??0})))}},300)})}function Cr(){return new Promise(o=>{setTimeout(()=>{var l;const a=localStorage.getItem(ue);a!=null?o(parseInt(a)):((l=F[t])==null?void 0:l.length)>0?o(Math.max(...F[t].map(d=>d.layer))+1):o(nt)},100)})}function Lr(){return new Promise(o=>{setTimeout(()=>{const a=localStorage.getItem(R);a==null||a==null||a==="undefined"?o(null):o(JSON.parse(a))},300)})}function Te(o=he){localStorage.setItem(ue,JSON.stringify(o))}function se(o=G[t]){localStorage.setItem(R,JSON.stringify(o))}function Ft(o=F[t]){localStorage.setItem(Ee,JSON.stringify(o))}const[be,Ot]=s.useState(tr[e]),[Me,Vt]=s.useState(be),[Dr,Pr]=s.useState(""),[Tr,Ht]=s.useState(!0),[Ut,Mr]=s.useState(!1),[Ae,Ze]=s.useState(!1),[Re,Ar]=s.useState({}),[he,ye]=s.useState(0),Rr=async()=>{Ht(!0);try{k!=null&&k._id&&De.getAllBlobsByUser(k==null?void 0:k._id,t,e).then(o=>{if(o){const a={};o.forEach(l=>{const{d,versionName:b}=l;a[d]||(a[d]={}),a[d][b]=l}),Ar(a),Mr(Object.keys(a).length>0)}}).catch(o=>{v(E(`${K[e]}: ${o.message}`,!0,8))})}catch{v(E(K[e],!0,8))}finally{Ht(!1)}},Ir=o=>{for(const a in Re)if(Re[a][o])return!0;return!1},zt=/^[\w\s\u00C0-\u024F\u1E00-\u1EFF-_]*$/,Fr=o=>{const a=o.target.value;zt.test(a)?Ot(a):v(E(ir[e],!0,8))},Or=o=>{const a=o.target.value;zt.test(a)?Vt(a):v(E(ir[e],!0,8))},Vr=async o=>{o.preventDefault();try{if(be.trim()===""){v(E(Ye[e],!0,8));return}else if(be.trim().length>30){v(E(`${dr[e]}. ${ur[e]}`,!0,8));return}else if(k!=null&&k._id){const a=be.trim();if(Ir(a)&&!window.confirm(Da[e]))return;De.saveBlobsByUser(k==null?void 0:k._id,t,F[t],be,G[t],e).then(()=>{Ze(!Ae),v(E(mr[e],!1,8))}).catch(l=>{v(E(`${K[e]}: ${l.message}`,!0,8))})}else v(E(hr[e],!0,8))}catch{v(E(K[e],!0,8))}},Hr=async(o,a)=>{const l=a.trim();if(a.trim()===""){v(E(Ye[e],!0,8));return}else if(a.trim().length>30){v(E(`${dr[e]}. ${ur[e]}`,!0,8));return}else try{k!=null&&k._id?De.editBlobsByUser(k==null?void 0:k._id,t,F[t],o,G[t],e,l).then(()=>{Ze(!Ae),v(E(mr[e],!1,8))}).catch(d=>{v(E(`${K[e]}: ${d.message}`,!0,8))}):v(E(hr[e],!0,8))}catch{v(E(K[e],!0,8))}},Ur=(o,a)=>{const l=a.trim();k!=null&&k._id&&window.confirm(Pa[e])&&De.getBlobsVersionByUser(k==null?void 0:k._id,o,l,e).then(d=>{const b=Math.max(...d.draggables.map(L=>L.layer));ye(b+1),setTimeout(()=>{Te(b+1)},300),x({type:"setDraggablesAtD",payload:{d:o,draggables:d.draggables}}),x({type:"setBackgroundColor",payload:{d:o,backgroundColor:d.backgroundColor}}),se(d.backgroundColor),Be(d.backgroundColor[0]),Ne(d.backgroundColor[1]),Se(d.backgroundColor[2]),Ke({[`--hue${o}`]:`${d.backgroundColor[0]}`}),et({[`--saturation${o}`]:`${d.backgroundColor[1]}`}),tt({[`--lightness${o}`]:`${d.backgroundColor[2]}`})}).then(()=>{Ot(l),ho(),setTimeout(()=>{pe()},300)}).catch(d=>{v(E(`${K[e]}: ${d.message}`,!0,8))})},zr=(o,a)=>{k._id&&window.confirm(Ta[e])&&De.deleteBlobsVersionByUser(k._id,o,a,e).then(()=>{v(E(Ma[e],!1,8)),Ze(!Ae)}).catch(l=>{v(E(`${K[e]}: ${l.message}`,!0,8))})};s.useEffect(()=>{(async()=>{await v(Aa()),await v(Ra())})()},[v]),s.useEffect(()=>{k&&Rr()},[k,Ae]);function Yr(o){return o.reduce((a,l)=>{const d=parseInt(l.z,10),b=l.layer;return(!a[b]||d>a[b])&&(a[b]=d),a},{})}s.useEffect(()=>{(async()=>{const a=await Sr(),l=await Lr(),d=setTimeout(async()=>{var L,z,I;const b=await Cr();l&&l.length===3?(x({type:"setBackgroundColor",payload:{d:t,backgroundColor:l}}),se(l),Be(l[0]),Ne(l[1]),Se(l[2]),(L=i.current)==null||L.style.setProperty(`--hue${t}`,`${l[0]}`),(z=i.current)==null||z.style.setProperty(`--saturation${t}`,`${l[1]}`),(I=i.current)==null||I.style.setProperty(`--lightness${t}`,`${l[2]}`)):(x({type:"setBackgroundColor",payload:{d:t,backgroundColor:[$,p,P]}}),se([$,p,P])),b?ye(b):a&&a.length>0&&ye(Math.max(...a.map(N=>N.layer))+1),a&&a.length>0?(a&&a.length>0&&Wr(a),Xe(!0)):a==null&&!dt&&(_t(Yt,t),Xe(!0))},300);return()=>clearTimeout(d)})()},[]),s.useEffect(()=>{var o;if(F[t]!==void 0&&((o=F[t])==null?void 0:o.length)>0){Ft();const a=Yr(F[t]);xr(a)}},[F[t]]);function Wr(o){if(!dt&&o&&(o==null?void 0:o.length)>0){for(let a=0;a<(o==null?void 0:o.length);a++)if(o[a]!==null&&o[a]!==void 0){const l={layer:o[a].layer,id:`${o[a].id}`,number:o[a].number,i:o[a].i,x:`${o[a].x}`,y:`${o[a].y}`,z:`${o[a].z}`,background:`${o[a].background??"linear-gradient(90deg, cyan, greenyellow)"}`};x({type:"addDraggable",payload:{d:t,draggable:l}})}}Xe(!0)}const Jr=()=>{x({type:"moveDraggablesLeft",payload:{d:t}})},_r=()=>{x({type:"moveDraggablesRight",payload:{d:t}})},Xr=()=>{x({type:"moveDraggablesUp",payload:{d:t}})},Gr=()=>{x({type:"moveDraggablesDown",payload:{d:t}})};function qr(o){var l;o.preventDefault();const a=(l=i.current)==null?void 0:l.querySelectorAll(".dragzone");a&&!ut?(a.forEach(d=>{d.classList.remove("animation"),d.offsetWidth}),Ge(!0)):a&&(a.forEach(d=>{d.classList.add("animation"),d.offsetWidth}),Ge(!1))}s.useEffect(()=>{mt&&u.current&&(u.current.classList.add("paused"),Ge(!0))},[mt]),s.useEffect(()=>{const o=window.matchMedia("(prefers-reduced-motion: reduce)");ht(o.matches);const a=()=>ht(o.matches);return o.addEventListener("change",a),()=>{o.removeEventListener("change",a)}},[]);const Yt=T>700?10:6,Wt=o=>{switch(o.key){case"Escape":Pe(!0),document.body.style.overflowY="auto",document.body.style.overflowX="hidden";break}};s.useEffect(()=>(window.addEventListener("keyup",Wt),()=>{window.removeEventListener("keyup",Wt)}),[]);const Jt=o=>{const a=F[t].some(b=>b.layer===0&&o<0),l=F[t].some(b=>b.layer===he-1&&o>0);if(a){v(E(Ia[e],!0,8));return}if(l){v(E(Fa[e],!0,8));return}const d=F[t].map(b=>{const L=b.layer+o;return L>=0&&L<he?{...b,layer:L}:b});x({type:"setDraggablesAtD",payload:{d:t,draggables:d}})};function Zr(o){o.preventDefault(),window.confirm(`${Oa[e]}?`)&&(window.localStorage.removeItem(Ee),x({type:"resetDraggables",payload:{d:t}}),x({type:"setDraggablesAtD",payload:{d:t,draggables:[]}}),_t(Yt,t),setTimeout(()=>{pe(),Te(nt)},300))}const _t=(o,a)=>{ce(0);for(let l=0;l<o;l++){const d=()=>{const I=st[a],N=Math.floor(Math.random()*I.length);return[I[N].color1,I[N].color2]},[b,L]=d(),z={layer:0,id:`blob${l+1}-${a}`,number:l+1,i:T>400?ie(7,20):ie(7,10),x:T>le?`${T/100*ie(2,70)}px`:`${T/100*ie(2,50)}px`,y:`${le/100*ie(2,60)}px`,z:"1",background:`linear-gradient(${vr}, ${b??"cyan"},${L??"greenyellow"})`};x({type:"addDraggable",payload:{d:a,draggable:z}})}ye(nt)};function ie(o,a){return Math.random()*(a-o)+o}const Qe=()=>{const o=["cyan","lemonchiffon","pink","orangered","magenta","deepskyblue","darkorange","tomato","violet","dodgerblue","greenyellow","orange","silver","darkgray","gray","hotpink","wheat","sandybrown","rosybrown","dimgray","darkkhaki","darkseagreen","slateblue","royalblue","moccasin","burlywood","chocolate","cadetblue","mediumpurple","sienna","peru","indianred","palevioletred","plum","palegreen","mediumaquamarine","lightsteelblue","aquamarine","yellowgreen"],a=Math.floor(Math.random()*o.length);return o[a]};s.useEffect(()=>{},[O.draggables]);const Xt=(o=`${T/100*ie(25,55)}px`,a=`${le/100*ie(2,10)}px`,l=U)=>{if(document.activeElement instanceof HTMLElement&&document.activeElement.id===`make-random${t}`&&document.activeElement.blur(),q.has(U)){v(E(Va[e],!0,8));return}const d=Qe(),b=Qe(),L=Math.max(...O.draggables[t].map(N=>parseInt(N.id.split("-")[0].replace("blob",""),10))),z=isNaN(me[l])?1:me[l]+1,I={layer:l,id:`blob${L+1}-${t}`,number:L+1,i:Math.ceil(ie(6.5,10)),x:o,y:a,z:`${z}`,background:`linear-gradient(${vr}, ${d??"cyan"},${b??"greenyellow"})`};x({type:"duplicateDraggable",payload:{d:t,draggable:I}})},Qr=o=>{const a=o.id,l=window.getComputedStyle(o),d=parseInt(o.id.replace("blob","").split("-")[0],10),b=l.getPropertyValue("--i")??o.style.getPropertyValue("--i")??"7",L=l.getPropertyValue("left")??o.style.getPropertyValue("left"),z=l.getPropertyValue("top")??o.style.getPropertyValue("top"),I=l.getPropertyValue("z-index")??o.style.getPropertyValue("z-index"),N=l.getPropertyValue("background")??o.style.getPropertyValue("background"),de=l.getPropertyValue("--layer")??o.style.getPropertyValue("--layer"),He={layer:de?parseInt(de):U,id:a,number:d,i:isNaN(parseFloat(b))?7:parseFloat(b),x:L,y:z,z:I,background:N??"linear-gradient(90deg, cyan, greenyellow)"};x({type:"updateDraggable",payload:{d:t,draggable:He}})};s.useEffect(()=>{var o,a;return ae?ae&&(document.body.style.overflowY="auto",document.body.style.overflowX="hidden",document.removeEventListener("touchmove",ge),i.current&&(i.current.style.overflow="auto"),(a=i.current)==null||a.removeEventListener("touchmove",ge)):(document.addEventListener("touchmove",ge,{passive:!1}),document.body.style.overflow="hidden",(o=i.current)==null||o.addEventListener("touchmove",ge,{passive:!1}),i.current&&(i.current.style.overflow="hidden")),()=>{var l;document.removeEventListener("touchmove",ge),(l=i.current)==null||l.removeEventListener("touchmove",ge)}},[ae]);function Kr(){Pe(!ae)}const[Ie,Be]=s.useState(()=>{const o=localStorage.getItem(R),a=o?JSON.parse(o):null;return(a==null?void 0:a[0])??$}),[Fe,Ne]=s.useState(()=>{const o=localStorage.getItem(R),a=o?JSON.parse(o):null;return(a==null?void 0:a[1])??p}),[Oe,Se]=s.useState(()=>{const o=localStorage.getItem(R),a=o?JSON.parse(o):null;return(a==null?void 0:a[2])??P}),eo={backgroundColor:`hsl(var(--hue${t}), calc(var(--saturation${t}) * 1%), calc(var(--lightness${t}) * 1%))`},[to,Ke]=s.useState(J.current?{[`--hue${t}`]:`${J.current.value}`}:{[`--hue${t}`]:`${Ie}`}),[ro,et]=s.useState(H.current?{[`--saturation${t}`]:`${H.current.value}`}:{[`--saturation${t}`]:`${Fe}`}),[oo,tt]=s.useState(Y.current?{[`--lightness${t}`]:`${Y.current.value}`}:{[`--lightness${t}`]:`${Oe}`});function ao(){if(i.current){Ke({[`--hue${t}`]:`${Ie}`});const o=JSON.parse(JSON.stringify(G));o[t][0]=Ie,x({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}}),se(o[t])}}function so(){if(i.current){et({[`--saturation${t}`]:`${Fe}`});const o=JSON.parse(JSON.stringify(G));o[t][1]=Fe,x({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}}),se(o[t])}}function no(){if(i.current){tt({[`--lightness${t}`]:`${Oe}`});const o=JSON.parse(JSON.stringify(G));o[t][2]=Oe,x({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}}),se(o[t])}}s.useEffect(()=>{Y.current&&Se(Y.current.value)},[(Qt=Y==null?void 0:Y.current)==null?void 0:Qt.value]),s.useEffect(()=>{H.current&&Ne(H.current.value)},[(Kt=H==null?void 0:H.current)==null?void 0:Kt.value]),s.useEffect(()=>{J.current&&Be(J.current.value)},[(er=J==null?void 0:J.current)==null?void 0:er.value]);function lo(){tt({[`--lightness${t}`]:`${P}`}),Y.current&&(Y.current.value=P),Se(P);const o=JSON.parse(JSON.stringify(G));o[t][2]=P,se(o[t]),x({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}})}function co(){et({[`--saturation${t}`]:`${p}`}),H.current&&(H.current.value=p),Ne(p);const o=JSON.parse(JSON.stringify(G));o[t][1]=p,se(o[t]),x({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}})}function io(){Ke({[`--hue${t}`]:`${$}`}),J.current&&(J.current.value=$),Be($);const o=JSON.parse(JSON.stringify(G));o[t][0]=$,se(o[t]),x({type:"setBackgroundColor",payload:{d:t,backgroundColor:o[t]}})}s.useEffect(()=>{pe()},[T,le,ae]);const pe=()=>{const l=[12,34,56,78];c.current&&u.current&&T<250?X(c.current,15,0):c.current&&u.current&&X(c.current,23,0),Z.current&&u.current&&X(Z.current,50-Z.current.offsetWidth/u.current.offsetWidth*50,0),n.current&&u.current&&T<250?X(n.current,85-n.current.offsetWidth/u.current.offsetWidth*100,.3):n.current&&u.current&&X(n.current,77-n.current.offsetWidth/u.current.offsetWidth*100,.3),j.current&&u.current&&T<300?X(j.current,27,100-j.current.offsetHeight/u.current.offsetHeight*100):j.current&&u.current&&X(j.current,32,100-j.current.offsetHeight/u.current.offsetHeight*100),g.current&&u.current&&T<300?X(g.current,73-g.current.offsetWidth/u.current.offsetWidth*100,100-g.current.offsetHeight/u.current.offsetHeight*100):g.current&&u.current&&X(g.current,68-g.current.offsetWidth/u.current.offsetWidth*100,100-g.current.offsetHeight/u.current.offsetHeight*100),h.current&&u.current&&T<300?X(h.current,2,100-h.current.offsetHeight/u.current.offsetHeight*100):h.current&&u.current&&X(h.current,10,100-h.current.offsetHeight/u.current.offsetHeight*100),A.current&&u.current&&T<300?X(A.current,98-A.current.offsetWidth/u.current.offsetWidth*100,100-A.current.offsetHeight/u.current.offsetHeight*100):A.current&&u.current&&X(A.current,90-A.current.offsetWidth/u.current.offsetWidth*100,100-A.current.offsetHeight/u.current.offsetHeight*100),qe.forEach(d=>{d.forEach((b,L)=>{if(b.current&&ee.current){const z=L<4?0:100-b.current.offsetWidth/ee.current.offsetWidth*100,I=l[L%4];X(b.current,z,I)}})})};function X(o,a,l){o&&u.current&&(o.style.left=u.current.offsetWidth/100*a+"px",o.style.top=u.current.offsetHeight/100*l+"px")}s.useEffect(()=>{W&&je&&_e&&W&&B.current&&(B.current.style.top=`${W.top+W.width*-.05}px`,B.current.style.left=`${W.left+W.width*-.05}px`,B.current.style.width=`${W.width*1.1}px`,B.current.style.height=`${W.height*1.1}px`)},[W,je,_e]);const Gt=bs(),uo=()=>{Gt("/portfolio/blob?register=register")},mo=()=>{Gt("/portfolio/blob?login=login")},ho=()=>{const o=document.getElementById(`button-container${t}`);o&&o.scrollIntoView({behavior:"smooth",block:"start"})},fo={width:"100%",height:"auto",margin:"0 auto"},bo=async()=>{if(document.getElementById("drag-wrap"+t)&&!f)try{let a={};for(let N=0;N<localStorage.length;N++){const de=localStorage.key(N);if(de){const He=localStorage.getItem(de);He!==null&&(a[de]=He)}}V(!0);const b=await fetch("http://localhost:4000/api/blobs/screenshot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:window.location.href,selector:`#drag-wrap${t}`,language:e,localStorageData:a,width:T,height:le})});if(!b.ok)throw v(E(K[e],!0,8)),V(!1),new Error(`Error: ${b.statusText}`);const L=await b.json(),z=m.current,I=y.current;z&&I&&(I.src=`data:image/png;base64,${L.screenshot}`,z.style.display="block",I.scrollIntoView({behavior:"smooth",block:"start"}),v(E(`${Ha[e]}; ${Ua[e]}`,!1,10)),V(!1),Pe(!0))}catch(a){v(E(K[e],!0,8)),console.error(K[e],a)}},qt=()=>{const o=y.current;if(o&&o.src){const a=document.createElement("a");a.href=o.src,a.download="blobs.png",document.body.appendChild(a),a.click(),document.body.removeChild(a),v(E(za[e],!1,8))}else v(E(fr[e],!0,8)),console.error(fr[e])};s.useEffect(()=>{f&&v(E(`${rr[e]}...`,!1,20))},[f]);const[Ce,yo]=s.useState(5),[po,vo]=s.useState({[t]:1}),Ve=(o,a)=>{vo(l=>({...l,[o]:a}))},xo=()=>{if(q.size===0){v(E("Please hide the layers you want to delete.",!0,8));return}if(Array.from(q).filter(b=>F[t].some(L=>L.layer===b)).length>0&&!window.confirm(`${Ya[e]}. ${Wa[e]}`))return;const a=F[t].filter(b=>!q.has(b.layer)),l=he-q.size;if(l<1){v(E(Ja[e],!0,8));return}const d=a.map(b=>{const L=b.layer;let z=L;return q.forEach(I=>{L>I&&(z-=1)}),{...b,layer:z}});x({type:"setDraggablesAtD",payload:{d:t,draggables:d}}),ye(l),Te(l),fe(new Set),setTimeout(()=>{pe()},300)},go=o=>{const a=he+o;if(a>9){v(E(_a[e],!0,8));return}const l=F[t].map(d=>{const b=d.layer>U?d.layer+o:d.layer;return{...d,layer:b}});x({type:"setDraggablesAtD",payload:{d:t,draggables:l}}),ye(a),Te(a),fe(new Set),setTimeout(()=>{pe()},300)},Zt=(o,a,l)=>{const d=Math.random().toString(36).substr(2,9);return Ut?r.jsxs("div",{className:"pagination-controls",children:[a!==1?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>Ve(Number(o),1),disabled:a===1,className:"btn-small pagination-btn",children:["« ",r.jsx("span",{className:"scr",children:Xa[e]})]}),r.jsxs("button",{onClick:()=>Ve(Number(o),Math.max(a-1,1)),disabled:a===1,className:"btn-small pagination-btn",children:[" ‹ ",r.jsx("span",{className:"scr",children:Ga[e]})]})]}):r.jsx(r.Fragment,{}),r.jsxs("span",{children:[qa[e]," ",a," / ",l]}),a!==l?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>Ve(Number(o),Math.min(a+1,l)),disabled:a===l,className:"btn-small pagination-btn",children:[r.jsx("span",{className:"scr",children:Za[e]})," › "]}),r.jsxs("button",{onClick:()=>Ve(Number(o),l),disabled:a===l,className:"btn-small pagination-btn",children:[r.jsx("span",{className:"scr",children:Qa[e]})," »"]})]}):r.jsx(r.Fragment,{}),r.jsx("div",{className:"input-wrap items-per-page",children:r.jsxs("label",{htmlFor:`items-per-page${t}-${d}`,children:[r.jsx("input",{id:`items-per-page${t}-${d}`,className:"",type:"number",value:Ce,placeholder:Ce.toString(),min:1,max:100,onChange:b=>yo(Number(b.target.value))}),r.jsx("span",{children:Ka[e]})]})})]}):r.jsx(r.Fragment,{})};return r.jsx(r.Fragment,{children:r.jsx("section",{className:"card",children:r.jsx("div",{children:r.jsxs("div",{id:`drag-container${t}`,className:`drag-container drag-container${t}`,children:[r.jsxs("div",{className:"blob-title-wrap",children:[r.jsxs("h2",{className:"blob-title",children:[tr[e]," ",t+1]}),t===0?r.jsxs("p",{children:[ze[e]," "]}):t===1?r.jsxs("p",{children:[Mo[e],"."," ",ze[e]," "]}):t===2?r.jsxs("p",{children:[Ao[e],"."," ",ze[e]," "]}):r.jsx("p",{children:ze[e]})]}),r.jsxs("div",{className:"label-container",children:[r.jsx("span",{id:`blobdescription${t}`,className:"scr",children:Ro[e]}),r.jsxs("span",{children:["[",lt[e],": ",U+1,"]"," "]}),r.jsx("span",{ref:C,id:`selectedvalue${t}`,className:"selectedvalue",children:$e[e]})]}),r.jsxs("div",{id:`button-container${t}`,className:"button-container",children:[r.jsxs("button",{ref:te,id:`stop-blobs${t}`,className:"stop-blobs tooltip-wrap ",onClick:o=>{qr(o)},"aria-labelledby":`stop-blobs${t}-span`,children:[r.jsx("span",{id:`stop-blobs${t}-span`,className:"tooltip above space",children:Io[e]}),ut?Fo[e]:Oo[e]]}),r.jsxs("button",{ref:M,id:`reset-blobs${t}`,"aria-labelledby":`reset-blobs${t}-span`,className:"reset-blobs tooltip-wrap",onClick:o=>{Zr(o)},children:[r.jsx("span",{id:`reset-blobs${t}-span`,className:"tooltip above space",children:Vo[e]})," ",Ho[e]]}),r.jsxs("button",{id:`toggle-marker${t}`,"aria-labelledby":`toggle-marker${t}-span`,className:"toggle-marker tooltip-wrap",onClick:()=>kr(!je),children:[r.jsx("span",{id:`toggle-marker${t}-span`,className:"tooltip above space",children:`${Uo[e]}`}),je?zo[e]:Yo[e]]}),r.jsxs("button",{ref:oe,id:`disable-scroll${t}`,"aria-labelledby":`disable-scroll${t}-span`,className:`disable-scroll tooltip-wrap ${ae?"":"active"}`,onClick:()=>{Kr()},children:[r.jsx("span",{id:`disable-scroll${t}-span`,className:"tooltip above space",children:ae?Wo[e]:Jo[e]}),ae?_o[e]:Xo[e]]}),r.jsx("button",{id:`toggle-controls${t}`,"aria-labelledby":`toggle-controls${t}-span`,className:`toggle-controls ${_?"":"active"}`,onClick:()=>{wr(!_),_||setTimeout(()=>{pe()},200)},children:r.jsxs("span",{id:`toggle-controls${t}-span`,children:[" ",_?Go[e]:qo[e]]})}),r.jsxs("button",{id:`take-screenshot${t}`,"aria-labelledby":`take-screenshot${t}-span`,disabled:f,onClick:bo,className:"reset screenshot tooltip-wrap",children:[r.jsx(rs,{}),r.jsx("span",{id:`take-screenshot${t}-span`,className:"tooltip left below space",children:f?rr[e]:Zo[e]})]})]}),r.jsxs("div",{ref:ee,className:`drag-wrap-outest drag-wrap-outest${t}`,children:[r.jsxs("div",{ref:i,id:`drag-wrap-outer${t}`,className:"drag-wrap-outer",style:{...oo,...ro,...to,...eo},children:[r.jsxs("div",{tabIndex:0,ref:n,className:`make-smaller tooltip-wrap reset ${_?"":"hidden"}`,id:`make-smaller${t}`,children:[r.jsx(os,{}),r.jsx("span",{id:`make-smaller${t}-span`,className:"tooltip left below",children:`${Qo[e]}. ${or[e]}: ${ar[e]}`})]}),r.jsxs("div",{ref:A,className:`make-larger tooltip-wrap reset ${_?"":"hidden"}`,id:`make-larger${t}`,children:[r.jsx(as,{}),r.jsx("span",{id:`make-larger${t}-span`,className:"tooltip left above",children:`${Ko[e]}. ${or[e]}: ${ar[e]}`})]}),r.jsxs("div",{ref:c,className:`make-more tooltip-wrap reset ${_?"":"hidden"}`,id:`make-more${t}`,children:[r.jsx(ss,{}),r.jsx("span",{id:`make-more${t}-span`,className:"tooltip right below",children:ea[e]})]}),r.jsxs("button",{ref:Z,className:`make-random tooltip-wrap ${_?"":"hidden"}`,id:`make-random${t}`,"aria-labelledby":`make-random${t}-span`,onClick:()=>Xt(),children:[r.jsx(ns,{}),r.jsx("span",{id:`make-random${t}-span`,className:"tooltip below",children:`${ta[e]}. ${ra[e]}!`})]}),r.jsxs("div",{ref:h,className:`delete-blob tooltip-wrap reset ${_?"":"hidden"}`,id:`delete-blob${t}`,children:[r.jsx(ls,{}),r.jsx("span",{id:`delete-blob${t}-span`,className:"tooltip right above",children:oa[e]})]}),r.jsxs("div",{ref:j,id:`layer-decrease${t}`,className:`layer-adjust layer-decrease tooltip-wrap ${_?"":"hidden"}`,children:[r.jsx("span",{id:`layer-decrease${t}-span`,className:"tooltip above",children:`${aa[e]} ${sr[e]}`}),r.jsx(br,{})]}),r.jsxs("div",{ref:g,id:`layer-increase${t}`,className:`layer-adjust layer-increase tooltip-wrap ${_?"":"hidden"}`,children:[r.jsx("span",{id:`layer-increase${t}-span`,className:"tooltip above",children:`${sa[e]} ${sr[e]}`}),r.jsx(yr,{})]}),je&&_e&&W&&r.jsx("div",{ref:B,style:{position:"absolute",top:`${W.top+W.width*-.05}px`,left:`${W.left+W.width*-.05}px`,width:`${W.width*1.1}px`,height:`${W.height*1.1}px`,outline:"3px dashed black",outlineOffset:"2px",border:"3px dashed white",borderRadius:"50%",zIndex:999}}),r.jsx("div",{ref:u,id:`drag-wrap${t}`,className:"drag-wrap",children:r.jsx(xs,{layerAmount:he,layer:U,hiddenLayers:q,changeBlobLayer:Br,setActiveLayer:ce,highestZIndex:me,language:e,dispatch:x,d:t,items:F[t]??[],saveDraggables:Ft,getPosition:Qr,colorBlockProps:qe,makeLarger0:A,makeSmaller0:n,makeMore0:c,deleteBlob0:h,layerIncrease:g,layerDecrease:j,dragWrap:u,exitApp:ne,selectedvalue0:C,setFocusedBlob:ct,colorIndex:gr,setColorIndex:$r,colorPairs:st,colorswitch:Qe,scroll:ae,setScroll:Pe,clickOutsideRef:u,addRandomDraggable:Xt})})]}),r.jsx(Ns,{d:t,language:e,getRefName:jr,map:Er,colorBlockProps:qe,colorPairs:st,controlsVisible:_})]}),r.jsxs("div",{className:"layer-mover-control-wrap",children:[r.jsxs("div",{className:`movers-wrap movers-wrap1 ${_?"":"hidden"}`,children:[r.jsxs("button",{id:`moveleft${t}`,"aria-labelledby":`moveleft${t}-span`,className:"moveleft mover tooltip-wrap narrow2",onClick:_r,children:[r.jsx(cs,{}),r.jsx("span",{id:`moveleft${t}-span`,className:"tooltip above",children:na[e]})]}),r.jsxs("button",{id:`moveright${t}`,"aria-labelledby":`moveright${t}-span`,className:"moveright mover tooltip-wrap narrow2",onClick:Jr,children:[r.jsx(is,{}),r.jsx("span",{id:`moveright${t}-span`,className:"tooltip above",children:la[e]})]})]}),r.jsxs("div",{className:"layer-btn-wrap layer-tools layer-tools1",children:[r.jsxs("button",{id:`decrease-layer-amount${t}`,"aria-labelledby":`decrease-layer-amount${t}-span`,className:"layer-tool layer-amount decrease-layer-amount tooltip-wrap narrow2",onClick:xo,children:[r.jsx("span",{id:`decrease-layer-amount${t}-span`,className:"tooltip above",children:ca[e]}),r.jsx(ds,{})]}),r.jsxs("button",{id:`every-layer-minus${t}`,"aria-labelledby":`every-layer-minus${t}-span`,className:"layer-tool every-layer tooltip-wrap narrow2",onClick:()=>Jt(-1),children:[r.jsx("span",{id:`every-layer-minus${t}-span`,className:"tooltip above",children:ia[e]}),r.jsx(br,{})]})]}),r.jsx("div",{className:"layer-btn-wrap layers",children:Array.from({length:he},(o,a)=>a).map((o,a)=>r.jsx("button",{id:`layer-button${o}`,"aria-labelledby":`layer-button${o}-span`,onClick:()=>{U===o?Nr(o):ce(o)},className:`layer-button tooltip-wrap narrow2 ${U===o?"active":""} ${q.has(o)?"dim":""}`,children:r.jsxs("span",{id:`layer-button${o}-span`,children:[r.jsx("span",{className:"scr",children:lt[e]})," ",o+1," ",r.jsx("span",{className:"tooltip above",children:U===o?da[e]:ua[e]})]})},`${o}*${a}`))}),r.jsxs("div",{className:"layer-btn-wrap layer-tools layer-tools2",children:[r.jsxs("button",{id:`every-layer-plus${t}`,"aria-labelledby":`every-layer-plus${t}-span`,className:"layer-tool every-layer tooltip-wrap narrow2",onClick:()=>Jt(1),children:[r.jsx("span",{id:`every-layer-plus${t}-span`,className:"tooltip above",children:ma[e]}),r.jsx(yr,{})]}),r.jsxs("button",{id:`increase-layer-amount${t}`,"aria-labelledby":`increase-layer-amount${t}-span`,className:"layer-tool layer-amount increase-layer-amount tooltip-wrap narrow2",onClick:()=>go(1),children:[r.jsx("span",{id:`increase-layer-amount${t}-span`,className:"tooltip above",children:ha[e]}),r.jsx(us,{})]})]}),r.jsxs("div",{className:`movers-wrap movers-wrap2 ${_?"":"hidden"}`,children:[r.jsxs("button",{id:`moveup${t}`,"aria-labelledby":`moveup${t}-span`,className:"moveup mover tooltip-wrap narrow2",onClick:Gr,children:[r.jsx(ms,{}),r.jsx("span",{id:`moveup${t}-span`,className:"tooltip above",children:fa[e]})]}),r.jsxs("button",{id:`movedown${t}`,"aria-labelledby":`movedown${t}-span`,className:"movedown mover tooltip-wrap narrow2",onClick:Xr,children:[r.jsx(hs,{}),r.jsx("span",{id:`movedown${t}-span`,className:"tooltip above",children:ba[e]})]})]})]}),r.jsx(Ss,{d:t,defaultHue:$,defaultSaturation:p,defaultLightness:P,setSliderHueVal:Be,setSliderSatVal:Ne,setSliderLightVal:Se,language:e,sliderLightness:no,sliderSaturation:so,sliderHue:ao,sliderLightnessReset:lo,sliderSaturationReset:co,sliderHueReset:io,sliderLightVal:Oe,sliderSatVal:Fe,sliderHueVal:Ie,sliderLightnessInput:Y,sliderSaturationInput:H,sliderHueInput:J}),r.jsx("div",{ref:ne,id:`exitblob${t}`,className:"exitblob"}),k?r.jsxs("div",{className:"blob-handling",children:[r.jsx("div",{className:"full wide flex column center gap",children:r.jsxs("form",{onSubmit:o=>Vr(o),children:[r.jsx("div",{className:"input-wrap",children:r.jsxs("label",{htmlFor:`blobname${t}`,children:[r.jsx("input",{id:`blobname${t}`,type:"text",value:be,onChange:Fr,placeholder:Ye[e],maxLength:30}),r.jsxs("span",{children:[Ye[e],":"]})]})}),r.jsx("button",{type:"submit",children:ya[e]})]})}),r.jsxs("div",{ref:m,id:`blob-screenshot${t}`,style:{display:"none"},children:[r.jsx("button",{onClick:qt,children:nr[e]}),r.jsx("img",{src:"",ref:y,alt:pa[e],style:fo}),r.jsx("button",{onClick:qt,children:nr[e]})]}),r.jsx("h3",{children:va[e]}),Tr?r.jsx("p",{children:xa[e]}):!re||re.length<1?r.jsx("p",{children:ga[e]}):Ut?Object.keys(Re).map((o,a)=>{const l=Object.keys(Re[Number(o)]),d=Math.ceil(l.length/Ce),b=po[Number(o)]??1,L=(b-1)*Ce,z=L+Ce,I=l.slice(L,z);return r.jsxs("div",{className:"flex center margin0auto",children:[Zt(o,b,d),r.jsx("ul",{className:"blob-versions-wrap",children:I.map((N,de)=>r.jsxs("li",{className:"blob-version-item",children:[r.jsx("span",{children:N}),r.jsxs("div",{className:"button-wrap",children:[r.jsxs("button",{onClick:()=>Ur(Number(o),N),children:[ka[e]," ",r.jsx("span",{className:"scr",children:N})]}),r.jsxs("button",{onClick:()=>zr(Number(o),N),children:[wa[e]," ",r.jsx("span",{className:"scr",children:N})]}),r.jsxs(Ea,{language:e,id:`accordion-blobnewname-${N.replace(/\s/g,"-")}`,className:"blobnewname",text:lr[e],hideBrackets:!0,onClick:()=>{Vt(N),Pr(N)},isOpen:Dr===N,children:[r.jsx("div",{className:"input-wrap",children:r.jsxs("label",{htmlFor:`blobnewname-${N.replace(/\s/g,"-")}`,children:[r.jsx("input",{id:`blobnewname-${N.replace(/\s/g,"-")}`,type:"text",value:Me,onChange:Or,placeholder:cr[e],maxLength:30}),r.jsxs("span",{children:[lr[e],":"]})," ",r.jsx("span",{className:"scr",children:N})]})}),r.jsxs("button",{onClick:()=>{N!==Me?Hr(N,Me):v(E(`${K[e]}: ${cr[e]}`,!0,5))},children:[ja[e]," ",r.jsxs("span",{className:"scr",children:[N,": ",Ba[e]," ",Me]})]})]})]})]},`${N}+${de}`))},`${o}+${a}`),Zt(o,b,d)]},`${o}:${a}`)}):r.jsx("p",{children:$a[e]})]}):r.jsxs("div",{className:"wide flex column center gap",children:[r.jsxs("div",{className:"login-to-save wide flex column center gap-half",children:[r.jsx(fs,{}),Na[e]]}),r.jsxs("div",{className:"blob-register-login-wrap",children:[r.jsx("button",{onClick:mo,children:Sa[e]}),r.jsx("big",{children:Ca[e]}),r.jsx("button",{onClick:uo,children:La[e]})]})]}),r.jsx("svg",{className:"filter",children:r.jsxs("filter",{id:"svgfilter0",children:[r.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"7"}),r.jsx("feColorMatrix",{values:`\r
1 0 0 0 0\r
0 1 0 0 0\r
0 0 1 0 0\r
0 0 0 50 -18\r
`})]})}),r.jsx("svg",{className:"filter",children:r.jsxs("filter",{id:"svgfilter1",children:[r.jsx("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"8"}),r.jsx("feColorMatrix",{values:`\r
1 0 0 0 0\r
0 1 0 0 0\r
0 0 1 0 0\r
0 0 0 46 -28\r
`})]})})]})})})})}const an=({language:e})=>{const t=Array.from({length:3},($,p)=>p),w=s.useRef(t.reduce(($,p)=>($[p]=s.createRef(),$),{})),i=$=>r.jsx("div",{className:"to-blob-art-btn-wrap flex center gap-half",children:t.map((p,P)=>$===P?r.jsx(s.Fragment,{},P):r.jsxs("button",{style:{borderRadius:"1rem",flex:"0 0 auto"},className:"to-blob-art-btn grayer",onClick:()=>{const O=document.getElementById(`drag-container${P}`);O&&O.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},children:[es[e]," ",ts[e]," ",P+1]},P))});return r.jsxs(r.Fragment,{children:[t.map(($,p)=>r.jsxs(s.Fragment,{children:[i(p),r.jsx(Ps,{language:e,d:$,ds:t.length,dragWrapOuter:w.current[$]})]},$)),i(-1)]})};export{an as default};
