import{r as E,j as e}from"./react-kX_YxI4E.js";import{u as $,gD as f,k3 as q,be as M,o as b,c1 as j,k4 as g,k5 as C,jN as I,k6 as N,h3 as v}from"./index-CpJin9vf.js";import{u as P,g as L}from"./Images-CpGbZgPv.js";import{Q as U,P as D,g as R}from"./poems-C-eYRtpW.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-D7bD3W54.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const Q=({image:t,language:o,handleDownload:x,searchTerm:c,textType:l})=>{const h=$(),{tooltip:u,handleMouseMove:d,handleMouseLeave:r}=P(),p=a=>{const s=a.currentTarget.getBoundingClientRect(),i=a.clientX-s.left+10,y=a.clientY-s.top+10;d(i,y)},[w,m]=E.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[k,n]=E.useState({title:"",author:"",lines:[],linecount:"0"});return E.useEffect(()=>{if(l==="poem"){const a=Math.floor(Math.random()*5)+1;(async()=>{const i=await R(o,a);n(i[0])})()}else l==="quote"?(async()=>{if(o=M.Suomi){const s=await L(M.English,c);s.quote?m(s.quote):h(b(s.message??j[o],!0,8))}else{const s=await L(o,c);s.quote?m(s.quote):h(b(s.message??j[o],!0,8))}})():Math.floor(Math.random()*2)+1===1?(async()=>{const i=Math.floor(Math.random()*5)+1,y=await R(o,i);n(y[0])})():(async()=>{const i=await L(o,c);i.quote?m(i.quote):h(b(i.message??j[o],!0,8))})()},[o,c,l]),e.jsxs("div",{onMouseMove:p,onMouseLeave:r,children:[e.jsxs("div",{className:`tooltip-wrap ${f["image-wrap"]} ${f["image-modal"]}`,children:[e.jsxs("button",{onClick:x,className:"reset",children:[e.jsx("img",{src:t.largeImageURL,alt:t.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),u.visible&&e.jsx("span",{className:"tooltip narrow",style:{top:u.y,left:u.x,right:"unset"},children:q[o]})]}),l==="quote"?e.jsx(U,{quote:w,language:o}):e.jsx(D,{poem:k,language:o})]})},ro=({image:t,language:o,show:x,searchTerm:c,textType:l})=>{const h=$(),u=async()=>{if(window.confirm(N[o]+"?")){const r=await fetch(t.largeImageURL,{mode:"cors"});if(!r.ok)throw new Error("Network response was not ok");try{const p=await r.blob(),w=window.URL.createObjectURL(p),m=t.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),k=m?m[1].toLowerCase():"jpg",n=document.createElement("a");n.href=w,n.download=`${v(`${t.id}`)}-${v(t.user)}.${k}`,n.target="_blank",n.rel="noreferrer",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(w)}catch(p){console.error("Download failed:",p),h(b(`${j[o]}: ${p}`,!0,5))}}},d=()=>{x({title:t.tags,className:f["image-modal"],children:e.jsx(Q,{image:t,language:o,handleDownload:u,searchTerm:c,textType:l})})};return e.jsxs("div",{className:`tooltip-wrap ${f["image-wrap"]}`,children:[e.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":g[o],onClick:d,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),d())},children:e.jsx("img",{src:t.webformatURL,alt:t.tags,title:t.tags,loading:"lazy",className:`${f["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:d,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&d()}})}),e.jsx("span",{className:"tooltip above narrow2",children:g[o]}),e.jsx("p",{children:e.jsx("small",{children:e.jsxs("a",{href:t.pageURL,target:"_blank",rel:"noreferrer",children:[C[o]," (",I[o],": ",t.user,")"]})})})]},t.id)};export{ro as default};
