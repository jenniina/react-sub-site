import{a as u,j as o}from"./react-B26j9x-B.js";import{L,u as N,E as k,e as y,q as O,O as b}from"./index-ba3uvdEn.js";import{u as R,g as C}from"./Images-BXchnzmk.js";import{Q as v,P,g as V}from"./poems-CVfnhOzJ.js";import"./dom-to-image-more-sr33WCep.js";import"./react-dom-C5TvV5XQ.js";import"./scheduler-C323NY8X.js";import"./react-redux-EG6qnwNo.js";import"./hoist-non-react-statics-C-Qo8PK8.js";import"./react-is-BwqtTtay.js";import"./use-sync-external-store-BqPSEvA7.js";import"./@reduxjs-D09xkNSb.js";import"./immer-C0GRqQ_d.js";import"./redux-D9aXM7rm.js";import"./@babel-CYk816RD.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-ngrFHoWO.js";import"./react-icons-W-DbsVi9.js";import"./react-router-dom-Dghs3TPc.js";import"./react-router-vPOY4muN.js";import"./@remix-run-ox1qIyJK.js";import"./react-helmet-async-CnDSc5Ri.js";import"./react-fast-compare-BHbKlhN4.js";import"./invariant-B_pwkeTo.js";import"./shallowequal-C7ef0Lra.js";const $=({video:e,language:n,searchTerm:l,textType:i,handleDownload:p})=>{const{t:s}=u.useContext(L),d=N(),{tooltip:c,handleMouseMove:h,handleMouseLeave:a}=R(),[w,g]=u.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[f,x]=u.useState({title:"",author:"",lines:[],linecount:"0"}),r=async t=>{const m=await V(n,t);x(m[0])},j=async()=>{if(n=k.fi){const t=await C(k.en,l);t.quote?g(t.quote):d(y(t.message??s("Error"),!0,8))}else{const t=await C(n,l);t.quote?g(t.quote):d(y(t.message??s("Error"),!0,8))}};u.useEffect(()=>{const t=Math.floor(Math.random()*5)+2;i==="poem"?r(t):i==="quote"?j():Math.floor(Math.random()*2)+1===1?r(t):j()},[n,l,i]);const M=t=>{const m=t.currentTarget.getBoundingClientRect(),E=t.clientX-m.left+10,q=t.clientY-m.top+10;h(E,q)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"tooltip-wrap",onMouseMove:M,onMouseLeave:a,children:[o.jsx("video",{src:Number(e.videos.large.size)>0?e.videos.large.url:e.videos.medium.url,title:e.tags,style:{width:"100%",height:"auto",maxHeight:"100%",borderRadius:"8px",cursor:"pointer"},onClick:p,tabIndex:0,onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&p()},controls:!0}),c.visible&&o.jsx("span",{className:"tooltip center narrow",style:{top:c.y,left:c.x,right:"unset"},children:s("ClickToLoadVideo")})]}),i==="quote"?o.jsx(v,{quote:w,language:n,url:e.pageURL,title:o.jsxs(o.Fragment,{children:[s("VideoPage")," (",s("Author"),": ",e.user,")"]})}):o.jsx(P,{poem:f,language:n})]})},ae=({video:e,language:n,show:l,searchTerm:i,textType:p})=>{const{t:s}=u.useContext(L),d=O(),c=async()=>{if(await d({message:`${s("Download")+"?"}`})){const a=await fetch(e.videos.large.url,{mode:"cors"});if(!a.ok)throw new Error("Network response was not ok");const w=await a.blob(),g=window.URL.createObjectURL(w),f=e.videos.large.url?e.videos.large.url.match(/\.(mp4)$/i):e.videos.medium.url.match(/\.(mp4)$/i),x=f?f[1].toLowerCase():"mp4",r=document.createElement("a");r.href=g,r.download=`video_${e.id}.${x}`,r.target="_blank",r.rel="noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},h=()=>{l({title:e.tags,className:b["video-modal"],children:o.jsx($,{video:e,language:n,searchTerm:i,textType:p,handleDownload:c})})};return o.jsxs("div",{className:`tooltip-wrap ${b["video-wrap"]}`,children:[o.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":s("ClickToOpenLargeVideo"),onClick:h,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),h())},children:o.jsx("img",{src:e.videos.small.thumbnail,alt:e.tags,className:`${b["video-small"]}`,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"}})}),o.jsx("span",{className:"tooltip above narrow2",children:s("ClickToOpenLargeVideo")}),o.jsx("p",{children:o.jsx("small",{children:o.jsxs("a",{href:e.pageURL,target:"_blank",rel:"noreferrer",children:[s("VideoPage")," (",s("Author"),": ",e.user,")"]})})})]},e.id)};export{ae as default};
