import{r as d,j as t}from"./react-kX_YxI4E.js";import{L as M,u as R,E as k,e as y,N as x}from"./index-t27NYhnJ.js";import{u as q,g as L}from"./Images-naR0YJKx.js";import{Q as v,P as O,g as P}from"./poems-CFGCLvVb.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-CzVo0GbG.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const V=({video:e,language:n,searchTerm:c,textType:i,handleDownload:p})=>{const{t:s}=d.useContext(M),h=R(),{tooltip:l,handleMouseMove:a,handleMouseLeave:g}=q(),[f,m]=d.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[w,r]=d.useState({title:"",author:"",lines:[],linecount:"0"}),b=async o=>{const u=await P(n,o);r(u[0])},j=async()=>{if(n=k.fi){const o=await L(k.en,c);o.quote?m(o.quote):h(y(o.message??s("Error"),!0,8))}else{const o=await L(n,c);o.quote?m(o.quote):h(y(o.message??s("Error"),!0,8))}};d.useEffect(()=>{const o=Math.floor(Math.random()*5)+2;i==="poem"?b(o):i==="quote"?j():Math.floor(Math.random()*2)+1===1?b(o):j()},[n,c,i]);const C=o=>{const u=o.currentTarget.getBoundingClientRect(),E=o.clientX-u.left+10,N=o.clientY-u.top+10;a(E,N)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"tooltip-wrap",onMouseMove:C,onMouseLeave:g,children:[t.jsx("video",{src:Number(e.videos.large.size)>0?e.videos.large.url:e.videos.medium.url,title:e.tags,style:{width:"100%",height:"auto",maxHeight:"100%",borderRadius:"8px",cursor:"pointer"},onClick:p,tabIndex:0,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&p()},controls:!0}),l.visible&&t.jsx("span",{className:"tooltip center narrow",style:{top:l.y,left:l.x,right:"unset"},children:s("ClickToLoadVideo")})]}),i==="quote"?t.jsx(v,{quote:f,language:n,url:e.pageURL,title:t.jsxs(t.Fragment,{children:[s("VideoPage")," (",s("Author"),": ",e.user,")"]})}):t.jsx(O,{poem:w,language:n})]})},oe=({video:e,language:n,show:c,searchTerm:i,textType:p})=>{const{t:s}=d.useContext(M),h=async()=>{if(window.confirm(s("Download")+"?")){const a=await fetch(e.videos.large.url,{mode:"cors"});if(!a.ok)throw new Error("Network response was not ok");const g=await a.blob(),f=window.URL.createObjectURL(g),m=e.videos.large.url?e.videos.large.url.match(/\.(mp4)$/i):e.videos.medium.url.match(/\.(mp4)$/i),w=m?m[1].toLowerCase():"mp4",r=document.createElement("a");r.href=f,r.download=`video_${e.id}.${w}`,r.target="_blank",r.rel="noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},l=()=>{c({title:e.tags,className:x["video-modal"],children:t.jsx(V,{video:e,language:n,searchTerm:i,textType:p,handleDownload:h})})};return t.jsxs("div",{className:`tooltip-wrap ${x["video-wrap"]}`,children:[t.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":s("ClickToOpenLargeVideo"),onClick:l,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),l())},children:t.jsx("img",{src:e.videos.small.thumbnail,alt:e.tags,className:`${x["video-small"]}`,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"}})}),t.jsx("span",{className:"tooltip above narrow2",children:s("ClickToOpenLargeVideo")}),t.jsx("p",{children:t.jsx("small",{children:t.jsxs("a",{href:e.pageURL,target:"_blank",rel:"noreferrer",children:[s("VideoPage")," (",s("Author"),": ",e.user,")"]})})})]},e.id)};export{oe as default};
