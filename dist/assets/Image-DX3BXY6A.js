import{r as k,j as s}from"./react-kX_YxI4E.js";import{gB as h,k5 as L,k6 as x,u as v,k7 as y,k8 as R,jP as $,k9 as P,h5 as E,o as g,b$ as C}from"./index-BdZ3b4Wv.js";import{u as I}from"./Images-DMIUin_F.js";import{Q as U,P as Q,g as M}from"./poems-wI0zZG9c.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-DEg4IKXU.js";import"./react-router-dom-ZPAD5XPx.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const D=({image:t,language:o,handleDownload:w,searchTerm:d,textType:i})=>{const{tooltip:p,handleMouseMove:b,handleMouseLeave:c}=I(),r=e=>{const n=e.currentTarget.getBoundingClientRect(),a=e.clientX-n.left+10,j=e.clientY-n.top+10;b(a,j)},[l,m]=k.useState({quote:"",category:"",author:""}),[u,f]=k.useState({title:"",author:"",lines:[],linecount:"0"});return k.useEffect(()=>{if(i==="poem"){const e=Math.floor(Math.random()*5)+1;(async()=>{const a=await M(o,e);f(a[0])})()}else i==="quote"?(async()=>{const n=await x(o,d);m(n)})():Math.floor(Math.random()*2)+1===1?(async()=>{const a=Math.floor(Math.random()*5)+1,j=await M(o,a);f(j[0])})():(async()=>{const a=await x(o,d);m(a)})()},[o,d,i]),s.jsxs("div",{onMouseMove:r,onMouseLeave:c,children:[s.jsxs("div",{className:`tooltip-wrap ${h["image-wrap"]} ${h["image-modal"]}`,children:[s.jsxs("button",{onClick:w,children:[s.jsx("img",{src:t.largeImageURL,alt:t.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),p.visible&&s.jsx("span",{className:"tooltip narrow",style:{top:p.y,left:p.x,right:"unset"},children:L[o]})]}),i==="quote"?s.jsx(U,{quote:l,language:o}):s.jsx(Q,{poem:u,language:o})]})},eo=({image:t,language:o,show:w,searchTerm:d,textType:i})=>{const p=v(),b=async()=>{if(window.confirm(P[o]+"?")){const r=await fetch(t.largeImageURL,{mode:"cors"});if(!r.ok)throw new Error("Network response was not ok");try{const l=await r.blob(),m=window.URL.createObjectURL(l),u=t.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),f=u?u[1].toLowerCase():"jpg",e=document.createElement("a");e.href=m,e.download=`${E(`${t.id}`)}-${E(t.user)}.${f}`,e.target="_blank",e.rel="noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(m)}catch(l){console.error("Download failed:",l),p(g(`${C[o]}: ${l}`,!0,5))}}},c=()=>{w({title:t.tags,className:h["image-modal"],children:s.jsx(D,{image:t,language:o,handleDownload:b,searchTerm:d,textType:i})})};return s.jsxs("div",{className:`tooltip-wrap ${h["image-wrap"]}`,children:[s.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":y[o],onClick:c,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),c())},children:s.jsx("img",{src:t.webformatURL,alt:t.tags,title:t.tags,loading:"lazy",className:`${h["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:c,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&c()}})}),s.jsx("span",{className:"tooltip above narrow2",children:y[o]}),s.jsx("p",{children:s.jsx("small",{children:s.jsxs("a",{href:t.pageURL,target:"_blank",rel:"noreferrer",children:[R[o]," (",$[o],": ",t.user,")"]})})})]},t.id)};export{eo as default};
