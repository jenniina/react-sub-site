import{r as i,j as s}from"./react-kX_YxI4E.js";import{kj as ye,L as $e,kk as Q,bu as n,kl as ee,bZ as W,bB as se,h3 as f,km as A,bC as De,W as S,kn as je,bx as I,ko as ae,kp as re,kq as Se,by as Ee,bz as ve,bA as be,kr as Ce,ks as Te,fV as Me,kt as ne,ku as Fe,u as Ye,kv as Ae,kw as _e,kx as le,ky as ie,kz as ce,X as N,hq as te,hp as me,kA as he,hr as pe,kB as ue,fl as He,o as fe,bw as Ie}from"./index-DXi6uXCT.js";import{bd as Le,be as ze,bf as Be,bg as Pe,bh as Re,bi as qe,bj as We,bk as Ue,bl as Ke,bm as Ve,bn as Xe}from"./react-icons-D7bD3W54.js";import{R as Ze}from"./react-dom-B5MLDbn_.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";import"./scheduler-CzFDRTuY.js";const xe=Me(6),Ge=({todo:e,language:l,priorityOptions:E,categoryOptions:a,handleModify:U,sending:K,newCategory:g,newPriority:L,setNewPriority:V,setNewCategory:X,showDeadline:w,setShowDeadline:Z,title:z,newName:v,setNewName:d,newDay:x,setNewDay:_,newMonth:j,setNewMonth:C,newYear:k,setNewYear:y,setIsOpen:B,maxCharacters:$})=>{const[H,m]=i.useState(null),P=r=>{d(r.target.value)},G=r=>{Number(r)<=31&&r.length<=2?(_(r),m(null)):m(`${ne[l]}: ${ae[l]}`)},R=r=>{Number(r)<=12&&r.length<=2?(C(r),m(null)):m(`${ne[l]}: ${re[l]}`)},J=r=>{const h=r.target.value;Number(h)<=Number(new Date().getFullYear())+10&&h.length<=4?(y(h),m(null)):m(Fe[l])};i.useEffect(()=>{if(x&&j&&k){const r=new Date(Number(k),Number(j)-1,Number(x)),h=new Date;h.setHours(0,0,0,0),m(null),r<h&&m(ye[l])}},[x,j,k,l]),i.useEffect(()=>{w?(x||_((new Date().getDate()+1).toString().padStart(2,"0")),j||C((new Date().getMonth()+1).toString().padStart(2,"0")),k||y(new Date().getFullYear().toString())):(_(""),C(""),y(""))},[w]);const b=i.useRef(null),p=i.useRef(null);i.useEffect(()=>{var h;p.current=document.activeElement,(h=b.current)==null||h.focus();const r=t=>{var q,D;if(t.key==="Tab"){const u=(D=(q=b.current)==null?void 0:q.parentElement)==null?void 0:D.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!u||u.length===0){t.preventDefault();return}const M=u==null?void 0:u[0],F=u==null?void 0:u[u.length-1];t.shiftKey?document.activeElement===M&&(t.preventDefault(),F==null||F.focus()):document.activeElement===F&&(t.preventDefault(),M==null||M.focus())}else t.key==="Escape"&&T()};return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r),p.current?p.current.focus():document.body.focus()}},[b.current]);const T=()=>{B(!1),p.current?p.current.focus():document.body.focus()},O=$e();return Ze.createPortal(s.jsx("div",{className:`${Q["modal-overlay"]} ${O?n.light:""}`,onClick:T,children:s.jsxs("div",{className:`${Q["modal-content"]} ${n["todo-modal"]}`,onClick:r=>r.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":z??"Task",children:[s.jsxs("button",{ref:b,className:`${Q["close-button"]} tooltip-wrap`,onClick:T,children:[s.jsx("span",{"aria-hidden":"true",children:"×"}),s.jsx("span",{className:"scr",children:ee[l]}),s.jsx("span",{"aria-hidden":"true",className:"tooltip below left narrow2",children:ee[l]})]}),s.jsx("h2",{children:W[l]}),s.jsxs("form",{onSubmit:U,className:`${n.modify}`,children:[s.jsx(se,{id:`category_${f(A((e==null?void 0:e.name)??xe,l))}`,className:`${n.select} ${n["category-select"]}`,value:a==null?void 0:a.find(r=>r.value===g),onChange:r=>X(r==null?void 0:r.value),options:a,instructions:De[l],language:l,hideDelete:!0,z:3}),s.jsx(se,{id:`priority_${f(A((e==null?void 0:e.name)??xe,l))}`,className:`${n.select}`,value:E==null?void 0:E.find(r=>r.value===L),onChange:r=>V(r==null?void 0:r.value),options:E,instructions:S[l],language:l,hideDelete:!0,z:2}),s.jsxs("fieldset",{className:`${n.fieldset} ${n["deadline-wrap"]}`,children:[s.jsx("legend",{children:s.jsxs("label",{children:[je[l]," ",s.jsx("input",{style:{marginLeft:"0.5em"},type:"checkbox",checked:w,onChange:()=>Z(!w)})]})}),w&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:n["deadline-inputs"],children:[s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`day_${f(A((e==null?void 0:e.name)??I[l],l))}`,children:ae[l]}),s.jsx("input",{type:"number",id:`day_${f((e==null?void 0:e.name)||"Task")}`,name:"day",min:1,max:31,value:x,placeholder:"DD",onChange:r=>G(r.target.value),required:!0,className:"bg"})]}),s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`month_${f((e==null?void 0:e.name)||"Task")}`,children:re[l]}),s.jsx("input",{type:"number",id:`month_${f(A((e==null?void 0:e.name)??I[l],l))}`,name:"month",min:1,max:12,value:j,placeholder:"MM",onChange:r=>R(r.target.value),required:!0,className:"bg"})]}),s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`year_${f((e==null?void 0:e.name)||"Task")}`,children:Se[l]}),s.jsx("input",{type:"number",id:`year_${f(A((e==null?void 0:e.name)??I[l],l))}`,name:"year",min:new Date().getFullYear(),max:new Date().getFullYear()+10,value:k,placeholder:"YYYY",onChange:r=>J(r),required:!0,className:"bg"})]})]})," ",H&&s.jsx("p",{className:n.error,children:H})]})]}),s.jsxs("fieldset",{className:`${n.fieldset} ${n.textarea}`,children:[s.jsx("legend",{children:I[l]}),s.jsxs("label",{children:[s.jsx("textarea",{id:`task_${f(e==null?void 0:e.name)}`,required:!0,name:"task",rows:4,value:v,onChange:P}),s.jsxs("p",{className:n.small,children:[$-v.length," ",Ee[l]," (",ve[l],": ",$,")"," ",v.length>$&&s.jsx("span",{className:n.warning,children:be[l]})]}),s.jsxs("span",{className:"scr",children:[W[l]," ",A((e==null?void 0:e.name)??I[l],l)]})]})]}),s.jsxs("button",{type:"submit",disabled:K,className:"modify",children:[Ce[l]," ",s.jsx(Le,{})]}),s.jsxs("button",{onClick:T,className:`reset ${n.cancel}`,type:"button",children:[Te[l]," ",s.jsx(ze,{})]})]})]})}),document.getElementById("modal-root"))};function xs({todo:e,toggleTodo:l,deleteTodo:E,language:a,modifyTodo:U,isDragging:K,handleUpdate:g,handleDragging:L,sending:V,priorityOptions:X,categoryOptions:w,zin:Z,maxCharacters:z}){const v=Ye(),[d,x]=i.useState((e==null?void 0:e.name)??""),[_,j]=i.useState(!1),[C,k]=i.useState((e==null?void 0:e.priority)||"low"),[y,B]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getDate().toString().padStart(2,"0"):""),[$,H]=i.useState(e!=null&&e.deadline?(new Date(e.deadline).getMonth()+1).toString().padStart(2,"0"):""),[m,P]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getFullYear().toString():""),G=y&&$&&m?`${m}-${$}-${y}`:"",[R,J]=i.useState((e==null?void 0:e.category)||"other"),[b,p]=i.useState(!1);function T(){l(e==null?void 0:e.key)}function O(){window.confirm(He[a]+' "'+(e==null?void 0:e.name)+'"?')&&(x(""),E(e==null?void 0:e.key),p(!1))}const r=c=>{if(c.preventDefault(),d===""){v(fe(Ie[a],!0,5));return}if(d.length>z){v(fe(be[a],!0,5));return}U(e==null?void 0:e.key,d,C,G,R),p(!1)};i.useEffect(()=>{e!=null&&e.deadline&&j(!0)},[e]),i.useEffect(()=>{if((e==null?void 0:e.name)!==d&&x((e==null?void 0:e.name)||""),e!=null&&e.deadline){const c=new Date(e.deadline);B(c.getDate().toString().padStart(2,"0")),H((c.getMonth()+1).toString().padStart(2,"0")),P(c.getFullYear().toString())}},[e]);const[h,t]=i.useState(!0),[q,D]=i.useState(!1),u=()=>{t(!0),D(!1)},M=()=>{t(!0)},F=()=>{t(!1)},Ne=()=>{t(!1),D(!0)},we=()=>{var c;(c=window.getSelection())!=null&&c.toString()?(t(!1),D(!0)):(t(!0),D(!1))},de=c=>{q&&c.preventDefault()};return s.jsx(s.Fragment,{children:s.jsxs("li",{style:{zIndex:`calc(${Z} - ${e==null?void 0:e.order})`},className:`${K?"dragging":""} ${b?n.open:n.closed}`,draggable:h,onDragStart:c=>{var Y;h?(c.dataTransfer.setData("application/my-app",(Y=e==null?void 0:e.order)==null?void 0:Y.toString()),L(!0)):c.preventDefault()},onDragEnd:()=>L(!1),children:[s.jsxs("span",{onMouseOver:M,onMouseDown:u,className:`${n["drag-handle"]} tooltip-wrap`,children:[s.jsx(Be,{}),s.jsx("span",{className:"tooltip narrow2 below right",children:Ae[a]})]}),s.jsxs("label",{onClick:de,children:[s.jsx("input",{type:"checkbox",id:`check_${f(e==null?void 0:e.name)}`,checked:(e==null?void 0:e.complete)??!1,onChange:T}),s.jsx("span",{onMouseOver:F,onMouseDown:Ne,onMouseUp:we,children:e==null?void 0:e.name}),s.jsx("div",{className:`${n["more-info-wrap"]}`,children:(e==null?void 0:e.deadline)&&(e==null?void 0:e.deadline)!==""&&(()=>{const c=new Date(e.deadline),Y=new Date;c.setHours(0,0,0,0),Y.setHours(0,0,0,0);const ke=c<Y,o=c.getTime()===Y.getTime();return s.jsxs("span",{className:`${n.deadline} ${ke?n.overdue:""} ${o?n.today:""}`,children:[je[a],":"," ",o?_e[a]:new Date(e.deadline).toLocaleDateString(a,{year:"numeric",month:"long",day:"numeric"})]})})()})]}),s.jsxs("div",{className:`${n["btn-wrap"]}`,children:[(e==null?void 0:e.priority)==="high"?s.jsxs("b",{className:`tooltip-wrap ${n.high}`,children:[s.jsx(Pe,{}),s.jsxs("span",{className:"scr",children:[S[a],": ",le[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[S[a],": ",le[a]]})]}):(e==null?void 0:e.priority)==="medium"?s.jsxs("b",{className:`tooltip-wrap ${n.medium}`,children:[s.jsx(Re,{}),s.jsxs("span",{className:"scr",children:[S[a],": ",ie[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[S[a],": ",ie[a]]})]}):(e==null?void 0:e.priority)==="low"?s.jsxs("b",{className:`tooltip-wrap ${n.low}`,children:[s.jsx(qe,{viewBox:"0 0 17 17"}),s.jsxs("span",{className:"scr",children:[S[a],": ",ce[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[S[a],": ",ce[a]]})]}):s.jsx(s.Fragment,{children:" "}),(e==null?void 0:e.category)==="personal"?s.jsxs("b",{className:`tooltip-wrap ${n.cat}`,children:[s.jsx(We,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",te[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",te[a]]})]}):(e==null?void 0:e.category)==="work"?s.jsxs("b",{className:`tooltip-wrap ${n.cat} ${n.bg}`,children:[s.jsx(Ue,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",me[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",me[a]]})]}):(e==null?void 0:e.category)==="shopping"?s.jsxs("b",{className:`tooltip-wrap ${n.cat} ${n.bg}`,children:[s.jsx(Ke,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",he[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",he[a]]})]}):s.jsxs("b",{className:`tooltip-wrap ${n.cat}`,children:[s.jsx(Ve,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",pe[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",pe[a]]})]}),s.jsxs("button",{onClick:()=>p(!0),className:`${n.edit} tooltip-wrap`,disabled:(e==null?void 0:e.complete)??!1,children:[s.jsx(Xe,{}),s.jsx("span",{className:"scr",children:W[a]}),s.jsx("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:W[a]})]}),s.jsxs("button",{className:`${n.delete} tooltip-wrap`,onClick:b?()=>p(!1):O,children:[s.jsx("span",{className:n["delete-inner"],"aria-hidden":"true",children:"×"}),s.jsx("span",{className:"scr",children:ue[a]}),s.jsx("span",{className:"tooltip below left narrow2","aria-hidden":"true",children:ue[a]})]})]}),b&&s.jsx(Ge,{title:e==null?void 0:e.name,language:a,handleModify:r,newName:d,setNewName:x,newPriority:C,setNewPriority:k,newDay:y,setNewDay:B,newMonth:$,setNewMonth:H,newYear:m,setNewYear:P,newCategory:R,setNewCategory:J,priorityOptions:X,categoryOptions:w,showDeadline:_,setShowDeadline:j,sending:V,todo:e,setIsOpen:p,maxCharacters:z})]})})}export{xs as default};
