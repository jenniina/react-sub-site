import{r as i,j as s}from"./react-A9DAvxly.js";import{kW as ye,ag as De,kX as V,bY as n,kY as ee,cr as W,c3 as se,hB as f,kZ as _,c4 as Se,an as E,k_ as je,b$ as A,k$ as ae,l0 as re,l1 as Ee,c0 as ke,c1 as ve,c2 as be,l2 as Ce,l3 as Te,gm as Me,l4 as ne,l5 as Fe,u as Ye,l6 as _e,l7 as He,l8 as le,l9 as ie,la as ce,ao as N,h_ as te,hZ as me,lb as he,h$ as pe,lc as ue,fO as Ie,J as fe,b_ as Ae}from"./index-DdJzb_U7.js";import{be as Le,bf as Pe,bg as Re,bh as Be,bi as ze,bj as qe,bk as We,bl as Ue,bm as Ke,bn as Ze,bo as Je}from"./react-icons-yVutJqMS.js";import{R as Oe}from"./react-dom-CxfJ6lHP.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./react-redux-C4cSaZU-.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-DEc9BFqZ.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-j9Ns2JNj.js";import"./react-router-BoqxkIr7.js";import"./@remix-run-DTnHqtaE.js";import"./scheduler-CzFDRTuY.js";const xe=Me(6),Xe=({todo:e,language:l,priorityOptions:k,categoryOptions:a,handleModify:U,sending:K,newCategory:g,newPriority:L,setNewPriority:Z,setNewCategory:J,showDeadline:w,setShowDeadline:O,title:P,newName:v,setNewName:d,newDay:x,setNewDay:H,newMonth:j,setNewMonth:C,newYear:$,setNewYear:y,setIsOpen:R,maxCharacters:D})=>{const[I,m]=i.useState(null),B=r=>{d(r.target.value)},X=r=>{Number(r)<=31&&r.length<=2?(H(r),m(null)):m(`${ne[l]}: ${ae[l]}`)},z=r=>{Number(r)<=12&&r.length<=2?(C(r),m(null)):m(`${ne[l]}: ${re[l]}`)},G=r=>{const h=r.target.value;Number(h)<=Number(new Date().getFullYear())+10&&h.length<=4?(y(h),m(null)):m(Fe[l])};i.useEffect(()=>{if(x&&j&&$){const r=new Date(Number($),Number(j)-1,Number(x)),h=new Date;h.setHours(0,0,0,0),m(null),r<h&&m(ye[l])}},[x,j,$,l]),i.useEffect(()=>{w?(x||H((new Date().getDate()+1).toString().padStart(2,"0")),j||C((new Date().getMonth()+1).toString().padStart(2,"0")),$||y(new Date().getFullYear().toString())):(H(""),C(""),y(""))},[w]);const b=i.useRef(null),p=i.useRef(null);i.useEffect(()=>{var h;p.current=document.activeElement,(h=b.current)==null||h.focus();const r=t=>{var q,S;if(t.key==="Tab"){const u=(S=(q=b.current)==null?void 0:q.parentElement)==null?void 0:S.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!u||u.length===0){t.preventDefault();return}const M=u==null?void 0:u[0],F=u==null?void 0:u[u.length-1];t.shiftKey?document.activeElement===M&&(t.preventDefault(),F==null||F.focus()):document.activeElement===F&&(t.preventDefault(),M==null||M.focus())}else t.key==="Escape"&&T()};return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r),p.current?p.current.focus():document.body.focus()}},[b.current]);const T=()=>{R(!1),p.current?p.current.focus():document.body.focus()},Q=De();return Oe.createPortal(s.jsx("div",{className:`${V["modal-overlay"]} ${Q?n.light:""}`,onClick:T,children:s.jsxs("div",{className:`${V["modal-content"]} ${n["todo-modal"]}`,onClick:r=>r.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":P??"Task",children:[s.jsxs("button",{ref:b,className:`${V["close-button"]} tooltip-wrap`,onClick:T,children:[s.jsx("span",{"aria-hidden":"true",children:"×"}),s.jsx("span",{className:"scr",children:ee[l]}),s.jsx("span",{"aria-hidden":"true",className:"tooltip below left narrow2",children:ee[l]})]}),s.jsx("h2",{children:W[l]}),s.jsxs("form",{onSubmit:U,className:`${n.modify}`,children:[s.jsx(se,{id:`category_${f(_((e==null?void 0:e.name)??xe,l))}`,className:`${n.select} ${n["category-select"]}`,value:a==null?void 0:a.find(r=>r.value===g),onChange:r=>J(r==null?void 0:r.value),options:a,instructions:Se[l],language:l,hideDelete:!0,z:3}),s.jsx(se,{id:`priority_${f(_((e==null?void 0:e.name)??xe,l))}`,className:`${n.select}`,value:k==null?void 0:k.find(r=>r.value===L),onChange:r=>Z(r==null?void 0:r.value),options:k,instructions:E[l],language:l,hideDelete:!0,z:2}),s.jsxs("fieldset",{className:`${n.fieldset} ${n["deadline-wrap"]}`,children:[s.jsx("legend",{children:s.jsxs("label",{children:[je[l]," ",s.jsx("input",{style:{marginLeft:"0.5em"},type:"checkbox",checked:w,onChange:()=>O(!w)})]})}),w&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:n["deadline-inputs"],children:[s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`day_${f(_((e==null?void 0:e.name)??A[l],l))}`,children:ae[l]}),s.jsx("input",{type:"number",id:`day_${f((e==null?void 0:e.name)||"Task")}`,name:"day",min:1,max:31,value:x,placeholder:"DD",onChange:r=>X(r.target.value),required:!0,className:"bg"})]}),s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`month_${f((e==null?void 0:e.name)||"Task")}`,children:re[l]}),s.jsx("input",{type:"number",id:`month_${f(_((e==null?void 0:e.name)??A[l],l))}`,name:"month",min:1,max:12,value:j,placeholder:"MM",onChange:r=>z(r.target.value),required:!0,className:"bg"})]}),s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`year_${f((e==null?void 0:e.name)||"Task")}`,children:Ee[l]}),s.jsx("input",{type:"number",id:`year_${f(_((e==null?void 0:e.name)??A[l],l))}`,name:"year",min:new Date().getFullYear(),max:new Date().getFullYear()+10,value:$,placeholder:"YYYY",onChange:r=>G(r),required:!0,className:"bg"})]})]})," ",I&&s.jsx("p",{className:n.error,children:I})]})]}),s.jsxs("fieldset",{className:`${n.fieldset} ${n.textarea}`,children:[s.jsx("legend",{children:A[l]}),s.jsxs("label",{children:[s.jsx("textarea",{id:`task_${f(e==null?void 0:e.name)}`,required:!0,name:"task",rows:4,value:v,onChange:B}),s.jsxs("p",{className:n.small,children:[D-v.length," ",ke[l]," (",ve[l],": ",D,")"," ",v.length>D&&s.jsx("span",{className:n.warning,children:be[l]})]}),s.jsxs("span",{className:"scr",children:[W[l]," ",_((e==null?void 0:e.name)??A[l],l)]})]})]}),s.jsxs("button",{type:"submit",disabled:K,className:"modify",children:[Ce[l]," ",s.jsx(Le,{})]}),s.jsxs("button",{onClick:T,className:`reset ${n.cancel}`,type:"button",children:[Te[l]," ",s.jsx(Pe,{})]})]})]})}),document.getElementById("modal-root"))};function fs({todo:e,toggleTodo:l,deleteTodo:k,language:a,modifyTodo:U,isDragging:K,handleUpdate:g,handleDragging:L,sending:Z,priorityOptions:J,categoryOptions:w,zin:O,maxCharacters:P}){const v=Ye(),[d,x]=i.useState((e==null?void 0:e.name)??""),[H,j]=i.useState(!1),[C,$]=i.useState((e==null?void 0:e.priority)||"low"),[y,R]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getDate().toString().padStart(2,"0"):""),[D,I]=i.useState(e!=null&&e.deadline?(new Date(e.deadline).getMonth()+1).toString().padStart(2,"0"):""),[m,B]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getFullYear().toString():""),X=y&&D&&m?`${m}-${D}-${y}`:"",[z,G]=i.useState((e==null?void 0:e.category)||"other"),[b,p]=i.useState(!1);function T(){l(e==null?void 0:e.key)}function Q(){window.confirm(Ie[a]+' "'+(e==null?void 0:e.name)+'"?')&&(x(""),k(e==null?void 0:e.key),p(!1))}const r=c=>{if(c.preventDefault(),d===""){v(fe(Ae[a],!0,5));return}if(d.length>P){v(fe(be[a],!0,5));return}U(e==null?void 0:e.key,d,C,X,z),p(!1)};i.useEffect(()=>{e!=null&&e.deadline&&j(!0)},[e]),i.useEffect(()=>{if((e==null?void 0:e.name)!==d&&x((e==null?void 0:e.name)||""),e!=null&&e.deadline){const c=new Date(e.deadline);R(c.getDate().toString().padStart(2,"0")),I((c.getMonth()+1).toString().padStart(2,"0")),B(c.getFullYear().toString())}},[e]);const[h,t]=i.useState(!0),[q,S]=i.useState(!1),u=()=>{t(!0),S(!1)},M=()=>{t(!0)},F=()=>{t(!1)},Ne=()=>{t(!1),S(!0)},we=()=>{var c;(c=window.getSelection())!=null&&c.toString()?(t(!1),S(!0)):(t(!0),S(!1))},de=c=>{q&&c.preventDefault()};return s.jsx(s.Fragment,{children:s.jsxs("li",{style:{zIndex:`calc(${O} - ${e==null?void 0:e.order})`},className:`${K?"dragging":""} ${b?n.open:n.closed}`,draggable:h,onDragStart:c=>{var Y;h?(c.dataTransfer.setData("application/my-app",(Y=e==null?void 0:e.order)==null?void 0:Y.toString()),L(!0)):c.preventDefault()},onDragEnd:()=>L(!1),children:[s.jsxs("span",{onMouseOver:M,onMouseDown:u,className:`${n["drag-handle"]} tooltip-wrap`,children:[s.jsx(Re,{}),s.jsx("span",{className:"tooltip narrow2 below right",children:_e[a]})]}),s.jsxs("label",{onClick:de,children:[s.jsx("input",{type:"checkbox",id:`check_${f(e==null?void 0:e.name)}`,checked:(e==null?void 0:e.complete)??!1,onChange:T}),s.jsx("span",{onMouseOver:F,onMouseDown:Ne,onMouseUp:we,children:e==null?void 0:e.name}),s.jsx("div",{className:`${n["more-info-wrap"]}`,children:(e==null?void 0:e.deadline)&&(e==null?void 0:e.deadline)!==""&&(()=>{const c=new Date(e.deadline),Y=new Date;c.setHours(0,0,0,0),Y.setHours(0,0,0,0);const $e=c<Y,o=c.getTime()===Y.getTime();return s.jsxs("span",{className:`${n.deadline} ${$e?n.overdue:""} ${o?n.today:""}`,children:[je[a],":"," ",o?He[a]:new Date(e.deadline).toLocaleDateString(a,{year:"numeric",month:"long",day:"numeric"})]})})()})]}),s.jsxs("div",{className:`${n["btn-wrap"]}`,children:[(e==null?void 0:e.priority)==="high"?s.jsxs("b",{className:`tooltip-wrap ${n.high}`,children:[s.jsx(Be,{}),s.jsxs("span",{className:"scr",children:[E[a],": ",le[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[E[a],": ",le[a]]})]}):(e==null?void 0:e.priority)==="medium"?s.jsxs("b",{className:`tooltip-wrap ${n.medium}`,children:[s.jsx(ze,{}),s.jsxs("span",{className:"scr",children:[E[a],": ",ie[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[E[a],": ",ie[a]]})]}):(e==null?void 0:e.priority)==="low"?s.jsxs("b",{className:`tooltip-wrap ${n.low}`,children:[s.jsx(qe,{viewBox:"0 0 17 17"}),s.jsxs("span",{className:"scr",children:[E[a],": ",ce[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[E[a],": ",ce[a]]})]}):s.jsx(s.Fragment,{children:" "}),(e==null?void 0:e.category)==="personal"?s.jsxs("b",{className:`tooltip-wrap ${n.cat}`,children:[s.jsx(We,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",te[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",te[a]]})]}):(e==null?void 0:e.category)==="work"?s.jsxs("b",{className:`tooltip-wrap ${n.cat} ${n.bg}`,children:[s.jsx(Ue,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",me[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",me[a]]})]}):(e==null?void 0:e.category)==="shopping"?s.jsxs("b",{className:`tooltip-wrap ${n.cat} ${n.bg}`,children:[s.jsx(Ke,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",he[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",he[a]]})]}):s.jsxs("b",{className:`tooltip-wrap ${n.cat}`,children:[s.jsx(Ze,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",pe[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",pe[a]]})]}),s.jsxs("button",{onClick:()=>p(!0),className:`${n.edit} tooltip-wrap`,disabled:(e==null?void 0:e.complete)??!1,children:[s.jsx(Je,{}),s.jsx("span",{className:"scr",children:W[a]}),s.jsx("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:W[a]})]}),s.jsxs("button",{className:`${n.delete} tooltip-wrap`,onClick:b?()=>p(!1):Q,children:[s.jsx("span",{className:n["delete-inner"],"aria-hidden":"true",children:"×"}),s.jsx("span",{className:"scr",children:ue[a]}),s.jsx("span",{className:"tooltip below left narrow2","aria-hidden":"true",children:ue[a]})]})]}),b&&s.jsx(Xe,{title:e==null?void 0:e.name,language:a,handleModify:r,newName:d,setNewName:x,newPriority:C,setNewPriority:$,newDay:y,setNewDay:R,newMonth:D,setNewMonth:I,newYear:m,setNewYear:B,newCategory:z,setNewCategory:G,priorityOptions:J,categoryOptions:w,showDeadline:H,setShowDeadline:j,sending:Z,todo:e,setIsOpen:p,maxCharacters:P})]})})}export{fs as default};
