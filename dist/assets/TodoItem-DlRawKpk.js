import{r as i,j as a}from"./react-kX_YxI4E.js";import{L as ee,l as le,aR as J,ai as r,S as X,aB as g,aS as M,I as ie,u as te,e as Z}from"./index-De2CRixK.js";import{bd as ce,be as me,bf as ue,bg as he,bh as pe,bi as xe,bj as fe,bk as ge,bl as je,bm as Ee,bn as be}from"./react-icons-DhcENkY1.js";import{R as Ne}from"./react-dom-B5MLDbn_.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";import"./scheduler-CzFDRTuY.js";const o=ie(6),de=({todo:e,language:h,priorityOptions:D,categoryOptions:b,handleModify:B,sending:z,newCategory:Q,newPriority:L,setNewPriority:q,setNewCategory:W,showDeadline:N,setShowDeadline:U,title:H,newName:s,setNewName:I,newDay:p,setNewDay:d,newMonth:w,setNewMonth:S,newYear:j,setNewYear:F,setIsOpen:P,maxCharacters:$})=>{const{t:l}=i.useContext(ee),[Y,m]=i.useState(null),_=n=>{I(n.target.value)},K=n=>{Number(n)<=31&&n.length<=2?(d(n),m(null)):m(`${l("ESet")}: ${l("EDay")}`)},R=n=>{Number(n)<=12&&n.length<=2?(S(n),m(null)):m(`${l("ESet")}: ${l("EMonth")}`)},O=n=>{const u=n.target.value;Number(u)<=Number(new Date().getFullYear())+10&&u.length<=4?(F(u),m(null)):m(l("EYearMustBeBetweenCurrentYearAnd10YearsFromNow"))};i.useEffect(()=>{if(p&&w&&j){const n=new Date(Number(j),Number(w)-1,Number(p)),u=new Date;u.setHours(0,0,0,0),m(null),n<u&&m(l("ETheDateIsInThePast"))}},[p,w,j,h]),i.useEffect(()=>{N?(p||d((new Date().getDate()+1).toString().padStart(2,"0")),w||S((new Date().getMonth()+1).toString().padStart(2,"0")),j||F(new Date().getFullYear().toString())):(d(""),S(""),F(""))},[N]);const E=i.useRef(null),x=i.useRef(null);i.useEffect(()=>{var u;x.current=document.activeElement,(u=E.current)==null||u.focus();const n=c=>{var A,y;if(c.key==="Tab"){const f=(y=(A=E.current)==null?void 0:A.parentElement)==null?void 0:y.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!f||f.length===0){c.preventDefault();return}const k=f==null?void 0:f[0],T=f==null?void 0:f[f.length-1];c.shiftKey?document.activeElement===k&&(c.preventDefault(),T==null||T.focus()):document.activeElement===T&&(c.preventDefault(),k==null||k.focus())}else c.key==="Escape"&&C()};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n),x.current?x.current.focus():document.body.focus()}},[E.current]);const C=()=>{P(!1),x.current?x.current.focus():document.body.focus()},G=le();return Ne.createPortal(a.jsx("div",{className:`${J["modal-overlay"]} ${G?r.light:""}`,onClick:C,children:a.jsxs("div",{className:`${J["modal-content"]} ${r["todo-modal"]}`,onClick:n=>n.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":H??"Task",children:[a.jsxs("button",{ref:E,className:`${J["close-button"]} tooltip-wrap`,onClick:C,children:[a.jsx("span",{"aria-hidden":"true",children:"Ã—"}),a.jsx("span",{className:"scr",children:l("EClose")}),a.jsx("span",{"aria-hidden":"true",className:"tooltip below left narrow2",children:l("EClose")})]}),a.jsx("h2",{children:l("EEdit")}),a.jsxs("form",{onSubmit:B,className:`${r.modify}`,children:[a.jsx(X,{id:`category_${g(M((e==null?void 0:e.name)??o,h))}`,className:`${r.select} ${r["category-select"]}`,value:b==null?void 0:b.find(n=>n.value===Q),onChange:n=>W(n==null?void 0:n.value),options:b,instructions:l("ESelectCategory"),language:h,hideDelete:!0,z:3}),a.jsx(X,{id:`priority_${g(M((e==null?void 0:e.name)??o,h))}`,className:`${r.select}`,value:D==null?void 0:D.find(n=>n.value===L),onChange:n=>q(n==null?void 0:n.value),options:D,instructions:l("EPriority"),language:h,hideDelete:!0,z:2}),a.jsxs("fieldset",{className:`${r.fieldset} ${r["deadline-wrap"]}`,children:[a.jsx("legend",{children:a.jsxs("label",{children:[l("EDeadline")," ",a.jsx("input",{style:{marginLeft:"0.5em"},type:"checkbox",checked:N,onChange:()=>U(!N)})]})}),N&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:r["deadline-inputs"],children:[a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`day_${g(M((e==null?void 0:e.name)??l("ETask"),h))}`,children:l("EDay")}),a.jsx("input",{type:"number",id:`day_${g((e==null?void 0:e.name)||"Task")}`,name:"day",min:1,max:31,value:p,placeholder:"DD",onChange:n=>K(n.target.value),required:!0,className:"bg"})]}),a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`month_${g((e==null?void 0:e.name)||"Task")}`,children:l("EMonth")}),a.jsx("input",{type:"number",id:`month_${g(M((e==null?void 0:e.name)??l("ETask"),h))}`,name:"month",min:1,max:12,value:w,placeholder:"MM",onChange:n=>R(n.target.value),required:!0,className:"bg"})]}),a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`year_${g((e==null?void 0:e.name)||"Task")}`,children:l("EYear")}),a.jsx("input",{type:"number",id:`year_${g(M((e==null?void 0:e.name)??l("ETask"),h))}`,name:"year",min:new Date().getFullYear(),max:new Date().getFullYear()+10,value:j,placeholder:"YYYY",onChange:n=>O(n),required:!0,className:"bg"})]})]})," ",Y&&a.jsx("p",{className:r.error,children:Y})]})]}),a.jsxs("fieldset",{className:`${r.fieldset} ${r.textarea}`,children:[a.jsx("legend",{children:l("ETask")}),a.jsxs("label",{children:[a.jsx("textarea",{id:`task_${g(e==null?void 0:e.name)}`,required:!0,name:"task",rows:4,value:s,onChange:_}),a.jsxs("p",{className:r.small,children:[$-s.length," ",l("ECharactersLeft")," (",l("EMax"),":"," ",$,")"," ",s.length>$&&a.jsx("span",{className:r.warning,children:l("ENameTooLong")})]}),a.jsxs("span",{className:"scr",children:[l("EEdit")," ",M((e==null?void 0:e.name)??l("ETask"),h)]})]})]}),a.jsxs("button",{type:"submit",disabled:z,className:"modify",children:[l("EConfirm")," ",a.jsx(ce,{})]}),a.jsxs("button",{onClick:C,className:`reset ${r.cancel}`,type:"button",children:[l("ECancel")," ",a.jsx(me,{})]})]})]})}),document.getElementById("modal-root"))};function Be({todo:e,toggleTodo:h,deleteTodo:D,language:b,modifyTodo:B,isDragging:z,handleUpdate:Q,handleDragging:L,sending:q,priorityOptions:W,categoryOptions:N,zin:U,maxCharacters:H}){const{t:s}=i.useContext(ee),I=te(),[p,d]=i.useState((e==null?void 0:e.name)??""),[w,S]=i.useState(!1),[j,F]=i.useState((e==null?void 0:e.priority)||"low"),[P,$]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getDate().toString().padStart(2,"0"):""),[l,Y]=i.useState(e!=null&&e.deadline?(new Date(e.deadline).getMonth()+1).toString().padStart(2,"0"):""),[m,_]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getFullYear().toString():""),K=P&&l&&m?`${m}-${l}-${P}`:"",[R,O]=i.useState((e==null?void 0:e.category)||"other"),[E,x]=i.useState(!1);function C(){h(e==null?void 0:e.key)}function G(){window.confirm(s("EAreYouSureYouWantToDelete")+' "'+(e==null?void 0:e.name)+'"?')&&(d(""),D(e==null?void 0:e.key),x(!1))}const n=t=>{if(t.preventDefault(),p===""){I(Z(s("EAddTask"),!0,5));return}if(p.length>H){I(Z(s("ENameTooLong"),!0,5));return}B(e==null?void 0:e.key,p,j,K,R),x(!1)};i.useEffect(()=>{e!=null&&e.deadline&&S(!0)},[e]),i.useEffect(()=>{if((e==null?void 0:e.name)!==p&&d((e==null?void 0:e.name)||""),e!=null&&e.deadline){const t=new Date(e.deadline);$(t.getDate().toString().padStart(2,"0")),Y((t.getMonth()+1).toString().padStart(2,"0")),_(t.getFullYear().toString())}},[e]);const[u,c]=i.useState(!0),[A,y]=i.useState(!1),f=()=>{c(!0),y(!1)},k=()=>{c(!0)},T=()=>{c(!1)},ae=()=>{c(!1),y(!0)},se=()=>{var t;(t=window.getSelection())!=null&&t.toString()?(c(!1),y(!0)):(c(!0),y(!1))},ne=t=>{A&&t.preventDefault()};return a.jsx(a.Fragment,{children:a.jsxs("li",{style:{zIndex:`calc(${U} - ${e==null?void 0:e.order})`},className:`${z?"dragging":""} ${E?r.open:r.closed}`,draggable:u,onDragStart:t=>{var v;u?(t.dataTransfer.setData("application/my-app",(v=e==null?void 0:e.order)==null?void 0:v.toString()),L(!0)):t.preventDefault()},onDragEnd:()=>L(!1),children:[a.jsxs("span",{onMouseOver:k,onMouseDown:f,className:`${r["drag-handle"]} tooltip-wrap`,children:[a.jsx(ue,{}),a.jsx("span",{className:"tooltip narrow2 below right",children:s("EDraggable")})]}),a.jsxs("label",{onClick:ne,children:[a.jsx("input",{type:"checkbox",id:`check_${g(e==null?void 0:e.name)}`,checked:(e==null?void 0:e.complete)??!1,onChange:C}),a.jsx("span",{onMouseOver:T,onMouseDown:ae,onMouseUp:se,children:e==null?void 0:e.name}),a.jsx("div",{className:`${r["more-info-wrap"]}`,children:(e==null?void 0:e.deadline)&&(e==null?void 0:e.deadline)!==""&&(()=>{const t=new Date(e.deadline),v=new Date;t.setHours(0,0,0,0),v.setHours(0,0,0,0);const re=t<v,V=t.getTime()===v.getTime();return a.jsxs("span",{className:`${r.deadline} ${re?r.overdue:""} ${V?r.today:""}`,children:[s("EDeadline"),":"," ",V?s("EToday"):new Date(e.deadline).toLocaleDateString(b,{year:"numeric",month:"long",day:"numeric"})]})})()})]}),a.jsxs("div",{className:`${r["btn-wrap"]}`,children:[(e==null?void 0:e.priority)==="high"?a.jsxs("b",{className:`tooltip-wrap ${r.high}`,children:[a.jsx(he,{}),a.jsxs("span",{className:"scr",children:[s("EPriority"),": ",s("EHigh")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("EPriority"),": ",s("EHigh")]})]}):(e==null?void 0:e.priority)==="medium"?a.jsxs("b",{className:`tooltip-wrap ${r.medium}`,children:[a.jsx(pe,{}),a.jsxs("span",{className:"scr",children:[s("EPriority"),": ",s("EMedium")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("EPriority"),": ",s("EMedium")]})]}):(e==null?void 0:e.priority)==="low"?a.jsxs("b",{className:`tooltip-wrap ${r.low}`,children:[a.jsx(xe,{viewBox:"0 0 17 17"}),a.jsxs("span",{className:"scr",children:[s("EPriority"),": ",s("ELow")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("EPriority"),": ",s("ELow")]})]}):a.jsx(a.Fragment,{children:"Â "}),(e==null?void 0:e.category)==="personal"?a.jsxs("b",{className:`tooltip-wrap ${r.cat}`,children:[a.jsx(fe,{}),a.jsxs("span",{className:"scr",children:[s("ECategoryTitle"),": ",s("EPersonal")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("ECategoryTitle"),": ",s("EPersonal")]})]}):(e==null?void 0:e.category)==="work"?a.jsxs("b",{className:`tooltip-wrap ${r.cat} ${r.bg}`,children:[a.jsx(ge,{}),a.jsxs("span",{className:"scr",children:[s("ECategoryTitle"),": ",s("EWork")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("ECategoryTitle"),": ",s("EWork")]})]}):(e==null?void 0:e.category)==="shopping"?a.jsxs("b",{className:`tooltip-wrap ${r.cat} ${r.bg}`,children:[a.jsx(je,{}),a.jsxs("span",{className:"scr",children:[s("ECategoryTitle"),": ",s("EShopping")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("ECategoryTitle"),": ",s("EShopping")]})]}):a.jsxs("b",{className:`tooltip-wrap ${r.cat}`,children:[a.jsx(Ee,{}),a.jsxs("span",{className:"scr",children:[s("ECategoryTitle"),": ",s("EOther")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("ECategoryTitle"),": ",s("EOther")]})]}),a.jsxs("button",{onClick:()=>x(!0),className:`${r.edit} tooltip-wrap`,disabled:(e==null?void 0:e.complete)??!1,children:[a.jsx(be,{}),a.jsx("span",{className:"scr",children:s("EEdit")}),a.jsx("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:s("EEdit")})]}),a.jsxs("button",{className:`${r.delete} tooltip-wrap`,onClick:E?()=>x(!1):G,children:[a.jsx("span",{className:r["delete-inner"],"aria-hidden":"true",children:"Ã—"}),a.jsx("span",{className:"scr",children:s("EDeleteTask")}),a.jsx("span",{className:"tooltip below left narrow2","aria-hidden":"true",children:s("EDeleteTask")})]})]}),E&&a.jsx(de,{title:e==null?void 0:e.name,language:b,handleModify:n,newName:p,setNewName:d,newPriority:j,setNewPriority:F,newDay:P,setNewDay:$,newMonth:l,setNewMonth:Y,newYear:m,setNewYear:_,newCategory:R,setNewCategory:O,priorityOptions:W,categoryOptions:N,showDeadline:w,setShowDeadline:S,sending:q,todo:e,setIsOpen:x,maxCharacters:H})]})})}export{Be as default};
