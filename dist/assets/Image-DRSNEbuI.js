import{r as k,j as e}from"./react-kX_YxI4E.js";import{u as R,gB as u,k1 as $,o as y,c0 as E,k2 as L,k3 as C,jL as I,k4 as P,h1 as M}from"./index-epxSP5Qu.js";import{u as U,g}from"./Images-CskpzGoG.js";import{Q as N,P as Q,g as v}from"./poems-Db1BfHVA.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-D7bD3W54.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const q=({image:t,language:o,handleDownload:b,searchTerm:p,textType:c})=>{const f=R(),{tooltip:m,handleMouseMove:l,handleMouseLeave:s}=U(),d=i=>{const n=i.currentTarget.getBoundingClientRect(),a=i.clientX-n.left+10,x=i.clientY-n.top+10;l(a,x)},[w,h]=k.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[j,r]=k.useState({title:"",author:"",lines:[],linecount:"0"});return k.useEffect(()=>{if(c==="poem"){const i=Math.floor(Math.random()*5)+1;(async()=>{const a=await v(o,i);r(a[0])})()}else c==="quote"?(async()=>{const n=await g(o,p);n.quote?h(n.quote):f(y(n.message??E[o],!0,8))})():Math.floor(Math.random()*2)+1===1?(async()=>{const a=Math.floor(Math.random()*5)+1,x=await v(o,a);r(x[0])})():(async()=>{const a=await g(o,p);a.quote?h(a.quote):f(y(a.message??E[o],!0,8))})()},[o,p,c]),e.jsxs("div",{onMouseMove:d,onMouseLeave:s,children:[e.jsxs("div",{className:`tooltip-wrap ${u["image-wrap"]} ${u["image-modal"]}`,children:[e.jsxs("button",{onClick:b,className:"reset",children:[e.jsx("img",{src:t.largeImageURL,alt:t.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),m.visible&&e.jsx("span",{className:"tooltip narrow",style:{top:m.y,left:m.x,right:"unset"},children:$[o]})]}),c==="quote"?e.jsx(N,{quote:w,language:o}):e.jsx(Q,{poem:j,language:o})]})},so=({image:t,language:o,show:b,searchTerm:p,textType:c})=>{const f=R(),m=async()=>{if(window.confirm(P[o]+"?")){const s=await fetch(t.largeImageURL,{mode:"cors"});if(!s.ok)throw new Error("Network response was not ok");try{const d=await s.blob(),w=window.URL.createObjectURL(d),h=t.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),j=h?h[1].toLowerCase():"jpg",r=document.createElement("a");r.href=w,r.download=`${M(`${t.id}`)}-${M(t.user)}.${j}`,r.target="_blank",r.rel="noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(w)}catch(d){console.error("Download failed:",d),f(y(`${E[o]}: ${d}`,!0,5))}}},l=()=>{b({title:t.tags,className:u["image-modal"],children:e.jsx(q,{image:t,language:o,handleDownload:m,searchTerm:p,textType:c})})};return e.jsxs("div",{className:`tooltip-wrap ${u["image-wrap"]}`,children:[e.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":L[o],onClick:l,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),l())},children:e.jsx("img",{src:t.webformatURL,alt:t.tags,title:t.tags,loading:"lazy",className:`${u["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:l,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&l()}})}),e.jsx("span",{className:"tooltip above narrow2",children:L[o]}),e.jsx("p",{children:e.jsx("small",{children:e.jsxs("a",{href:t.pageURL,target:"_blank",rel:"noreferrer",children:[C[o]," (",I[o],": ",t.user,")"]})})})]},t.id)};export{so as default};
