import{r as i,j as s}from"./react-A9DAvxly.js";import{kq as ye,N as $e,kr as X,bu as n,ks as ee,bZ as U,bB as se,h7 as f,kt as A,bC as De,U as S,ku as je,bx as _,kv as ae,kw as re,kx as Se,by as Ee,bz as ve,bA as be,ky as Ce,kz as Te,fU as Me,kA as ne,kB as Fe,u as Ye,kC as Ae,kD as He,kE as le,kF as ie,kG as ce,V as N,hu as te,ht as me,kH as he,hv as pe,kI as ue,fk as Ie,p as fe,bw as _e}from"./index-ewQ3yapg.js";import{be as ze,bf as Be,bg as Le,bh as Pe,bi as Re,bj as qe,bk as Ue,bl as We,bm as Ke,bn as Ge,bo as Ve}from"./react-icons-yVutJqMS.js";import{R as Ze}from"./react-dom-CxfJ6lHP.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./react-redux-C4cSaZU-.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-DEc9BFqZ.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-j9Ns2JNj.js";import"./react-router-BoqxkIr7.js";import"./@remix-run-DTnHqtaE.js";import"./scheduler-CzFDRTuY.js";const xe=Me(6),Je=({todo:e,language:l,priorityOptions:E,categoryOptions:a,handleModify:W,sending:K,newCategory:g,newPriority:z,setNewPriority:G,setNewCategory:V,showDeadline:w,setShowDeadline:Z,title:B,newName:v,setNewName:d,newDay:x,setNewDay:H,newMonth:j,setNewMonth:C,newYear:k,setNewYear:y,setIsOpen:L,maxCharacters:$})=>{const[I,m]=i.useState(null),P=r=>{d(r.target.value)},J=r=>{Number(r)<=31&&r.length<=2?(H(r),m(null)):m(`${ne[l]}: ${ae[l]}`)},R=r=>{Number(r)<=12&&r.length<=2?(C(r),m(null)):m(`${ne[l]}: ${re[l]}`)},O=r=>{const h=r.target.value;Number(h)<=Number(new Date().getFullYear())+10&&h.length<=4?(y(h),m(null)):m(Fe[l])};i.useEffect(()=>{if(x&&j&&k){const r=new Date(Number(k),Number(j)-1,Number(x)),h=new Date;h.setHours(0,0,0,0),m(null),r<h&&m(ye[l])}},[x,j,k,l]),i.useEffect(()=>{w?(x||H((new Date().getDate()+1).toString().padStart(2,"0")),j||C((new Date().getMonth()+1).toString().padStart(2,"0")),k||y(new Date().getFullYear().toString())):(H(""),C(""),y(""))},[w]);const b=i.useRef(null),p=i.useRef(null);i.useEffect(()=>{var h;p.current=document.activeElement,(h=b.current)==null||h.focus();const r=t=>{var q,D;if(t.key==="Tab"){const u=(D=(q=b.current)==null?void 0:q.parentElement)==null?void 0:D.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!u||u.length===0){t.preventDefault();return}const M=u==null?void 0:u[0],F=u==null?void 0:u[u.length-1];t.shiftKey?document.activeElement===M&&(t.preventDefault(),F==null||F.focus()):document.activeElement===F&&(t.preventDefault(),M==null||M.focus())}else t.key==="Escape"&&T()};return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r),p.current?p.current.focus():document.body.focus()}},[b.current]);const T=()=>{L(!1),p.current?p.current.focus():document.body.focus()},Q=$e();return Ze.createPortal(s.jsx("div",{className:`${X["modal-overlay"]} ${Q?n.light:""}`,onClick:T,children:s.jsxs("div",{className:`${X["modal-content"]} ${n["todo-modal"]}`,onClick:r=>r.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":B??"Task",children:[s.jsxs("button",{ref:b,className:`${X["close-button"]} tooltip-wrap`,onClick:T,children:[s.jsx("span",{"aria-hidden":"true",children:"×"}),s.jsx("span",{className:"scr",children:ee[l]}),s.jsx("span",{"aria-hidden":"true",className:"tooltip below left narrow2",children:ee[l]})]}),s.jsx("h2",{children:U[l]}),s.jsxs("form",{onSubmit:W,className:`${n.modify}`,children:[s.jsx(se,{id:`category_${f(A((e==null?void 0:e.name)??xe,l))}`,className:`${n.select} ${n["category-select"]}`,value:a==null?void 0:a.find(r=>r.value===g),onChange:r=>V(r==null?void 0:r.value),options:a,instructions:De[l],language:l,hideDelete:!0,z:3}),s.jsx(se,{id:`priority_${f(A((e==null?void 0:e.name)??xe,l))}`,className:`${n.select}`,value:E==null?void 0:E.find(r=>r.value===z),onChange:r=>G(r==null?void 0:r.value),options:E,instructions:S[l],language:l,hideDelete:!0,z:2}),s.jsxs("fieldset",{className:`${n.fieldset} ${n["deadline-wrap"]}`,children:[s.jsx("legend",{children:s.jsxs("label",{children:[je[l]," ",s.jsx("input",{style:{marginLeft:"0.5em"},type:"checkbox",checked:w,onChange:()=>Z(!w)})]})}),w&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:n["deadline-inputs"],children:[s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`day_${f(A((e==null?void 0:e.name)??_[l],l))}`,children:ae[l]}),s.jsx("input",{type:"number",id:`day_${f((e==null?void 0:e.name)||"Task")}`,name:"day",min:1,max:31,value:x,placeholder:"DD",onChange:r=>J(r.target.value),required:!0,className:"bg"})]}),s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`month_${f((e==null?void 0:e.name)||"Task")}`,children:re[l]}),s.jsx("input",{type:"number",id:`month_${f(A((e==null?void 0:e.name)??_[l],l))}`,name:"month",min:1,max:12,value:j,placeholder:"MM",onChange:r=>R(r.target.value),required:!0,className:"bg"})]}),s.jsxs("div",{className:n.input,children:[s.jsx("label",{className:"scr",htmlFor:`year_${f((e==null?void 0:e.name)||"Task")}`,children:Se[l]}),s.jsx("input",{type:"number",id:`year_${f(A((e==null?void 0:e.name)??_[l],l))}`,name:"year",min:new Date().getFullYear(),max:new Date().getFullYear()+10,value:k,placeholder:"YYYY",onChange:r=>O(r),required:!0,className:"bg"})]})]})," ",I&&s.jsx("p",{className:n.error,children:I})]})]}),s.jsxs("fieldset",{className:`${n.fieldset} ${n.textarea}`,children:[s.jsx("legend",{children:_[l]}),s.jsxs("label",{children:[s.jsx("textarea",{id:`task_${f(e==null?void 0:e.name)}`,required:!0,name:"task",rows:4,value:v,onChange:P}),s.jsxs("p",{className:n.small,children:[$-v.length," ",Ee[l]," (",ve[l],": ",$,")"," ",v.length>$&&s.jsx("span",{className:n.warning,children:be[l]})]}),s.jsxs("span",{className:"scr",children:[U[l]," ",A((e==null?void 0:e.name)??_[l],l)]})]})]}),s.jsxs("button",{type:"submit",disabled:K,className:"modify",children:[Ce[l]," ",s.jsx(ze,{})]}),s.jsxs("button",{onClick:T,className:`reset ${n.cancel}`,type:"button",children:[Te[l]," ",s.jsx(Be,{})]})]})]})}),document.getElementById("modal-root"))};function fs({todo:e,toggleTodo:l,deleteTodo:E,language:a,modifyTodo:W,isDragging:K,handleUpdate:g,handleDragging:z,sending:G,priorityOptions:V,categoryOptions:w,zin:Z,maxCharacters:B}){const v=Ye(),[d,x]=i.useState((e==null?void 0:e.name)??""),[H,j]=i.useState(!1),[C,k]=i.useState((e==null?void 0:e.priority)||"low"),[y,L]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getDate().toString().padStart(2,"0"):""),[$,I]=i.useState(e!=null&&e.deadline?(new Date(e.deadline).getMonth()+1).toString().padStart(2,"0"):""),[m,P]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getFullYear().toString():""),J=y&&$&&m?`${m}-${$}-${y}`:"",[R,O]=i.useState((e==null?void 0:e.category)||"other"),[b,p]=i.useState(!1);function T(){l(e==null?void 0:e.key)}function Q(){window.confirm(Ie[a]+' "'+(e==null?void 0:e.name)+'"?')&&(x(""),E(e==null?void 0:e.key),p(!1))}const r=c=>{if(c.preventDefault(),d===""){v(fe(_e[a],!0,5));return}if(d.length>B){v(fe(be[a],!0,5));return}W(e==null?void 0:e.key,d,C,J,R),p(!1)};i.useEffect(()=>{e!=null&&e.deadline&&j(!0)},[e]),i.useEffect(()=>{if((e==null?void 0:e.name)!==d&&x((e==null?void 0:e.name)||""),e!=null&&e.deadline){const c=new Date(e.deadline);L(c.getDate().toString().padStart(2,"0")),I((c.getMonth()+1).toString().padStart(2,"0")),P(c.getFullYear().toString())}},[e]);const[h,t]=i.useState(!0),[q,D]=i.useState(!1),u=()=>{t(!0),D(!1)},M=()=>{t(!0)},F=()=>{t(!1)},Ne=()=>{t(!1),D(!0)},we=()=>{var c;(c=window.getSelection())!=null&&c.toString()?(t(!1),D(!0)):(t(!0),D(!1))},de=c=>{q&&c.preventDefault()};return s.jsx(s.Fragment,{children:s.jsxs("li",{style:{zIndex:`calc(${Z} - ${e==null?void 0:e.order})`},className:`${K?"dragging":""} ${b?n.open:n.closed}`,draggable:h,onDragStart:c=>{var Y;h?(c.dataTransfer.setData("application/my-app",(Y=e==null?void 0:e.order)==null?void 0:Y.toString()),z(!0)):c.preventDefault()},onDragEnd:()=>z(!1),children:[s.jsxs("span",{onMouseOver:M,onMouseDown:u,className:`${n["drag-handle"]} tooltip-wrap`,children:[s.jsx(Le,{}),s.jsx("span",{className:"tooltip narrow2 below right",children:Ae[a]})]}),s.jsxs("label",{onClick:de,children:[s.jsx("input",{type:"checkbox",id:`check_${f(e==null?void 0:e.name)}`,checked:(e==null?void 0:e.complete)??!1,onChange:T}),s.jsx("span",{onMouseOver:F,onMouseDown:Ne,onMouseUp:we,children:e==null?void 0:e.name}),s.jsx("div",{className:`${n["more-info-wrap"]}`,children:(e==null?void 0:e.deadline)&&(e==null?void 0:e.deadline)!==""&&(()=>{const c=new Date(e.deadline),Y=new Date;c.setHours(0,0,0,0),Y.setHours(0,0,0,0);const ke=c<Y,o=c.getTime()===Y.getTime();return s.jsxs("span",{className:`${n.deadline} ${ke?n.overdue:""} ${o?n.today:""}`,children:[je[a],":"," ",o?He[a]:new Date(e.deadline).toLocaleDateString(a,{year:"numeric",month:"long",day:"numeric"})]})})()})]}),s.jsxs("div",{className:`${n["btn-wrap"]}`,children:[(e==null?void 0:e.priority)==="high"?s.jsxs("b",{className:`tooltip-wrap ${n.high}`,children:[s.jsx(Pe,{}),s.jsxs("span",{className:"scr",children:[S[a],": ",le[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[S[a],": ",le[a]]})]}):(e==null?void 0:e.priority)==="medium"?s.jsxs("b",{className:`tooltip-wrap ${n.medium}`,children:[s.jsx(Re,{}),s.jsxs("span",{className:"scr",children:[S[a],": ",ie[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[S[a],": ",ie[a]]})]}):(e==null?void 0:e.priority)==="low"?s.jsxs("b",{className:`tooltip-wrap ${n.low}`,children:[s.jsx(qe,{viewBox:"0 0 17 17"}),s.jsxs("span",{className:"scr",children:[S[a],": ",ce[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[S[a],": ",ce[a]]})]}):s.jsx(s.Fragment,{children:" "}),(e==null?void 0:e.category)==="personal"?s.jsxs("b",{className:`tooltip-wrap ${n.cat}`,children:[s.jsx(Ue,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",te[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",te[a]]})]}):(e==null?void 0:e.category)==="work"?s.jsxs("b",{className:`tooltip-wrap ${n.cat} ${n.bg}`,children:[s.jsx(We,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",me[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",me[a]]})]}):(e==null?void 0:e.category)==="shopping"?s.jsxs("b",{className:`tooltip-wrap ${n.cat} ${n.bg}`,children:[s.jsx(Ke,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",he[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",he[a]]})]}):s.jsxs("b",{className:`tooltip-wrap ${n.cat}`,children:[s.jsx(Ge,{}),s.jsxs("span",{className:"scr",children:[N[a],": ",pe[a]]}),s.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[N[a],": ",pe[a]]})]}),s.jsxs("button",{onClick:()=>p(!0),className:`${n.edit} tooltip-wrap`,disabled:(e==null?void 0:e.complete)??!1,children:[s.jsx(Ve,{}),s.jsx("span",{className:"scr",children:U[a]}),s.jsx("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:U[a]})]}),s.jsxs("button",{className:`${n.delete} tooltip-wrap`,onClick:b?()=>p(!1):Q,children:[s.jsx("span",{className:n["delete-inner"],"aria-hidden":"true",children:"×"}),s.jsx("span",{className:"scr",children:ue[a]}),s.jsx("span",{className:"tooltip below left narrow2","aria-hidden":"true",children:ue[a]})]})]}),b&&s.jsx(Je,{title:e==null?void 0:e.name,language:a,handleModify:r,newName:d,setNewName:x,newPriority:C,setNewPriority:k,newDay:y,setNewDay:L,newMonth:$,setNewMonth:I,newYear:m,setNewYear:P,newCategory:R,setNewCategory:O,priorityOptions:V,categoryOptions:w,showDeadline:H,setShowDeadline:j,sending:G,todo:e,setIsOpen:p,maxCharacters:B})]})})}export{fs as default};
