import{r as y,j as s}from"./react-A9DAvxly.js";import{io as L,ip as j,K as v,gy as x,iq as k,ir as R,i0 as C,b0 as I,ba as E,W as P,bd as U}from"./index-Bm4mLiSs.js";import{u as $}from"./Images-0ZJDrCZZ.js";import{Q,P as g,g as M}from"./poems-DwW6Zio4.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./react-dom-yh0erWL-.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-CHm9GgGE.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-DEc9BFqZ.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-CrVlm7qW.js";import"./react-router-dom-CYs6befe.js";import"./react-router-S1Hdk0kP.js";import"./@remix-run-DTnHqtaE.js";const q=({image:t,language:o,handleDownload:f,searchTerm:d,textType:i})=>{const{tooltip:p,handleMouseMove:w,handleMouseLeave:c}=$(),r=e=>{const n=e.currentTarget.getBoundingClientRect(),a=e.clientX-n.left+10,b=e.clientY-n.top+10;w(a,b)},[l,m]=y.useState({quote:"",category:"",author:""}),[h,u]=y.useState({title:"",author:"",lines:[],linecount:"0"});return y.useEffect(()=>{if(i==="poem"){const e=Math.floor(Math.random()*5)+1;(async()=>{const a=await M(o,e);u(a[0])})()}else i==="quote"?(async()=>{const n=await j(o,d);m(n)})():Math.floor(Math.random()*2)+1===1?(async()=>{const a=Math.floor(Math.random()*5)+1,b=await M(o,a);u(b[0])})():(async()=>{const a=await j(o,d);m(a)})()},[o,d,i]),s.jsxs("div",{onMouseMove:r,onMouseLeave:c,children:[s.jsxs("div",{className:"tooltip-wrap",children:[s.jsx("img",{src:t.largeImageURL,alt:t.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"},onClick:f})," ",p.visible&&s.jsx("span",{className:"tooltip narrow",style:{top:p.y,left:p.x,right:"unset"},children:L[o]})]}),i==="quote"?s.jsx(Q,{quote:l,language:o}):s.jsx(g,{poem:h,language:o})]})},to=({image:t,language:o,show:f,searchTerm:d,textType:i})=>{const p=v(),w=async()=>{if(window.confirm(I[o]+"?")){const r=await fetch(t.largeImageURL,{mode:"cors"});if(!r.ok)throw new Error("Network response was not ok");try{const l=await r.blob(),m=window.URL.createObjectURL(l),h=t.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),u=h?h[1].toLowerCase():"jpg",e=document.createElement("a");e.href=m,e.download=`${E(`${t.id}`)}-${E(t.user)}.${u}`,e.target="_blank",e.rel="noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(m)}catch(l){console.error("Download failed:",l),p(P(`${U[o]}: ${l}`,!0,5))}}},c=()=>{f({title:t.tags,className:x["image-modal"],children:s.jsx(q,{image:t,language:o,handleDownload:w,searchTerm:d,textType:i})})};return s.jsxs("div",{className:`tooltip-wrap ${x["image-wrap"]}`,children:[s.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":k[o],onClick:c,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),c())},children:s.jsx("img",{src:t.webformatURL,alt:t.tags,title:t.tags,loading:"lazy",className:`${x["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:c,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&c()}})}),s.jsx("span",{className:"tooltip above narrow2",children:k[o]}),s.jsx("p",{children:s.jsx("small",{children:s.jsxs("a",{href:t.pageURL,target:"_blank",rel:"noreferrer",children:[R[o]," (",C[o],": ",t.user,")"]})})})]},t.id)};export{to as default};
