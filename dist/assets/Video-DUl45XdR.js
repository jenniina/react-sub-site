import{r as w,j as s}from"./react-kX_YxI4E.js";import{u as v,j4 as O,j5 as L,j2 as C,ah as k,o as y,c9 as E,ck as x,j6 as M,j3 as P}from"./index-D1vQCaOm.js";import{u as _,g}from"./Images-B2E73OIY.js";import{Q as $,P as D,g as Q}from"./poems-Da6X9ZSv.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-DhcENkY1.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const V=({video:o,language:t,searchTerm:l,textType:n,handleDownload:d})=>{const p=v(),{tooltip:a,handleMouseMove:i,handleMouseLeave:u}=_(),[h,c]=w.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[f,r]=w.useState({title:"",author:"",lines:[],linecount:"0"}),j=async e=>{const m=await Q(t,e);r(m[0])},b=async()=>{if(t=k.Suomi){const e=await g(k.English,l);e.quote?c(e.quote):p(y(e.message??E[t],!0,8))}else{const e=await g(t,l);e.quote?c(e.quote):p(y(e.message??E[t],!0,8))}};w.useEffect(()=>{const e=Math.floor(Math.random()*5)+2;n==="poem"?j(e):n==="quote"?b():Math.floor(Math.random()*2)+1===1?j(e):b()},[t,l,n]);const N=e=>{const m=e.currentTarget.getBoundingClientRect(),R=e.clientX-m.left+10,q=e.clientY-m.top+10;i(R,q)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"tooltip-wrap",onMouseMove:N,onMouseLeave:u,children:[s.jsx("video",{src:Number(o.videos.large.size)>0?o.videos.large.url:o.videos.medium.url,title:o.tags,style:{width:"100%",height:"auto",maxHeight:"100%",borderRadius:"8px",cursor:"pointer"},onClick:d,tabIndex:0,onKeyDown:e=>{(e.key==="Enter"||e.key===" ")&&d()},controls:!0}),a.visible&&s.jsx("span",{className:"tooltip center narrow",style:{top:a.y,left:a.x,right:"unset"},children:O[t]})]}),n==="quote"?s.jsx($,{quote:h,language:t,url:o.pageURL,title:s.jsxs(s.Fragment,{children:[L[t]," (",C[t],": ",o.user,")"]})}):s.jsx(D,{poem:f,language:t})]})},io=({video:o,language:t,show:l,searchTerm:n,textType:d})=>{const p=async()=>{if(window.confirm(P[t]+"?")){const i=await fetch(o.videos.large.url,{mode:"cors"});if(!i.ok)throw new Error("Network response was not ok");const u=await i.blob(),h=window.URL.createObjectURL(u),c=o.videos.large.url?o.videos.large.url.match(/\.(mp4)$/i):o.videos.medium.url.match(/\.(mp4)$/i),f=c?c[1].toLowerCase():"mp4",r=document.createElement("a");r.href=h,r.download=`video_${o.id}.${f}`,r.target="_blank",r.rel="noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},a=()=>{l({title:o.tags,className:x["video-modal"],children:s.jsx(V,{video:o,language:t,searchTerm:n,textType:d,handleDownload:p})})};return s.jsxs("div",{className:`tooltip-wrap ${x["video-wrap"]}`,children:[s.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":M[t],onClick:a,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),a())},children:s.jsx("img",{src:o.videos.small.thumbnail,alt:o.tags,className:`${x["video-small"]}`,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"}})}),s.jsx("span",{className:"tooltip above narrow2",children:M[t]}),s.jsx("p",{children:s.jsx("small",{children:s.jsxs("a",{href:o.pageURL,target:"_blank",rel:"noreferrer",children:[L[t]," (",C[t],": ",o.user,")"]})})})]},o.id)};export{io as default};
