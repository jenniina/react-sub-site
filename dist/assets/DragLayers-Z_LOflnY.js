const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DragLayer-CO5-1Js4.js","assets/react-B6RMQhYh.js","assets/dom-to-image-more-sr33WCep.js","assets/main-DlU0Fip1.js","assets/react-dom-DKT7fI1i.js","assets/scheduler-C323NY8X.js","assets/react-redux-CQ4WY322.js","assets/hoist-non-react-statics-C-Qo8PK8.js","assets/react-is-BwqtTtay.js","assets/use-sync-external-store-w3cjJFH7.js","assets/@reduxjs-CJhiLCiq.js","assets/redux-BXkGT1VS.js","assets/immer-BGhKXxrG.js","assets/redux-thunk-ClJT1hhx.js","assets/axios-ngrFHoWO.js","assets/react-icons-CHi_nPWV.js","assets/react-router-dom-_ze6FMLH.js","assets/react-router-hVrguzn3.js","assets/@remix-run-CeDW-7A3.js","assets/react-helmet-async-DQ_5QNst.js","assets/react-fast-compare-BHbKlhN4.js","assets/invariant-B_pwkeTo.js","assets/shallowequal-C7ef0Lra.js","assets/main-DPWMNifH.css"])))=>i.map(i=>d[i]);
import{L as Pe,aA as Ee,_ as Te}from"./main-DlU0Fip1.js";import{a as s,j as L}from"./react-B6RMQhYh.js";import"./react-dom-DKT7fI1i.js";import"./dom-to-image-more-sr33WCep.js";import"./scheduler-C323NY8X.js";import"./react-redux-CQ4WY322.js";import"./hoist-non-react-statics-C-Qo8PK8.js";import"./react-is-BwqtTtay.js";import"./use-sync-external-store-w3cjJFH7.js";import"./@reduxjs-CJhiLCiq.js";import"./redux-BXkGT1VS.js";import"./immer-BGhKXxrG.js";import"./redux-thunk-ClJT1hhx.js";import"./axios-ngrFHoWO.js";import"./react-icons-CHi_nPWV.js";import"./react-router-dom-_ze6FMLH.js";import"./react-router-hVrguzn3.js";import"./@remix-run-CeDW-7A3.js";import"./react-helmet-async-DQ_5QNst.js";import"./react-fast-compare-BHbKlhN4.js";import"./invariant-B_pwkeTo.js";import"./shallowequal-C7ef0Lra.js";const Ce=s.lazy(()=>Te(()=>import("./DragLayer-CO5-1Js4.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])));let V,a=!0,N=0,R=0,w,D=0,S=null,$="90deg",r;const h=g=>{g.preventDefault(),g.stopImmediatePropagation()},rt=({layer_:g,layerAmount:x,hiddenLayers:oe,setActiveLayer:X,changeBlobLayer:z,highestZIndex:_,language:ae,dispatch:u,d:n,items:re,saveDraggables:ne,getPosition:j,dragWrap:le,selectedvalue0:se,exitApp:y,colorBlockProps:Ve,colorPairs:F,makeLarger0:Me,makeSmaller0:Ue,makeMore0:Ie,removeBlob:B,mode:ie,layerIncrease:Ye,layerDecrease:Ne,setFocusedBlob:M,colorIndex:O,setColorIndex:ue,setScroll:de,scroll:v,clickOutsideRef:pe,colorswitch:U,addRandomDraggable:ce,changeColor:fe})=>{const{t:H}=s.useContext(Pe),me=[...re].sort((e,t)=>e.layer-t.layer).reduce((e,t)=>(e[t.layer]||(e[t.layer]=[]),e[t.layer].push(t),e),{}),Z=Array.from({length:x},(e,t)=>t),q=s.useRef({});s.useEffect(()=>{const e=Z.reduce((t,o)=>(t[o]=s.createRef(),t),{});q.current=e},[x]);const l=()=>{try{return document.createEvent("TouchEvent"),!0}catch{return!1}};s.useEffect(()=>{l()},[]);const ye=s.useCallback(e=>{a=!0,document.removeEventListener("keydown",d),document.removeEventListener("touchmove",h)},[d]);Ee({ref:pe,onOutsideClick:ye}),s.useEffect(()=>{l()&&!r&&v&&(document.body.style.overflowY="auto",document.body.style.overflowX="hidden",document.removeEventListener("keydown",d),document.removeEventListener("touchmove",h))},[r,v,l,d]);const ve=s.useCallback((e,t)=>{e.stopPropagation(),e.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur(),V=!0,r=t,N=l()?e.touches[0].clientX:e.clientX,R=l()?e.touches[0].clientY:e.clientY,t.classList.add("drag");const o=_[g];if(l()){let c=(t==null?void 0:t.style.getPropertyValue("--i"))??"10";w=parseFloat(c),w=isNaN(w)?10:w}u({type:"partialUpdate",payload:{d:n,id:t.id,update:{z:`${Math.max(1,o+1)}`}}}),document.addEventListener("keydown",d);const p=t.style.getPropertyValue("--layer");X(isNaN(parseInt(p))?1:parseInt(p)),l()&&(document.addEventListener("touchmove",h,{passive:!1}),document.body.style.overflow="hidden")},[d,l]),be=s.useCallback(e=>{if(e.stopPropagation(),l()&&(e.preventDefault(),document.body.style.overflow="hidden"),V){let t=l()?e.touches[0].clientX:e.clientX,o=l()?e.touches[0].clientY:e.clientY;r.style.top=r.offsetTop-(R-o)+"px",r.style.left=r.offsetLeft-(N-t)+"px",N=t,R=o,u({type:"partialUpdate",payload:{d:n,id:r==null?void 0:r.id,update:{x:r.style.left,y:r.style.top}}})}},[l]),G=s.useCallback((e,t)=>{e.stopPropagation(),e.preventDefault(),V=!1,D++,S&&clearTimeout(S),S=setTimeout(()=>{if(D===2){let o=w-.8;o=Math.max(7,o),u({type:"partialUpdate",payload:{d:n,id:r==null?void 0:r.id,update:{i:o}}})}else if(D===3){let o=w+.8;o=Math.min(36,o),u({type:"partialUpdate",payload:{d:n,id:r==null?void 0:r.id,update:{i:o}}})}D=0},300),document.removeEventListener("keydown",d),t.style.getPropertyValue("--i"),l()&&v?(document.removeEventListener("touchmove",h),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):l()&&!v&&(document.body.style.overflow="hidden"),t.classList.remove("drag"),t.blur(),D===0?r=null:r=t,M(null)},[$,d,v]),J=s.useCallback((e,t)=>{e.stopPropagation(),V=!1,r=null,l()&&v?(document.removeEventListener("touchmove",h),document.body.style.overflowY="auto",document.body.style.overflowX="hidden"):l()&&!v&&(document.body.style.overflow="hidden"),j(t),t.classList.remove("drag"),document.removeEventListener("keydown",d),t.blur()},[d]);s.useEffect(()=>{l()&&!r&&v&&(document.removeEventListener("touchmove",h),document.body.style.overflowY="auto",document.body.style.overflowX="hidden")},[G,J,r,v]);function ge(e){e.classList.remove("drag"),document.removeEventListener("keydown",d),j(e),e.draggable=!1,r=null}function ke(e){r=e,e.classList.add("drag");const t=e.style.getPropertyValue("--layer");X(parseInt(t)??2),document.addEventListener("keydown",d),e.draggable=!0}function we(e){const t=o=>he(o,e);return v||e.addEventListener("wheel",t,{passive:!1}),()=>{e.removeEventListener("wheel",t)}}function he(e,t){if(a){a=!1;let p=window.getComputedStyle(t).getPropertyValue("--i")??t.style.getPropertyValue("--i")??"10",c=parseFloat(p);c=isNaN(c)?10:c,e.deltaY<0?c*=1.04:c*=.96,c=Math.min(Math.max(7,c),36),u({type:"partialUpdate",payload:{d:n,id:t.id,update:{i:c}}}),setTimeout(()=>{a=!0},100)}}s.useEffect(()=>{const e=r;if(e){const{color1:t,color2:o}=F[n][O],p=`linear-gradient(${$}, ${t}, ${o})`;u({type:"partialUpdate",payload:{d:n,id:e.id,update:{background:p}}})}},[O]);function d(e){var W,A;const o=r;if(!o)return;const p=window.getComputedStyle(o),c=m=>{var te;const b=parseFloat(p.marginTop),Y=parseFloat(p.marginLeft),C=m.getBoundingClientRect(),ee=(te=m.parentNode)==null?void 0:te.getBoundingClientRect();M({top:C.top-ee.top-b,left:C.left-ee.left-Y,width:C.width,height:C.height})};let Q=p.getPropertyValue("--i")??o.style.getPropertyValue("--i")??"10",f=parseFloat(Q);f=isNaN(f)?10:f;let P=parseFloat(p.getPropertyValue("left"))??parseFloat(o.style.getPropertyValue("left"))??0,E=parseFloat(p.getPropertyValue("top"))??parseFloat(o.style.getPropertyValue("top"))??0;const De=o.style.getPropertyValue("--layer"),k={layer:parseInt(De)??g,id:o.id,number:parseInt(o.id.replace("blob","").split("-")[0],10),i:f,x:o.style.getPropertyValue("left").toString(),y:o.style.getPropertyValue("top").toString(),z:o.style.zIndex??"0",background:o.style.background??"linear-gradient(90deg, cyan, greenyellow)"},T=(m,b)=>{u({type:"partialUpdate",payload:{d:n,id:o.id,update:{x:`${m}px`,y:`${b}px`}}}),c(o)},i=()=>{a=!0},xe=m=>{e.preventDefault(),a&&(a=!1,z(k,m),setTimeout(i,100))},I=e.key;switch(parseInt(I)>=1&&parseInt(I)<=x&&xe(parseInt(I)-1),e.key){case"ArrowLeft":e.preventDefault(),a&&(T(P-4,E),setTimeout(i,100));break;case"ArrowRight":e.preventDefault(),a&&(T(P+4,E),setTimeout(i,100));break;case"ArrowUp":e.preventDefault(),a&&(T(P,E-4),setTimeout(i,100));break;case"ArrowDown":e.preventDefault(),a&&(T(P,E+4),setTimeout(i,100));break;case"Escape":e.preventDefault(),de(!0),document.body.style.overflowY="auto",document.body.style.overflowX="hidden",y.current&&(y.current.setAttribute("tabindex","0"),y.current.addEventListener("blur",K)),o.blur(),(W=le.current)==null||W.blur(),y.current&&(y.current.textContent=H("ThankYouForPlaying")),(A=y.current)==null||A.focus();break;case"Enter":e.preventDefault(),e.stopPropagation(),a&&(a=!1,o.closest(`#drag-wrap${n}`)&&ue(m=>(m+1)%F[n].length),setTimeout(i,100));break;case"R":case"r":case" ":if(e.preventDefault(),e.stopPropagation(),a){if(a=!1,o.closest(`#drag-wrap${n}`)){const m=U();let b=U();b===m&&(b=U());const Y=`linear-gradient(${$}, ${m}, ${b})`;u({type:"partialUpdate",payload:{d:n,id:o.id,update:{background:Y}}})}setTimeout(i,100)}break;case"Z":case"z":e.preventDefault(),a&&(a=!1,u({type:"partialUpdate",payload:{d:n,id:o.id,update:{z:"0"}}}),setTimeout(i,100));break;case"T":case"t":e.preventDefault(),a&&(a=!1,u({type:"partialUpdate",payload:{d:n,id:o.id,update:{z:`${Math.max(1,_[g]+1)}`}}}),setTimeout(i,100));break;case"S":case"s":e.preventDefault(),a&&(a=!1,f-=.4,f=Math.min(Math.max(7,f),36),u({type:"partialUpdate",payload:{d:n,id:o.id,update:{i:f}}}),setTimeout(i,100));break;case"B":case"b":case"L":case"l":e.preventDefault(),a&&(a=!1,f+=.4,f=Math.min(Math.max(7,f),36),u({type:"partialUpdate",payload:{d:n,id:o.id,update:{i:f}}}),setTimeout(i,100));break;case"C":case"c":case"D":case"d":e.preventDefault(),a&&(a=!1,Le(k),setTimeout(i,100));break;case"+":e.preventDefault(),a&&(a=!1,ce(k.x,k.y,k.layer),setTimeout(i,200));break;case"Delete":case"-":e.preventDefault(),a&&(a=!1,B(k),setTimeout(i,100));break}}function K(){var e,t;y.current&&((e=y.current)==null||e.removeAttribute("tabindex"),(t=y.current)==null||t.removeEventListener("blur",K),y.current.textContent="")}function Le(e){u({type:"duplicateDraggable",payload:{d:n,draggable:e}})}return L.jsx(L.Fragment,{children:Z.map((e,t)=>L.jsx(s.Suspense,{fallback:L.jsxs("div",{className:"flex center margin0auto textcenter",children:[H("Loading"),"..."]}),children:L.jsx(Ce,{layer_:e,dragUlRef:q.current[e],items:me[e]||[],className:oe.has(e)?"hidden":"",language:ae,d:n,saveDraggables:ne,selectedvalue0:se,setFocusedBlob:M,start:ve,movement:be,stopMovementCheck:G,stopMoving:J,wheel:we,focused:ke,blurred:ge,removeBlob:B,mode:ie,changeBlobLayer:z,layerAmount:x,changeColor:fe},e)},t))})};export{rt as default};
