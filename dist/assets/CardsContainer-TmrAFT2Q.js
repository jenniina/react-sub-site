import{r as p,j as r}from"./react-kX_YxI4E.js";import{L as Q,u as _,az as H,aA as i,aB as d,e as y,A as V}from"./index-DHq7Rhtm.js";import{M as W,aP as X,aQ as Y}from"./react-icons-CzVo0GbG.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";function Z({language:E,status:a,statuses:m,id:u,index:g,data:n,handleDragging:N,handleUpdate:x,handleRemoveColor:A,setTheTarget:L,focusedCard:O,setFocusedCard:j,translateStatus:S}){const{t:l}=p.useContext(Q),h=_(),I={backgroundColor:n==null?void 0:n.color,padding:"0.3em 5%",color:(n==null?void 0:n.lightness)=="dark"?"white":"black",borderColor:(n==null?void 0:n.lightness)=="dark"?"var(--color-gray-7)":"var(--color-gray-5)",textShadow:(n==null?void 0:n.lightness)=="dark"?"1px 1px 1px black":"1px -1px 3px rgba(255,255,255,0.6), -1px 1px 3px rgba(255,255,255,0.6)"},R={color:"var(--color-primary-20)",textShadow:"none"},M={margin:"0 auto 0.3em",display:"block",width:"max-content",fontSize:"0.9em"},[v,b]=p.useState(!1);function k(){b(e=>!e)}function F(){b(!1)}const C=p.useRef(null);H({ref:C,onOutsideClick:F});const $=p.useRef(0),J=(e,o)=>{e.preventDefault(),L(o),$.current=o},D=e=>{N(!0),e.preventDefault()},P=(e,o)=>{e.dataTransfer.setData("text/plain",JSON.stringify({type:"item",id:n==null?void 0:n.id}))};function z(e){const o=e.target.closest("a[data-status]"),t=o==null?void 0:o.dataset.status;n&&t&&x(n.id,t)}function K(e){switch(e.code){case"Enter":case"Space":e.stopPropagation(),e.preventDefault();const o=e.target.closest("a[data-status]"),t=(o==null?void 0:o.dataset.status)??a;n&&x(n.id,t),b(s=>!s);break;case"Escape":e.stopPropagation(),e.preventDefault(),b(!1);break}}const q=(e,o)=>{var w,T;const t=e.target.closest("li");let s;t?s=t:s=e.target;const c=Number((w=s==null?void 0:s.previousElementSibling)==null?void 0:w.dataset.identity),f=Number((T=s==null?void 0:s.nextElementSibling)==null?void 0:T.dataset.identity);switch(e.key){case"ArrowUp":n&&c!==null&&(e.preventDefault(),x(o,n.status,c),j(o));break;case"ArrowDown":n&&f!==null&&(e.preventDefault(),x(o,n.status,f),j(o));break;case"Tab":j(null)}};p.useEffect(()=>{var e;O===u&&((e=C.current)==null||e.focus())},[O,u]);const G=e=>{var o,t,s;if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(e).then(()=>{h(y(l("CopiedToClipboard"),!1,3))},c=>{h(y(`${l("FailedToCopy")}`,!0,3))});else{const c=document.createElement("textarea");c.value=e,(o=C.current)==null||o.appendChild(c),c.focus(),c.select();try{document.execCommand("copy"),h(y(l("CopiedToClipboard"),!1,3))}catch(f){(s=(t=f.response)==null?void 0:t.data)!=null&&s.message?h(y(f.response.data.message,!0,8)):h(y(`${l("FailedToCopy")}`,!0,3))}document.body.removeChild(c)}};return r.jsx("li",{ref:C,draggable:"true",onDragStart:e=>P(e),onDragEnter:e=>J(e,u),onDragOver:e=>D(e),onDragEnd:()=>N(!1),role:"listitem",tabIndex:0,onKeyDown:e=>q(e,u),"data-identity":u,children:r.jsxs("div",{style:I,className:`${i.card}`,children:[r.jsx("span",{className:i.text,children:n==null?void 0:n.content}),r.jsxs("b",{children:[r.jsx("button",{onClick:()=>A(n.content),children:"Ã—"}),r.jsxs("button",{"aria-haspopup":"true",onClick:k,children:[r.jsx(W,{"aria-hidden":"true"}),r.jsx("span",{className:"scr",id:`instructions${u}`,children:l("ChooseDestination")})]})]}),r.jsxs("nav",{className:v?`${i.open} ${i.blur}`:`${i.blur}`,style:R,children:[r.jsxs("span",{style:M,children:[l("Move"),":"]}),r.jsxs("ul",{role:"listbox","aria-describedby":`instructions${u}`,"aria-expanded":v?"true":"false",className:d(a),children:[r.jsx("li",{role:"option",className:i.copy,children:r.jsxs("a",{className:i.copy,onClick:()=>G(n.content),tabIndex:0,title:l("CopyToClipboard"),children:[r.jsx(X,{}),r.jsx("i",{children:l("CopyText")})]})}),m.map((e,o)=>r.jsx("li",{role:"option",className:d(e),children:r.jsxs("a",{className:d(e),"data-status":e,onClick:t=>z(t),onKeyDown:t=>K(t),tabIndex:0,title:`${l("ToTarget")}: ${S(e).toLowerCase()}`,children:[r.jsx(Y,{}),r.jsx("i",{children:S(e)})]})},`${d(e)}-${o}-${g}`))]})]})]})})}const he=({language:E,status:a,statuses:m,isDragging:u,handleDragging:g,handleUpdate:n,handleRemoveColor:N,itemsByStatus:x,lightTheme:A,updateStatus:L,reorderStatuses:O,deleteStatus:j,regex:S})=>{const{t:l}=p.useContext(Q),h=_(),[I,R]=p.useState(0),[M,v]=p.useState(!1),[b,k]=p.useState(""),[F,C]=p.useState(null),$=p.useRef(null),[J,D]=p.useState(!1),P=t=>{D(!0);const s=t.target.value;S.test(s)?(k(s),D(!1)):(h(y(l("SpecialCharactersNotAllowed"),!0,6)),D(!1))};H({ref:$,onOutsideClick:()=>v(!1)});const z=t=>{const s=JSON.parse(t.dataTransfer.getData("text/plain"));s.type==="item"&&(n(s.id,a,I),g(!1))},K=t=>t.preventDefault(),q=(t,s)=>{t.dataTransfer.setData("text/plain",JSON.stringify({type:"span",id:s.toString()})),g(!0)},G=t=>{t.stopPropagation(),t.preventDefault()},e=(t,s)=>{t.preventDefault();const c=JSON.parse(t.dataTransfer.getData("text/plain"));if(c.type==="span"){const f=c.id;if(f!==s){const w=Array.from(m),[T]=w.splice(f,1);w.splice(s,0,T),O(f,s)}g(!1)}},o=t=>{switch(t.toLowerCase()){case"good":return l("Good");case"bad":return l("Bad");case"neutral":return l("Neutral");default:return t.replace(/_/g," ")}};return r.jsxs("div",{className:`${i["cards-container"]} ${u?i["area-dragging"]:""} ${A?i.light:""}`,onDrop:t=>e(t,m.indexOf(a)),onDragEnd:()=>g(!1),children:[r.jsxs("span",{ref:$,id:`label-${d(a)}`,className:i["status-label"],draggable:!0,onDragStart:t=>q(t,m.indexOf(a)),onDragOver:G,children:[r.jsx("b",{children:o(a)}),r.jsx(V,{isOpen:M,setIsFormOpen:v,language:E,text:"*",hideBrackets:!0,onClick:()=>k(a),className:`narrow2 ${i["change-status"]} change-status`,wrapperClass:"change-status-wrap",tooltip:l("Edit"),x:"left",y:"below",children:r.jsxs(r.Fragment,{children:[r.jsx("i",{children:o(a)}),r.jsxs("form",{className:i["change-status-form"],onSubmit:t=>{t.preventDefault(),L(m.indexOf(a),b)},children:[r.jsx("div",{className:"input-wrap",children:r.jsxs("label",{htmlFor:`${d(a)}-status`,children:[r.jsx("input",{type:"text",required:!0,id:`${d(a)}-status`,value:b,onChange:t=>P(t)}),r.jsxs("span",{children:[l("Change"),":"]})]})}),r.jsx("button",{type:"submit",disabled:J,children:l("Change")}),r.jsx("button",{type:"button",className:"danger delete",onClick:()=>{j(a)},children:l("Delete")})]})]})})]}),r.jsx("ul",{"aria-labelledby":`label-${d(a)}`,id:d(a),className:d(a),role:"list",onDrop:z,onDragOver:K,children:x==null?void 0:x.map((t,s)=>r.jsx(Z,{language:E,id:t.id,index:s,data:t,status:a,statuses:m,handleDragging:g,handleUpdate:n,handleRemoveColor:N,setTheTarget:R,focusedCard:F,setFocusedCard:C,translateStatus:o},`${d(a)}-item-${t.id}-${s}`))})]})};export{he as default};
