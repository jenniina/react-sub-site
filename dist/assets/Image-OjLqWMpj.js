import{r as y,j as s}from"./react-A9DAvxly.js";import{gD as h,iK as L,iL as j,K as v,iM as k,iN as R,i2 as $,b0 as g,ba as M,W as C,bd as I}from"./index-BM0FeXIF.js";import{u as P}from"./Images-aFKTQNNs.js";import{Q as U,P as D,g as E}from"./poems-C13bxqB6.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./react-dom-CxfJ6lHP.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-C4cSaZU-.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-DEc9BFqZ.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-RHjzyHVQ.js";import"./react-router-dom-CYs6befe.js";import"./react-router-S1Hdk0kP.js";import"./@remix-run-DTnHqtaE.js";const N=({image:t,language:o,handleDownload:w,searchTerm:d,textType:i})=>{const{tooltip:p,handleMouseMove:b,handleMouseLeave:c}=P(),r=e=>{const n=e.currentTarget.getBoundingClientRect(),a=e.clientX-n.left+10,x=e.clientY-n.top+10;b(a,x)},[l,m]=y.useState({quote:"",category:"",author:""}),[u,f]=y.useState({title:"",author:"",lines:[],linecount:"0"});return y.useEffect(()=>{if(i==="poem"){const e=Math.floor(Math.random()*5)+1;(async()=>{const a=await E(o,e);f(a[0])})()}else i==="quote"?(async()=>{const n=await j(o,d);m(n)})():Math.floor(Math.random()*2)+1===1?(async()=>{const a=Math.floor(Math.random()*5)+1,x=await E(o,a);f(x[0])})():(async()=>{const a=await j(o,d);m(a)})()},[o,d,i]),s.jsxs("div",{onMouseMove:r,onMouseLeave:c,children:[s.jsxs("div",{className:`tooltip-wrap ${h["image-wrap"]} ${h["image-modal"]}`,children:[s.jsxs("button",{onClick:w,children:[s.jsx("img",{src:t.largeImageURL,alt:t.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),p.visible&&s.jsx("span",{className:"tooltip narrow",style:{top:p.y,left:p.x,right:"unset"},children:L[o]})]}),i==="quote"?s.jsx(U,{quote:l,language:o}):s.jsx(D,{poem:u,language:o})]})},to=({image:t,language:o,show:w,searchTerm:d,textType:i})=>{const p=v(),b=async()=>{if(window.confirm(g[o]+"?")){const r=await fetch(t.largeImageURL,{mode:"cors"});if(!r.ok)throw new Error("Network response was not ok");try{const l=await r.blob(),m=window.URL.createObjectURL(l),u=t.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),f=u?u[1].toLowerCase():"jpg",e=document.createElement("a");e.href=m,e.download=`${M(`${t.id}`)}-${M(t.user)}.${f}`,e.target="_blank",e.rel="noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(m)}catch(l){console.error("Download failed:",l),p(C(`${I[o]}: ${l}`,!0,5))}}},c=()=>{w({title:t.tags,className:h["image-modal"],children:s.jsx(N,{image:t,language:o,handleDownload:b,searchTerm:d,textType:i})})};return s.jsxs("div",{className:`tooltip-wrap ${h["image-wrap"]}`,children:[s.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":k[o],onClick:c,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),c())},children:s.jsx("img",{src:t.webformatURL,alt:t.tags,title:t.tags,loading:"lazy",className:`${h["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:c,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&c()}})}),s.jsx("span",{className:"tooltip above narrow2",children:k[o]}),s.jsx("p",{children:s.jsx("small",{children:s.jsxs("a",{href:t.pageURL,target:"_blank",rel:"noreferrer",children:[R[o]," (",$[o],": ",t.user,")"]})})})]},t.id)};export{to as default};
