import{a as f,j as t}from"./react-B6RMQhYh.js";import{L as v,u as R,O as w,E as C,e as b,q as $,aC as M}from"./index-DE35o7R3.js";import{u as q,g as L}from"./Images-pEINb0Df.js";import{Q as I,P as O,g as E}from"./poems-CZ9ZYajJ.js";import"./dom-to-image-more-sr33WCep.js";import"./react-dom-DKT7fI1i.js";import"./scheduler-C323NY8X.js";import"./react-redux-CQ4WY322.js";import"./hoist-non-react-statics-C-Qo8PK8.js";import"./react-is-BwqtTtay.js";import"./use-sync-external-store-w3cjJFH7.js";import"./@reduxjs-CJhiLCiq.js";import"./redux-BXkGT1VS.js";import"./immer-BGhKXxrG.js";import"./redux-thunk-ClJT1hhx.js";import"./axios-ngrFHoWO.js";import"./react-icons-CHi_nPWV.js";import"./react-router-dom-_ze6FMLH.js";import"./react-router-hVrguzn3.js";import"./@remix-run-CeDW-7A3.js";import"./react-helmet-async-BlGJtXmD.js";import"./react-fast-compare-BHbKlhN4.js";import"./invariant-B_pwkeTo.js";import"./shallowequal-C7ef0Lra.js";const P=({image:o,language:a,handleDownload:j,searchTerm:c,textType:l})=>{const{t:r}=f.useContext(v),u=R(),{tooltip:h,handleMouseMove:y,handleMouseLeave:m}=q(),n=e=>{const s=e.currentTarget.getBoundingClientRect(),i=e.clientX-s.left+10,k=e.clientY-s.top+10;y(i,k)},[p,d]=f.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[g,x]=f.useState({title:"",author:"",lines:[],linecount:"0"});return f.useEffect(()=>{if(l==="poem"){const e=Math.floor(Math.random()*5)+1;(async()=>{const i=await E(a,e);x(i[0])})()}else l==="quote"?(async()=>{if(a=C.fi){const s=await L(C.en,c);s.quote?d(s.quote):u(b(s.message??r("Error"),!0,8))}else{const s=await L(a,c);s.quote?d(s.quote):u(b(s.message??r("Error"),!0,8))}})():Math.floor(Math.random()*2)+1===1?(async()=>{const i=Math.floor(Math.random()*5)+1,k=await E(a,i);x(k[0])})():(async()=>{const i=await L(a,c);i.quote?d(i.quote):u(b(i.message??r("Error"),!0,8))})()},[a,c,l]),t.jsxs("div",{onMouseMove:n,onMouseLeave:m,children:[t.jsxs("div",{className:`tooltip-wrap ${w["image-wrap"]} ${w["image-modal"]}`,children:[t.jsxs("button",{onClick:j,className:"reset",children:[t.jsx("img",{src:o.largeImageURL,alt:o.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),h.visible&&t.jsx("span",{className:"tooltip narrow",style:{top:h.y,left:h.x,right:"unset"},children:r("ClickToLoadImage")})]}),l==="quote"?t.jsx(I,{quote:p,language:a}):t.jsx(O,{poem:g,language:a})]})},ro=({image:o,language:a,show:j,searchTerm:c,textType:l})=>{const{t:r}=f.useContext(v),u=$(),h=R(),y=async()=>{if(await u({message:r("Download")+"?"})){const n=await fetch(o.largeImageURL,{mode:"cors"});if(!n.ok)throw new Error("Network response was not ok");try{const p=await n.blob(),d=window.URL.createObjectURL(p),g=o.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),x=g?g[1].toLowerCase():"jpg",e=document.createElement("a");e.href=d,e.download=`${M(`${o.id}`)}-${M(o.user)}.${x}`,e.target="_blank",e.rel="noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(d)}catch(p){console.error("Download failed:",p),h(b(`${r("Error")}: ${p}`,!0,5))}}},m=()=>{j({title:o.tags,className:w["image-modal"],children:t.jsx(P,{image:o,language:a,handleDownload:y,searchTerm:c,textType:l})})};return t.jsxs("div",{className:`tooltip-wrap ${w["image-wrap"]}`,children:[t.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":r("ClickToOpenLargeImage"),onClick:m,onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),m())},children:t.jsx("img",{src:o.webformatURL,alt:o.tags,title:o.tags,loading:"lazy",className:`${w["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:m,onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&m()}})}),t.jsx("span",{className:"tooltip above narrow2",children:r("ClickToOpenLargeImage")}),t.jsx("p",{children:t.jsx("small",{children:t.jsxs("a",{href:o.pageURL,target:"_blank",rel:"noreferrer",children:[r("ImagePage")," (",r("Author"),": ",o.user,")"]})})})]},o.id)};export{ro as default};
