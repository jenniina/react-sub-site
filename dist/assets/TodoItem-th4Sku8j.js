import{a as i,j as a}from"./react-B6RMQhYh.js";import{L as ee,l as ie,aS as J,ak as r,S as X,aC as x,aT as F,I as te,q as ce,u as me,e as Z}from"./main-DlU0Fip1.js";import{bi as ue,bj as he,bk as pe,bl as xe,bm as fe,bn as ge,bo as je,bp as be,bq as Ne,br as de,bs as we}from"./react-icons-CHi_nPWV.js";import{a as ye}from"./react-dom-DKT7fI1i.js";import"./dom-to-image-more-sr33WCep.js";import"./react-redux-CQ4WY322.js";import"./hoist-non-react-statics-C-Qo8PK8.js";import"./react-is-BwqtTtay.js";import"./use-sync-external-store-w3cjJFH7.js";import"./@reduxjs-CJhiLCiq.js";import"./redux-BXkGT1VS.js";import"./immer-BGhKXxrG.js";import"./redux-thunk-ClJT1hhx.js";import"./axios-ngrFHoWO.js";import"./react-router-dom-_ze6FMLH.js";import"./react-router-hVrguzn3.js";import"./@remix-run-CeDW-7A3.js";import"./react-helmet-async-DQ_5QNst.js";import"./react-fast-compare-BHbKlhN4.js";import"./invariant-B_pwkeTo.js";import"./shallowequal-C7ef0Lra.js";import"./scheduler-C323NY8X.js";const o=te(6),De=({todo:e,language:m,priorityOptions:$,categoryOptions:y,handleModify:q,sending:R,newCategory:Q,newPriority:L,setNewPriority:z,setNewCategory:B,showDeadline:D,setShowDeadline:W,title:H,newName:s,setNewName:U,newDay:d,setNewDay:f,newMonth:g,setNewMonth:P,newYear:w,setNewYear:C,setIsOpen:K,maxCharacters:S})=>{const{t:l}=i.useContext(ee),[k,u]=i.useState(null),Y=n=>{U(n.target.value)},I=n=>{Number(n)<=31&&n.length<=2?(f(n),u(null)):u(`${l("Set")}: ${l("Day")}`)},O=n=>{Number(n)<=12&&n.length<=2?(P(n),u(null)):u(`${l("Set")}: ${l("Month")}`)},_=n=>{const h=n.target.value;Number(h)<=Number(new Date().getFullYear())+10&&h.length<=4?(C(h),u(null)):u(l("YearMustBeBetweenCurrentYearAnd10YearsFromNow"))};i.useEffect(()=>{if(d&&g&&w){const n=new Date(Number(w),Number(g)-1,Number(d)),h=new Date;h.setHours(0,0,0,0),u(null),n<h&&u(l("TheDateIsInThePast"))}},[d,g,w,m]),i.useEffect(()=>{D?(d||f((new Date().getDate()+1).toString().padStart(2,"0")),g||P((new Date().getMonth()+1).toString().padStart(2,"0")),w||C(new Date().getFullYear().toString())):(f(""),P(""),C(""))},[D]);const T=i.useRef(null),j=i.useRef(null);i.useEffect(()=>{var h;j.current=document.activeElement,(h=T.current)==null||h.focus();const n=b=>{var N,A;if(b.key==="Tab"){const c=(A=(N=T.current)==null?void 0:N.parentElement)==null?void 0:A.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(!c||c.length===0){b.preventDefault();return}const v=c==null?void 0:c[0],M=c==null?void 0:c[c.length-1];b.shiftKey?document.activeElement===v&&(b.preventDefault(),M==null||M.focus()):document.activeElement===M&&(b.preventDefault(),v==null||v.focus())}else b.key==="Escape"&&p()};return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n),j.current?j.current.focus():document.body.focus()}},[T.current]);const p=()=>{K(!1),j.current?j.current.focus():document.body.focus()},G=ie();return ye.createPortal(a.jsx("div",{className:`${J["modal-overlay"]} ${G?r.light:""}`,onClick:p,children:a.jsxs("div",{className:`${J["modal-content"]} ${r["todo-modal"]}`,onClick:n=>n.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":H??"Task",children:[a.jsxs("button",{ref:T,className:`${J["close-button"]} tooltip-wrap`,onClick:p,children:[a.jsx("span",{"aria-hidden":"true",children:"×"}),a.jsx("span",{className:"scr",children:l("Close")}),a.jsx("span",{"aria-hidden":"true",className:"tooltip below left narrow2",children:l("Close")})]}),a.jsx("h2",{children:l("Edit")}),a.jsxs("form",{onSubmit:q,className:`${r.modify}`,children:[a.jsx(X,{id:`category_${x(F((e==null?void 0:e.name)??o,m))}`,className:`${r.select} ${r["category-select"]}`,value:y==null?void 0:y.find(n=>n.value===Q),onChange:n=>B(n==null?void 0:n.value),options:y,instructions:l("SelectCategory"),language:m,hideDelete:!0,z:3}),a.jsx(X,{id:`priority_${x(F((e==null?void 0:e.name)??o,m))}`,className:`${r.select}`,value:$==null?void 0:$.find(n=>n.value===L),onChange:n=>z(n==null?void 0:n.value),options:$,instructions:l("Priority"),language:m,hideDelete:!0,z:2}),a.jsxs("fieldset",{className:`${r.fieldset} ${r["deadline-wrap"]}`,children:[a.jsx("legend",{children:a.jsxs("label",{children:[l("Deadline")," ",a.jsx("input",{style:{marginLeft:"0.5em"},type:"checkbox",checked:D,onChange:()=>W(!D)})]})}),D&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:r["deadline-inputs"],children:[a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`day_${x(F((e==null?void 0:e.name)??l("Task"),m))}`,children:l("Day")}),a.jsx("input",{type:"number",id:`day_${x((e==null?void 0:e.name)||"Task")}`,name:"day",min:1,max:31,value:d,placeholder:"DD",onChange:n=>I(n.target.value),required:!0,className:"bg"})]}),a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`month_${x((e==null?void 0:e.name)||"Task")}`,children:l("Month")}),a.jsx("input",{type:"number",id:`month_${x(F((e==null?void 0:e.name)??l("Task"),m))}`,name:"month",min:1,max:12,value:g,placeholder:"MM",onChange:n=>O(n.target.value),required:!0,className:"bg"})]}),a.jsxs("div",{className:r.input,children:[a.jsx("label",{className:"scr",htmlFor:`year_${x((e==null?void 0:e.name)||"Task")}`,children:l("Year")}),a.jsx("input",{type:"number",id:`year_${x(F((e==null?void 0:e.name)??l("Task"),m))}`,name:"year",min:new Date().getFullYear(),max:new Date().getFullYear()+10,value:w,placeholder:"YYYY",onChange:n=>_(n),required:!0,className:"bg"})]})]})," ",k&&a.jsx("p",{className:r.error,children:k})]})]}),a.jsxs("fieldset",{className:`${r.fieldset} ${r.textarea}`,children:[a.jsx("legend",{children:l("Task")}),a.jsxs("label",{children:[a.jsx("textarea",{id:`task_${x(e==null?void 0:e.name)}`,required:!0,name:"task",rows:4,value:s,onChange:Y}),a.jsxs("p",{className:r.small,children:[S-s.length," ",l("CharactersLeft")," (",l("Max"),":"," ",S,")"," ",s.length>S&&a.jsx("span",{className:r.warning,children:l("NameTooLong")})]}),a.jsxs("span",{className:"scr",children:[l("Edit")," ",F((e==null?void 0:e.name)??l("Task"),m)]})]})]}),a.jsxs("button",{type:"submit",disabled:R,className:"modify",children:[l("Confirm")," ",a.jsx(ue,{})]}),a.jsxs("button",{onClick:p,className:`reset ${r.cancel}`,type:"button",children:[l("Cancel")," ",a.jsx(he,{})]})]})]})}),document.getElementById("modal-root"))};function Ke({todo:e,toggleTodo:m,deleteTodo:$,language:y,modifyTodo:q,isDragging:R,handleUpdate:Q,handleDragging:L,sending:z,priorityOptions:B,categoryOptions:D,zin:W,maxCharacters:H}){const{t:s}=i.useContext(ee),U=ce(),d=me(),[f,g]=i.useState((e==null?void 0:e.name)??""),[P,w]=i.useState(!1),[C,K]=i.useState((e==null?void 0:e.priority)||"low"),[S,l]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getDate().toString().padStart(2,"0"):""),[k,u]=i.useState(e!=null&&e.deadline?(new Date(e.deadline).getMonth()+1).toString().padStart(2,"0"):""),[Y,I]=i.useState(e!=null&&e.deadline?new Date(e.deadline).getFullYear().toString():""),O=S&&k&&Y?`${Y}-${k}-${S}`:"",[_,T]=i.useState((e==null?void 0:e.category)||"other"),[j,p]=i.useState(!1);function G(){m(e==null?void 0:e.key)}async function n(){await U({message:s("AreYouSureYouWantToDelete")+' "'+(e==null?void 0:e.name)+'"?'})&&(g(""),$(e==null?void 0:e.key),p(!1))}const h=t=>{if(t.preventDefault(),f===""){d(Z(s("AddTask"),!0,5));return}if(f.length>H){d(Z(s("NameTooLong"),!0,5));return}q(e==null?void 0:e.key,f,C,O,_),p(!1)};i.useEffect(()=>{e!=null&&e.deadline&&w(!0)},[e]),i.useEffect(()=>{if((e==null?void 0:e.name)!==f&&g((e==null?void 0:e.name)||""),e!=null&&e.deadline){const t=new Date(e.deadline);l(t.getDate().toString().padStart(2,"0")),u((t.getMonth()+1).toString().padStart(2,"0")),I(t.getFullYear().toString())}},[e]);const[b,N]=i.useState(!0),[A,c]=i.useState(!1),v=()=>{N(!0),c(!1)},M=()=>{N(!0)},ae=()=>{N(!1)},se=()=>{N(!1),c(!0)},ne=()=>{var t;(t=window.getSelection())!=null&&t.toString()?(N(!1),c(!0)):(N(!0),c(!1))},re=t=>{A&&t.preventDefault()};return a.jsx(a.Fragment,{children:a.jsxs("li",{style:{zIndex:`calc(${W} - ${e==null?void 0:e.order})`},className:`${R?"dragging":""} ${j?r.open:r.closed}`,draggable:b,onDragStart:t=>{var E;b?(t.dataTransfer.setData("application/my-app",(E=e==null?void 0:e.order)==null?void 0:E.toString()),L(!0)):t.preventDefault()},onDragEnd:()=>L(!1),children:[a.jsxs("span",{onMouseOver:M,onMouseDown:v,className:`${r["drag-handle"]} tooltip-wrap`,children:[a.jsx(pe,{}),a.jsx("span",{className:"tooltip narrow2 below right",children:s("Draggable")})]}),a.jsxs("label",{onClick:re,children:[a.jsx("input",{type:"checkbox",id:`check_${x(e==null?void 0:e.name)}`,checked:(e==null?void 0:e.complete)??!1,onChange:G}),a.jsx("span",{onMouseOver:ae,onMouseDown:se,onMouseUp:ne,children:e==null?void 0:e.name}),a.jsx("div",{className:`${r["more-info-wrap"]}`,children:(e==null?void 0:e.deadline)&&(e==null?void 0:e.deadline)!==""&&(()=>{const t=new Date(e.deadline),E=new Date;t.setHours(0,0,0,0),E.setHours(0,0,0,0);const le=t<E,V=t.getTime()===E.getTime();return a.jsxs("span",{className:`${r.deadline} ${le?r.overdue:""} ${V?r.today:""}`,children:[s("Deadline"),":"," ",V?s("Today"):new Date(e.deadline).toLocaleDateString(y,{year:"numeric",month:"long",day:"numeric"})]})})()})]}),a.jsxs("div",{className:`${r["btn-wrap"]}`,children:[(e==null?void 0:e.priority)==="high"?a.jsxs("b",{className:`tooltip-wrap ${r.high}`,children:[a.jsx(xe,{}),a.jsxs("span",{className:"scr",children:[s("Priority"),": ",s("High")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("Priority"),": ",s("High")]})]}):(e==null?void 0:e.priority)==="medium"?a.jsxs("b",{className:`tooltip-wrap ${r.medium}`,children:[a.jsx(fe,{}),a.jsxs("span",{className:"scr",children:[s("Priority"),": ",s("Medium")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("Priority"),": ",s("Medium")]})]}):(e==null?void 0:e.priority)==="low"?a.jsxs("b",{className:`tooltip-wrap ${r.low}`,children:[a.jsx(ge,{viewBox:"0 0 17 17"}),a.jsxs("span",{className:"scr",children:[s("Priority"),": ",s("Low")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("Priority"),": ",s("Low")]})]}):a.jsx(a.Fragment,{children:" "}),(e==null?void 0:e.category)==="personal"?a.jsxs("b",{className:`tooltip-wrap ${r.cat}`,children:[a.jsx(je,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Personal")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Personal")]})]}):(e==null?void 0:e.category)==="work"?a.jsxs("b",{className:`tooltip-wrap ${r.cat} ${r.bg}`,children:[a.jsx(be,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Work")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Work")]})]}):(e==null?void 0:e.category)==="shopping"?a.jsxs("b",{className:`tooltip-wrap ${r.cat} ${r.bg}`,children:[a.jsx(Ne,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Shopping")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Shopping")]})]}):a.jsxs("b",{className:`tooltip-wrap ${r.cat}`,children:[a.jsx(de,{}),a.jsxs("span",{className:"scr",children:[s("CategoryTitle"),": ",s("Other")]}),a.jsxs("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:[s("CategoryTitle"),": ",s("Other")]})]}),a.jsxs("button",{onClick:()=>p(!0),className:`${r.edit} tooltip-wrap`,disabled:(e==null?void 0:e.complete)??!1,children:[a.jsx(we,{}),a.jsx("span",{className:"scr",children:s("Edit")}),a.jsx("span",{className:"tooltip narrow2 below left","aria-hidden":"true",children:s("Edit")})]}),a.jsxs("button",{className:`${r.delete} tooltip-wrap`,onClick:j?()=>p(!1):n,children:[a.jsx("span",{className:r["delete-inner"],"aria-hidden":"true",children:"×"}),a.jsx("span",{className:"scr",children:s("DeleteTask")}),a.jsx("span",{className:"tooltip below left narrow2","aria-hidden":"true",children:s("DeleteTask")})]})]}),j&&a.jsx(De,{title:e==null?void 0:e.name,language:y,handleModify:h,newName:f,setNewName:g,newPriority:C,setNewPriority:K,newDay:S,setNewDay:l,newMonth:k,setNewMonth:u,newYear:Y,setNewYear:I,newCategory:_,setNewCategory:T,priorityOptions:B,categoryOptions:D,showDeadline:P,setShowDeadline:w,sending:z,todo:e,setIsOpen:p,maxCharacters:H})]})})}export{Ke as default};
