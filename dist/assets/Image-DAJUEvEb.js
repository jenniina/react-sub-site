import{r as E,j as e}from"./react-kX_YxI4E.js";import{u as $,cl as f,j0 as q,ai as M,o as j,ca as b,j1 as v,j2 as C,j3 as I,j4 as P,h3 as R}from"./index-ht7i4Lck.js";import{u as U,g as L}from"./Images-6xY2h9Gk.js";import{Q as N,P as Q,g}from"./poems-BMQnydre.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-DhcENkY1.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const D=({image:t,language:o,handleDownload:x,searchTerm:c,textType:l})=>{const h=$(),{tooltip:u,handleMouseMove:d,handleMouseLeave:r}=U(),p=a=>{const s=a.currentTarget.getBoundingClientRect(),i=a.clientX-s.left+10,k=a.clientY-s.top+10;d(i,k)},[w,m]=E.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[y,n]=E.useState({title:"",author:"",lines:[],linecount:"0"});return E.useEffect(()=>{if(l==="poem"){const a=Math.floor(Math.random()*5)+1;(async()=>{const i=await g(o,a);n(i[0])})()}else l==="quote"?(async()=>{if(o=M.Suomi){const s=await L(M.English,c);s.quote?m(s.quote):h(j(s.message??b[o],!0,8))}else{const s=await L(o,c);s.quote?m(s.quote):h(j(s.message??b[o],!0,8))}})():Math.floor(Math.random()*2)+1===1?(async()=>{const i=Math.floor(Math.random()*5)+1,k=await g(o,i);n(k[0])})():(async()=>{const i=await L(o,c);i.quote?m(i.quote):h(j(i.message??b[o],!0,8))})()},[o,c,l]),e.jsxs("div",{onMouseMove:p,onMouseLeave:r,children:[e.jsxs("div",{className:`tooltip-wrap ${f["image-wrap"]} ${f["image-modal"]}`,children:[e.jsxs("button",{onClick:x,className:"reset",children:[e.jsx("img",{src:t.largeImageURL,alt:t.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),u.visible&&e.jsx("span",{className:"tooltip narrow",style:{top:u.y,left:u.x,right:"unset"},children:q[o]})]}),l==="quote"?e.jsx(N,{quote:w,language:o}):e.jsx(Q,{poem:y,language:o})]})},ro=({image:t,language:o,show:x,searchTerm:c,textType:l})=>{const h=$(),u=async()=>{if(window.confirm(P[o]+"?")){const r=await fetch(t.largeImageURL,{mode:"cors"});if(!r.ok)throw new Error("Network response was not ok");try{const p=await r.blob(),w=window.URL.createObjectURL(p),m=t.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),y=m?m[1].toLowerCase():"jpg",n=document.createElement("a");n.href=w,n.download=`${R(`${t.id}`)}-${R(t.user)}.${y}`,n.target="_blank",n.rel="noreferrer",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(w)}catch(p){console.error("Download failed:",p),h(j(`${b[o]}: ${p}`,!0,5))}}},d=()=>{x({title:t.tags,className:f["image-modal"],children:e.jsx(D,{image:t,language:o,handleDownload:u,searchTerm:c,textType:l})})};return e.jsxs("div",{className:`tooltip-wrap ${f["image-wrap"]}`,children:[e.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":v[o],onClick:d,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),d())},children:e.jsx("img",{src:t.webformatURL,alt:t.tags,title:t.tags,loading:"lazy",className:`${f["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:d,onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&d()}})}),e.jsx("span",{className:"tooltip above narrow2",children:v[o]}),e.jsx("p",{children:e.jsx("small",{children:e.jsxs("a",{href:t.pageURL,target:"_blank",rel:"noreferrer",children:[C[o]," (",I[o],": ",t.user,")"]})})})]},t.id)};export{ro as default};
