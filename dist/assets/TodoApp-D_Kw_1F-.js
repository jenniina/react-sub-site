const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TodoList-DjAc_uF7.js","assets/index-DQhGG1l7.js","assets/react-A9DAvxly.js","assets/hoist-non-react-statics-D5aJipOz.js","assets/react-dom-CxfJ6lHP.js","assets/scheduler-CzFDRTuY.js","assets/react-redux-C4cSaZU-.js","assets/react-is-DUDD-a5e.js","assets/use-sync-external-store-DEc9BFqZ.js","assets/@reduxjs-DhFEcpJw.js","assets/immer-C0GRqQ_d.js","assets/redux-CE3tqztX.js","assets/@babel-DF5_wy6Y.js","assets/redux-thunk-CY0Q9z1Q.js","assets/axios-CCb-kr4I.js","assets/react-icons-yVutJqMS.js","assets/react-router-dom-j9Ns2JNj.js","assets/react-router-BoqxkIr7.js","assets/@remix-run-DTnHqtaE.js","assets/index-CfEGHDOJ.css"])))=>i.map(i=>d[i]);
import{u as ue,i as he,bS as ye,bT as b,G as p,bU as Te,bV as M,bW as f,bX as Se,bY as F,bZ as xe,b_ as we,b$ as Ee,c0 as q,c1 as g,c2 as Ne,c3 as je,c4 as ve,c5 as Ce,c6 as _e,c7 as be,f as ge,c8 as ke,q as K,_ as Oe,c9 as U,ca as Y,cb as B,cc as V,cd as Ae,ce as $e,cf as Ie,cg as De,ch as J,ci as Pe,cj as Fe,ck as Je}from"./index-DQhGG1l7.js";import{r as l,j as c}from"./react-A9DAvxly.js";import{a as k}from"./react-redux-C4cSaZU-.js";import{x as Le}from"./react-icons-yVutJqMS.js";import{v as ze}from"./uuid-Dv1xt2bl.js";import"./react-dom-CxfJ6lHP.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./scheduler-CzFDRTuY.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-j9Ns2JNj.js";import"./react-router-BoqxkIr7.js";import"./@remix-run-DTnHqtaE.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-DEc9BFqZ.js";const Re=l.lazy(()=>Oe(()=>import("./TodoList-DjAc_uF7.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),x=300;function ct({language:r}){const o=ue(),a=k(e=>{var t;return(t=e.auth)==null?void 0:t.user});l.useEffect(()=>{o(he())},[]);const i=k(e=>e.todos.todos),O=k(e=>e.todos.status),L=k(e=>e.todos.error),[v,G]=l.useState("low"),[z,We]=l.useState(""),[A,H]=l.useState("other"),[w,X]=l.useState("all"),[E,Z]=l.useState("all"),T="ReactTodos",Q=i==null?void 0:i.some(e=>e.complete);l.useEffect(()=>{if(i.length===0&&!a){const e=JSON.parse(window.localStorage.getItem(T)||"[]"),t=new Set(i.map(s=>s.key));e.forEach(s=>{t.has(s.key)||o(ye(s))})}},[o,i,a]),l.useEffect(()=>{window.localStorage.setItem(T,JSON.stringify(i))},[i]);const ee=e=>{const t=new Set,s=[];return e.forEach(d=>{t.has(d.key)?s.push(d):t.add(d.key)}),s},te=e=>{if(!e){o(p("Error: no key",!0,8));return}if(a!=null&&a._id)o(U(a._id,e));else{o(Y(e));const t=i.filter(s=>s.key!==e);window.localStorage.setItem(T,JSON.stringify(t))}};l.useEffect(()=>{const e=ee(i),t=new Set;e.forEach(s=>{t.has(s.key)||(te(s.key),t.add(s.key))})},[i]);const[N,se]=l.useState([]),$=i.filter(e=>{const t=w==="all"||e.priority===w,s=E==="all"||e.category===E;return t&&s});l.useEffect(()=>{const e=$==null?void 0:$.slice().sort((t,s)=>(t.order??0)-(s.order??0)).map(t=>({...t,id:t.order,status:"todos"}));se(e)},[i,w,E]);const oe=["all","low","medium","high"],re=["all","work","personal","shopping","other"],ae=["low","medium","high"],ie=["work","personal","shopping","other"],I=b(oe,r),D=b(re,r),C=b(ae,r),_=b(ie,r);l.useEffect(()=>{O==="failed"&&o(p(`There was an error: ${L}`,!0,8))},[O,L,o]);const[R,u]=l.useState(!1);l.useEffect(()=>{a!=null&&a._id&&o(Te(a._id)).then(()=>{o(M(a._id))}).catch(e=>{var t,s;console.error(e),(s=(t=e.response)==null?void 0:t.data)!=null&&s.message?o(p(e.response.data.message,!0,8)):o(p(`${e.message}`,!0,8))})},[a==null?void 0:a._id]);function ce(e){const t=i.find(s=>s.key===e);if(t){const s={...t,complete:!t.complete};o(a?B(a._id,e,s):V(s))}}const ne=async(e,t,s,d,y)=>{if(u(!0),!e){o(p("Error: no key",!0,8)),u(!1);return}const m=i.find(n=>n.key===e);if(m){const n={...m,name:t,priority:s,deadline:d,category:y};if(a)await o(B(a._id,e,n)).then(()=>{o(p(`${Ae[r]}`,!1,3)),u(!1)}).catch(h=>{var j,W;console.error(h),(W=(j=h.response)==null?void 0:j.data)!=null&&W.message?o(p(h.response.data.message,!0,8)):o(p(`${h}`,!0,8)),u(!1)});else{o(V(n));const h=i.map(j=>j.key===e?n:j);window.localStorage.setItem(T,JSON.stringify(h)),u(!1)}}},de=e=>{var t,s;if(a)o(async d=>{var y,m;try{await $e(a._id,e).then(()=>{d(M(a._id))})}catch(n){console.error(n),(m=(y=n.response)==null?void 0:y.data)!=null&&m.message?d(p(n.response.data.message,!0,8)):d(p(`${n}`,!0,8))}});else try{o(Ie(e))}catch(d){console.error(d),(s=(t=d.response)==null?void 0:t.data)!=null&&s.message?o(p(d.response.data.message,!0,8)):o(p(`${d}`,!0,8))}finally{window.localStorage.setItem(T,JSON.stringify(i))}},P=l.useRef(null),[S,le]=l.useState(""),fe=e=>{if(e.preventDefault(),u(!0),S===""){u(!1),o(p(F[r],!0,3));return}if(S.length>x){u(!1),o(p(`${q[r]} (${x} max)`,!0,8));return}const t=ze(),s=i.reduce((m,n)=>n.order>m?n.order:m,0),d=i.reduce((m,n)=>n.order<m?n.order:m,0);let y;if(v==="high"?y={key:t,name:S,complete:!1,order:d-1,priority:v,deadline:z,category:A}:y={key:t,name:S,complete:!1,order:s+1,priority:v,deadline:z,category:A},a)o(De(a._id,y)),u(!1);else{const m=[...i,y].sort((n,h)=>n.order-h.order).map((n,h)=>({...n,order:h}));o(J(m)),window.localStorage.setItem(T,JSON.stringify(m)),J(m),u(!1)}P.current&&(P.current.value="")};async function me(e){if(e.preventDefault(),window.confirm(Pe[r]))if(a)await o(Fe(a._id));else{o(Je());const t=i.filter(s=>!s.complete);window.localStorage.setItem(T,JSON.stringify(t))}}function pe(e){if(!e){o(p("Error: no key",!0,8));return}if(a!=null&&a._id)o(U(a._id,e));else{o(Y(e));let t=i.filter(s=>s.key!==e);t=t.map((s,d)=>({...s,order:d+1})),o(J(t)),window.localStorage.setItem(T,JSON.stringify(t))}}return c.jsxs(c.Fragment,{children:[c.jsx("form",{onSubmit:fe,className:f.form,children:c.jsxs("fieldset",{children:[c.jsx("legend",{className:"scr",children:Se[r]}),c.jsxs("div",{className:f["todo-input-area"],children:[c.jsx("label",{htmlFor:"taskinput",children:F[r]}),c.jsx("textarea",{ref:P,id:"taskinput",className:"bg",rows:3,name:"task",value:S,onChange:e=>le(e.target.value),required:!0,autoComplete:"off",placeholder:`${xe[r]}...`}),c.jsxs("p",{className:f.small,children:[x-S.length," ",we[r]," (",Ee[r],":"," ",x,")"," ",S.length>x&&c.jsx("span",{className:f.warning,children:q[r]})]}),c.jsx(g,{z:N.length+5,id:"category",className:`${f.select} ${f["category-select"]}`,hideDelete:!0,instructions:Ne[r],value:_.find(e=>e.value===A)||_[0],onChange:e=>H(e==null?void 0:e.value),options:_,language:r}),c.jsx(g,{id:"priority",className:f.select,hideDelete:!0,instructions:je[r],value:C.find(e=>e.value===v)||C[0],onChange:e=>G(e==null?void 0:e.value),options:C,language:r,z:N.length+4}),c.jsxs("button",{id:f["submit-todo"],className:f["submit-todo"],type:"submit",disabled:R,children:[F[r]," ",c.jsx(Le,{})]})]})]})}),c.jsxs("div",{className:f["controls-wrap"],children:[c.jsx(g,{id:"category-filter",className:`${f.select} ${f["category-select"]}`,hideDelete:!0,instructions:ve[r],value:D.find(e=>e.value===E)||D[0],onChange:e=>Z(e==null?void 0:e.value),options:D,language:r,z:N.length+3}),c.jsx(g,{id:"priority-filter",className:f.select,hideDelete:!0,instructions:Ce[r],value:I.find(e=>e.value===w)||I[0],onChange:e=>X(e==null?void 0:e.value),options:I,language:r,z:N.length+2}),c.jsx("button",{className:`danger ${f["clear-completed"]}`,disabled:!Q,onClick:e=>me(e),children:_e[r]})]}),c.jsxs("div",{className:f["list-wrap"],children:[c.jsxs("p",{className:f["left-to-do"],children:[i==null?void 0:i.filter(e=>!(e!=null&&e.complete)).length," ",be[r]]}),(w!=="all"||E!=="all")&&c.jsxs("p",{className:f["filter-notification"],children:[ge[r]," ",ke[r]]}),c.jsx(l.Suspense,{fallback:c.jsxs("p",{className:"flex center margin0auto textcenter",children:[K[r],"..."]}),children:c.jsx(Re,{sending:R,todosWithIdAndStatus:N,toggleTodo:ce,deleteTodo:pe,language:r,modifyTodo:ne,modifyTodoOrder:de,priorityOptions:C,categoryOptions:_,maxCharacters:x})}),O==="loading"&&c.jsxs("p",{className:"flex center margin0auto textcenter",children:[K[r],"..."]})]})]})}export{ct as default};
