import{r as u,j as t}from"./react-kX_YxI4E.js";import{L as M,u as O,E as k,e as y,O as x}from"./index-kanJP55Y.js";import{u as R,g as L}from"./Images-CYqoBzqc.js";import{Q as q,P as v,g as P}from"./poems-DC_djIre.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-DF9X557m.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";import"./react-helmet-async-yKbZhP8U.js";import"./react-fast-compare-DeY8XGN4.js";import"./invariant-BxDqUhCT.js";import"./shallowequal-CbQcWkYp.js";const V=({video:e,language:n,searchTerm:c,textType:a,handleDownload:d})=>{const{t:r}=u.useContext(M),h=O(),{tooltip:l,handleMouseMove:i,handleMouseLeave:g}=R(),[f,m]=u.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[w,s]=u.useState({title:"",author:"",lines:[],linecount:"0"}),b=async o=>{const p=await P(n,o);s(p[0])},j=async()=>{if(n=k.fi){const o=await L(k.en,c);o.quote?m(o.quote):h(y(o.message??r("Error"),!0,8))}else{const o=await L(n,c);o.quote?m(o.quote):h(y(o.message??r("Error"),!0,8))}};u.useEffect(()=>{const o=Math.floor(Math.random()*5)+2;a==="poem"?b(o):a==="quote"?j():Math.floor(Math.random()*2)+1===1?b(o):j()},[n,c,a]);const C=o=>{const p=o.currentTarget.getBoundingClientRect(),E=o.clientX-p.left+10,N=o.clientY-p.top+10;i(E,N)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"tooltip-wrap",onMouseMove:C,onMouseLeave:g,children:[t.jsx("video",{src:Number(e.videos.large.size)>0?e.videos.large.url:e.videos.medium.url,title:e.tags,style:{width:"100%",height:"auto",maxHeight:"100%",borderRadius:"8px",cursor:"pointer"},onClick:d,tabIndex:0,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&d()},controls:!0}),l.visible&&t.jsx("span",{className:"tooltip center narrow",style:{top:l.y,left:l.x,right:"unset"},children:r("ClickToLoadVideo")})]}),a==="quote"?t.jsx(q,{quote:f,language:n,url:e.pageURL,title:t.jsxs(t.Fragment,{children:[r("VideoPage")," (",r("Author"),": ",e.user,")"]})}):t.jsx(v,{poem:w,language:n})]})},ne=({video:e,language:n,show:c,searchTerm:a,textType:d})=>{const{t:r}=u.useContext(M),h=async()=>{if(window.confirm(r("Download")+"?")){const i=await fetch(e.videos.large.url,{mode:"cors"});if(!i.ok)throw new Error("Network response was not ok");const g=await i.blob(),f=window.URL.createObjectURL(g),m=e.videos.large.url?e.videos.large.url.match(/\.(mp4)$/i):e.videos.medium.url.match(/\.(mp4)$/i),w=m?m[1].toLowerCase():"mp4",s=document.createElement("a");s.href=f,s.download=`video_${e.id}.${w}`,s.target="_blank",s.rel="noreferrer",document.body.appendChild(s),s.click(),document.body.removeChild(s)}},l=()=>{c({title:e.tags,className:x["video-modal"],children:t.jsx(V,{video:e,language:n,searchTerm:a,textType:d,handleDownload:h})})};return t.jsxs("div",{className:`tooltip-wrap ${x["video-wrap"]}`,children:[t.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":r("ClickToOpenLargeVideo"),onClick:l,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),l())},children:t.jsx("img",{src:e.videos.small.thumbnail,alt:e.tags,className:`${x["video-small"]}`,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"}})}),t.jsx("span",{className:"tooltip above narrow2",children:r("ClickToOpenLargeVideo")}),t.jsx("p",{children:t.jsx("small",{children:t.jsxs("a",{href:e.pageURL,target:"_blank",rel:"noreferrer",children:[r("VideoPage")," (",r("Author"),": ",e.user,")"]})})})]},e.id)};export{ne as default};
