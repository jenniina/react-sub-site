import{r as x,j as e}from"./react-kX_YxI4E.js";import{u as $,gC as u,k6 as C,k7 as M,o as y,c0 as E,k8 as L,k9 as I,jQ as P,ka as Q,h6 as v}from"./index-EIBSd4Hj.js";import{u as U}from"./Images-CV_iG8Iv.js";import{Q as q,P as N,g as R}from"./poems-BTHfb147.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-D7bD3W54.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const D=({image:t,language:o,handleDownload:b,searchTerm:d,textType:c})=>{const f=$(),{tooltip:m,handleMouseMove:l,handleMouseLeave:s}=U(),p=i=>{const n=i.currentTarget.getBoundingClientRect(),a=i.clientX-n.left+10,k=i.clientY-n.top+10;l(a,k)},[w,h]=x.useState({quote:"",author:""}),[j,r]=x.useState({title:"",author:"",lines:[],linecount:"0"});return x.useEffect(()=>{if(c==="poem"){const i=Math.floor(Math.random()*5)+1;(async()=>{const a=await R(o,i);r(a[0])})()}else c==="quote"?(async()=>{const n=await M(o,d);n.quote?h(n.quote):f(y(n.message??E[o],!0,8))})():Math.floor(Math.random()*2)+1===1?(async()=>{const a=Math.floor(Math.random()*5)+1,k=await R(o,a);r(k[0])})():(async()=>{const a=await M(o,d);a.quote?h(a.quote):f(y(a.message??E[o],!0,8))})()},[o,d,c]),e.jsxs("div",{onMouseMove:p,onMouseLeave:s,children:[e.jsxs("div",{className:`tooltip-wrap ${u["image-wrap"]} ${u["image-modal"]}`,children:[e.jsxs("button",{onClick:b,className:"reset",children:[e.jsx("img",{src:t.largeImageURL,alt:t.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),m.visible&&e.jsx("span",{className:"tooltip narrow",style:{top:m.y,left:m.x,right:"unset"},children:C[o]})]}),c==="quote"?e.jsx(q,{quote:w,language:o}):e.jsx(N,{poem:j,language:o})]})},so=({image:t,language:o,show:b,searchTerm:d,textType:c})=>{const f=$(),m=async()=>{if(window.confirm(Q[o]+"?")){const s=await fetch(t.largeImageURL,{mode:"cors"});if(!s.ok)throw new Error("Network response was not ok");try{const p=await s.blob(),w=window.URL.createObjectURL(p),h=t.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),j=h?h[1].toLowerCase():"jpg",r=document.createElement("a");r.href=w,r.download=`${v(`${t.id}`)}-${v(t.user)}.${j}`,r.target="_blank",r.rel="noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(w)}catch(p){console.error("Download failed:",p),f(y(`${E[o]}: ${p}`,!0,5))}}},l=()=>{b({title:t.tags,className:u["image-modal"],children:e.jsx(D,{image:t,language:o,handleDownload:m,searchTerm:d,textType:c})})};return e.jsxs("div",{className:`tooltip-wrap ${u["image-wrap"]}`,children:[e.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":L[o],onClick:l,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),l())},children:e.jsx("img",{src:t.webformatURL,alt:t.tags,title:t.tags,loading:"lazy",className:`${u["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:l,onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&l()}})}),e.jsx("span",{className:"tooltip above narrow2",children:L[o]}),e.jsx("p",{children:e.jsx("small",{children:e.jsxs("a",{href:t.pageURL,target:"_blank",rel:"noreferrer",children:[I[o]," (",P[o],": ",t.user,")"]})})})]},t.id)};export{so as default};
