import{r as p,j as e}from"./react-kX_YxI4E.js";import{u as $,L as C,S as N,W as U,av as R,e as i,aw as D,aa as F,i as P}from"./index-De2CRixK.js";import{s as v}from"./edit.module-3NLXhYEv.js";import"./dom-to-image-more-CfDXlNbO.js";import"./react-dom-B5MLDbn_.js";import"./scheduler-CzFDRTuY.js";import"./react-redux-BEmJlIGA.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-BPp6CH6k.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-icons-DhcENkY1.js";import"./react-router-dom-StiqOUIT.js";import"./react-router-DUuhLvki.js";import"./@remix-run-DTnHqtaE.js";const se=({user:a,language:m,setLanguage:S,options:w})=>{const t=$(),[g,c]=p.useState(""),{t:n}=p.useContext(C),[o,L]=p.useState((a==null?void 0:a.language)??m),[b,d]=p.useState(!1),y=async r=>{var u,f;r.preventDefault(),d(!0);try{const _={_id:a._id,name:a.name,passwordOld:g,language:o};a&&t(R(_)).then(s=>{s&&(s.success===!1?t(i(`${n("EError")}: ${s.message}`,!0,5)):(t(i(`${s.message??n("EUserUpdated")}`,!1,5)),t(D(s.user)).then(()=>{t(F(a==null?void 0:a._id)).then(()=>t(P())),S(o)}),c(""))),d(!1)}).catch(s=>{var h,E,x,j;console.error(s),(E=(h=s.response)==null?void 0:h.data)!=null&&E.message?t(i(s.response.data.message,!0,8)):s.code==="ERR_BAD_REQUEST"&&((j=(x=s.response)==null?void 0:x.data)!=null&&j.message)?t(i(`${n("EError")}: ${s.response.data.message}`,!0,5)):setTimeout(()=>{t(i(n("EUserNotUpdated"),!0,5))},2e3),d(!1)})}catch(l){(f=(u=l.response)==null?void 0:u.data)!=null&&f.message?t(i(l.response.data.message,!0,8)):console.error("error",l),d(!1)}};return e.jsx(e.Fragment,{children:a?e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:n("EEditLanguagePreference")}),e.jsxs("form",{onSubmit:y,className:v["edit-user"],children:[e.jsx(N,{language:m,id:"language-register",className:`language ${v.language}`,instructions:"Language",hide:!0,options:w(U),value:o?{value:o,label:U[o]}:void 0,onChange:r=>{L(r==null?void 0:r.value)}}),e.jsx("div",{className:"input-wrap",children:e.jsxs("label",{children:[e.jsx("input",{required:!0,type:"password",name:"old-password",id:"old-password-user-language",value:g,onChange:({target:r})=>c(r.value.trim())}),e.jsx("span",{children:n("ECurrentPassword")})]})}),e.jsx("button",{type:"submit",disabled:b,children:n("EEdit")})]})]}):e.jsx(e.Fragment,{})})};export{se as default};
