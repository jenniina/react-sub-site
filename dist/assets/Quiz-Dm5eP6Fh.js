import{cd as C,u as N,c8 as ne,ck as ce,t as F,dc as X,n as y,s as ae,cU as le,cs as de,ar as he,cD as ue,dd as me,cE as fe,au as xe,cF as pe,aq as M,cZ as je,c_ as _e}from"./AccessibleColors-CRBQVtI_.js";import{r as i,j as e}from"./react-A9DAvxly.js";import{a as q}from"./react-redux-CHm9GgGE.js";import{H as we}from"./Hero-CfmILBX6.js";import{a as D,l as ve,c as ge,d as Ee}from"./Blob-DEVQxHac.js";import{aF as $}from"./react-icons-5ULj0WcV.js";import{a as Se,b as ye,c as qe,d as ze,e as Ne,f as $e,g as H,h as U,i as B,j as be,k as Ae,l as Re,m as Le,n as G,o as K,p as Qe,q as ke,r as Fe,s as Ce,t as Te,u as Pe,v as Me,w as O,x as Q,y as Oe,z as Ie,A as De,B as He,C as Ue,D as ee,F as Z,G as Be}from"./Memory-EjPzrLQN.js";import{u as L,b as Ge}from"./react-router-U2TbpS38.js";import{A as Ve}from"./Cart-DyrMmj7e.js";import{A as Je}from"./Accordion-DsZcHxu2.js";import{c as V,a as Ye}from"./@reduxjs-DhFEcpJw.js";import{a as T}from"./axios-CCb-kr4I.js";import{L as Ke}from"./react-router-dom-B5GO_nIJ.js";import{R as Ze}from"./Register-BAcCOfpp.js";const We="http://localhost:4000",P=`${We}/api/quiz`,Xe=async()=>(await T.get(P)).data,es=async s=>(await T.get(`${P}/${s}`)).data,ss=async s=>(await T.post(P,s)).data,ts=async s=>(await T.delete(`${P}/remove/${s}`)).data,J={getQuizzes:Xe,getUserQuiz:es,addQuiz:ss,deleteDuplicates:ts},rs={options:{loading:!1,category:"",difficulty:"",type:"",amount_of_questions:50},questions:[],index:0,score:0},os=V({name:"quiz",initialState:rs,reducers:{changeLoading(s,t){s.options.loading=t.payload},changeDifficulty(s,t){s.options.difficulty=t.payload},changeCategory(s,t){s.options.category=t.payload},changeType(s,t){s.options.type=t.payload},changeAmount(s,t){s.options.amount_of_questions=t.payload},setQuestions(s,t){s.questions=t.payload},setScore(s,t){s.score=t.payload},setIndex(s,t){s.index=t.payload}}}),I=s=>async()=>await J.addQuiz(s),Y=s=>async()=>await J.getUserQuiz(s),is=s=>async()=>await J.deleteDuplicates(s),ct=os.reducer,se=V({name:"difficulty",initialState:{mode:"easy"},reducers:{selectMode:(s,{payload:t})=>{localStorage.setItem("quizMode",t),s.mode=t}}}),b=()=>{const s=localStorage.getItem("quizMode");return s||localStorage.setItem("quizMode","easy")},{selectMode:ns}=se.actions,at=se.reducer;function W(s){const t=[...s];for(let o=t.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[t[o],t[r]]=[t[r],t[o]]}return t}const cs={questionsRedux:[],status:"ready",index:0,currentQuestion:{},answer:null,points:0,secondsRemaining:210,finalSeconds:0,highscores:{easy:{score:0,time:210},medium:{score:0,time:210},hard:{score:0,time:210}}},k=Ye("questions/getQuestions",async s=>{try{return(await fetch(`https://the-trivia-api.com/v2/questions?limit=15&difficulties=${s}`)).json()}catch(t){console.error(t)}}),te=V({name:"questions",initialState:cs,reducers:{addQuiz:(s,{payload:t})=>t,resetTimer:s=>{s.secondsRemaining=210},lessSeconds:s=>{s.secondsRemaining-=1},finalSeconds:s=>{s.finalSeconds=210-s.secondsRemaining},newAnswer:(s,{payload:t})=>{s.answer=t,typeof s.currentQuestion.correctAnswer=="string"&&(s.points=t===s.currentQuestion.correctAnswer?s.points+20:s.points)},nextQuestion:s=>{let t=s.questionsRedux[s.index+1],o={id:t.id,correctAnswer:t.correctAnswer,question:t.question.text,options:W([...t.incorrectAnswers,t.correctAnswer])};s.index+=1,s.currentQuestion=o,s.answer=null},gameFinished:s=>{s.highscores[b()].score=s.points>s.highscores[b()].score?s.points:s.highscores[b()].score,s.highscores[b()].time=s.finalSeconds<s.highscores[b()].time?s.finalSeconds:s.highscores[b()].time}},extraReducers:s=>{s.addCase(k.pending,t=>{t.status="loading"}).addCase(k.fulfilled,(t,{payload:o})=>{let r=o[0],n={id:r.id,correctAnswer:r.correctAnswer,question:r.question.text,options:W([...r.incorrectAnswers,r.correctAnswer])};t.status="ready",t.questionsRedux=o,t.currentQuestion=n,t.index=0,t.points=0,t.answer=null}).addCase(k.rejected,t=>{t.status="error"})}}),{newAnswer:as,nextQuestion:ls,gameFinished:re,finalSeconds:oe,lessSeconds:ds,resetTimer:hs}=te.actions,lt=te.reducer,us="_top_1wver_1",ms="_h1_1wver_7",fs="_features_1wver_15",xs="_quiz_1wver_23",ps="_wrap_1wver_55",js="_options_1wver_63",_s="_difficulty_1wver_73",ws="_reset_1wver_75",vs="_mode_1wver_99",gs="_easy_1wver_105",Es="_hard_1wver_113",Ss="_next_1wver_125",ys="_answer_1wver_131",qs="_correct_1wver_137",zs="_disabled_1wver_143",Ns="_question_1wver_157",$s="_highscores_1wver_169",bs="_th_1wver_199",As="_score_1wver_241",Rs="_percentage_1wver_247",Ls="_showHighscores_1wver_283",c={top:us,h1:ms,features:fs,quiz:xs,wrap:ps,options:js,difficulty:_s,reset:ws,mode:vs,easy:gs,hard:Es,next:Ss,answer:ys,correct:qs,disabled:zs,question:Ns,highscores:$s,th:bs,score:As,percentage:Rs,"register-login-wrap":"_register-login-wrap_1wver_269",showHighscores:Ls},Qs=i.lazy(()=>C(()=>Promise.resolve().then(()=>ie),void 0)),dt=({heading:s,text:t,type:o,language:r})=>{const n=L(),{points:a,highscores:p,finalSeconds:g}=q(l=>l.questions),[E,v]=i.useState(p),j=N(),m=q(l=>{var w;return(w=l.auth)==null?void 0:w.user});i.useEffect(()=>{j(D())},[]);const S=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";i.useEffect(()=>{m!=null&&m._id&&a!==0&&g!==0&&j(Y(m._id)).then(l=>{if(l!==null)v(l.highscores);else if(l===null&&localStorage.getItem(`${S?"local-":""}quiz-highscores`)){const w=JSON.parse(localStorage.getItem(`${S?"local-":""}quiz-highscores`));j(I({highscores:w,user:m._id}))}})},[m]);const d=l=>{j(ns(l.target.value)),n(`/portfolio/quiz/${l.target.value}`)};return e.jsxs(e.Fragment,{children:[e.jsx(we,{language:r,address:"portfolio",heading:s,text:t,reset:"Reset",instructions:ne[r]}),e.jsx("section",{className:"card",children:e.jsxs("div",{children:[e.jsxs("div",{className:`medium ${c.features}`,children:[e.jsx("h2",{children:"Features"}),e.jsxs("ul",{className:"ul",children:[e.jsxs("li",{children:[Se[r]," ",e.jsx("a",{href:"https://the-trivia-api.com",children:'"the Trivia Api"'})]}),e.jsxs("li",{children:[ce[r]," ",ye[r]]}),e.jsx("li",{children:qe[r]}),e.jsx("li",{children:ze[r]})]}),e.jsx("a",{href:"https://github.com/jenniina/react-sub-site/tree/main/src/components/Quiz",children:"Github"})]}),e.jsxs("div",{className:`start-screen ${c.quiz}`,children:[e.jsx("h2",{children:Ne[r]}),e.jsxs("p",{children:[$e[r],":"]}),e.jsxs("div",{className:`${c.difficulty}`,children:[e.jsxs("button",{className:`${c.mode} ${c.easy}`,value:"easy",onClick:l=>d(l),children:[H[r]," ",e.jsx($,{})]}),e.jsxs("button",{className:`${c.mode} ${c.medium}`,value:"medium",onClick:l=>d(l),children:[U[r]," ",e.jsx($,{}),e.jsx($,{})]}),e.jsxs("button",{className:`${c.mode} ${c.hard}`,value:"hard",onClick:l=>d(l),children:[B[r]," ",e.jsx($,{}),e.jsx($,{}),e.jsx($,{})]})]})]}),e.jsx(i.Suspense,{fallback:e.jsxs("div",{className:"flex center margin0auto textcenter",children:[F[r],"..."]}),children:e.jsx(Qs,{language:r,user:m,highscoresLocal:E,text:"quizstart"})})," "]})})]})},ks=({language:s})=>e.jsxs("div",{className:`${c["loader-wrap"]}`,children:[e.jsx("div",{className:`${c.loader}`}),e.jsx("h3",{children:be[s]})]}),Fs=({language:s})=>{const{index:t}=q(a=>a.questions),o=N(),r=L(),n=()=>{o(oe()),o(re()),r("/portfolio/quiz/results")};return t<14?e.jsx("button",{className:`${c.next}`,onClick:()=>o(ls()),children:Ve[s]}):e.jsx("button",{className:`${c.next}`,onClick:n,children:Ae[s]})},Cs=({type:s,message:t})=>e.jsx("p",{className:s,children:t}),Ts=i.lazy(()=>C(()=>Promise.resolve().then(()=>Us),void 0)),Ps=i.lazy(()=>C(()=>Promise.resolve().then(()=>Gs),void 0)),ht=({language:s})=>{const{difficulty:t}=Ge(),{mode:o}=q(d=>d.difficulty),{currentQuestion:r,answer:n,index:a,status:p}=q(d=>d.questions),g=N();i.useEffect(()=>{g(k(o))},[]);const E=r==null?void 0:r.question,v=r==null?void 0:r.options,j=n!==null,m=L(),S=()=>{m("/portfolio/quiz")};return e.jsx("section",{className:`card ${c.top}`,children:e.jsx("div",{children:e.jsxs("div",{className:`${c.quiz} `,children:[p==="loading"&&e.jsx(ks,{language:s}),p==="error"&&e.jsx(Cs,{type:"error",message:Re[s]}),p==="ready"&&e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:c.h1,children:e.jsxs("a",{href:"#",onClick:S,children:["« ",X[s]]})}),e.jsx("h2",{children:Le[s]}),e.jsx(i.Suspense,{fallback:e.jsxs("div",{className:"flex center margin0auto textcenter",children:[F[s],"..."]}),children:e.jsx(Ts,{language:s})}),e.jsxs("div",{className:c.wrap,children:[e.jsxs("div",{className:`${c.diff}`,children:[G[s],": ",t]}),e.jsx("h2",{className:`${c.question}`,children:E}),e.jsx("div",{className:`${c.options}`,children:v==null?void 0:v.map(d=>e.jsx("button",{className:`${n===d?c.answer:""} 
            ${j&&r.correctAnswer===d?c.correct:""} 
            ${j?c.disabled:""}
            `,disabled:j,onClick:()=>g(as(d)),children:d},d))})]}),e.jsxs("footer",{children:[e.jsx(i.Suspense,{fallback:e.jsxs("div",{className:"flex center margin0auto textcenter",children:[F[s],"..."]}),children:e.jsx(Ps,{})}),n&&e.jsx(Fs,{language:s})]})]})]})})})},Ms=i.lazy(()=>C(()=>Promise.resolve().then(()=>ie),void 0)),ut=({language:s})=>{const{points:t,highscores:o,finalSeconds:r}=q(u=>u.questions),{mode:n}=q(u=>u.difficulty),a=+(t*100/300).toFixed(1),p=L(),[g,E]=i.useState(!1),[v,j]=i.useState(!1);i.useState(""),i.useState(""),i.useState(""),i.useState("");const m=r%60,S=Math.floor(r/60),d=N(),l=q(u=>{var _;return(_=u.auth)==null?void 0:_.user});i.useEffect(()=>{d(D())},[]),i.useEffect(()=>{r===0&&p("/portfolio/quiz")},[]);const w=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";i.useEffect(()=>{(!l&&t!==0&&r!==0||r===void 0)&&localStorage.setItem(`${w?"local-":""}quiz-highscores`,JSON.stringify(o)),(l!=null&&l._id&&t!==0&&r!==0||l!=null&&l._id&&r!==void 0)&&d(Y(l._id)).then(u=>{if(u===null){const _={highscores:{...o,[n]:{score:t,time:r}},user:l._id};d(y(K[s],!1,3)),d(I(_)).then(x=>{d(is(l._id)).then(f=>{})})}else if(u!==null&&u.highscores[n].score<=t){const _={highscores:{...u.highscores,[n]:{score:t,time:u.highscores[n].time}},user:l._id};u.highscores[n].score<t?(d(y(K[s],!1,3)),_.highscores[n].time=r):u.highscores[n].score===t&&u.highscores[n].time>r&&(d(y(Qe[s],!1,3)),_.highscores[n].time=r),d(I(_)).then(x=>{})}})},[]);let z;switch(!0){case a===100:z=Te[s];break;case(a>=80&&a<100):z=Ce[s];break;case(a>=50&&a<80):z=Fe[s];break;case(a>=0&&a<50):z=ke[s];break;default:z=""}i.useEffect(()=>{const u=document.querySelector(".login-wrap .open"),_=document.querySelector(".login-wrap .close"),x=document.querySelector(".register-wrap .open"),f=document.querySelector(".register-wrap .close");u==null||u.addEventListener("click",()=>{E(!0)}),_==null||_.addEventListener("click",()=>{E(!1)}),x==null||x.addEventListener("click",()=>{j(!0)}),f==null||f.addEventListener("click",()=>{j(!1)})},[]);const h=()=>{p("/portfolio/quiz")};return e.jsx(e.Fragment,{children:r!==0&&e.jsx(e.Fragment,{children:e.jsx("section",{className:`card ${c.top}`,children:e.jsxs("div",{children:[e.jsxs("div",{className:`${c.quiz}`,children:[e.jsx("h1",{className:c.h1,children:e.jsxs("a",{href:"#",onClick:h,children:["« ",X[s]]})}),e.jsx("h2",{children:z}),e.jsxs("p",{className:"result",children:[Pe[s]," ",e.jsx("strong",{children:t})," ",Me[s]," (",a,"%)"]}),e.jsxs("p",{children:[G[s],":"," ",(()=>{switch(n){case"easy":return H[s];case"medium":return U[s];case"hard":return B[s];default:return n}})()]}),e.jsx("p",{children:r===0?e.jsxs(e.Fragment,{children:[O[s],": ",Q[s]]}):e.jsxs(e.Fragment,{children:[O[s],": ",S<10&&"0",S,":",m<10&&"0",m]})}),e.jsxs("p",{className:"highscore",children:["(",Oe[s],": ",o[n].score," ",Ie[s],")"]}),e.jsxs("div",{className:`${c.reset}`,children:[e.jsx("button",{className:"btn",onClick:()=>p("/portfolio/quiz"),children:De[s]}),e.jsx("button",{className:"btn",onClick:()=>p(`/portfolio/quiz/${n}`),children:He[s]})]})]}),e.jsx(i.Suspense,{fallback:e.jsxs("div",{className:"flex center margin0auto textcenter",children:[F[s],"..."]}),children:e.jsx(Ms,{language:s,user:l,highscoresLocal:o,text:"quizfinish"})})]})})})})},Os=({easy:s,medium:t,hard:o,language:r})=>{const{windowWidth:n}=ae(),[a,p]=i.useState(!0);return i.useEffect(()=>{n<le?p(!1):p(!0)},[n]),e.jsxs("table",{className:c.highscores,children:[e.jsx("caption",{children:Ue[r]}),e.jsx("thead",{children:e.jsxs("tr",{className:c.th,children:[e.jsx("th",{children:G[r]}),e.jsx("th",{className:c.score,children:ee[r]}),a&&e.jsx("th",{className:c.percentage,children:"%"}),e.jsx("th",{children:O[r]})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:H[r]}),e.jsxs("td",{children:[s?s.score:0,"/300"]}),a&&e.jsxs("td",{children:[+(s.score*100/300).toFixed(1),"%"]}),e.jsx("td",{children:s.score===0||s.time===0?Q[r]:e.jsxs(e.Fragment,{children:[Math.floor(s.time/60)<10&&"0",Math.floor(s.time/60),":",s.time%60<10&&"0",s.time%60]})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:U[r]}),e.jsxs("td",{children:[t?t.score:0,"/300"]}),a&&e.jsxs("td",{children:[+(t.score*100/300).toFixed(1),"%"]}),e.jsx("td",{children:t.score===0||t.time===0?Q[r]:e.jsxs(e.Fragment,{children:[Math.floor(t.time/60)<10&&"0",Math.floor(t.time/60),":",t.time%60<10&&"0",t.time%60]})})]}),e.jsxs("tr",{children:[e.jsx("th",{children:B[r]}),e.jsxs("td",{children:[o?o.score:0,"/300"]}),a&&e.jsxs("td",{children:[+(o.score*100/300).toFixed(1),"%"]}),e.jsx("td",{children:o.score===0||o.time===0?Q[r]:e.jsxs(e.Fragment,{children:[Math.floor(o.time/60)<10&&"0",Math.floor(o.time/60),":",o.time%60<10&&"0",o.time%60]})})]})]})]})},Is=({easy:s,medium:t,hard:o,language:r,setIsFormOpen:n})=>{const a=N(),[p,g]=i.useState(!1),[E,v]=i.useState(""),[j,m]=i.useState(""),S=i.useRef(null),[d,l]=i.useState({easy:s??{score:0,time:210},medium:t??{score:0,time:210},hard:o??{score:0,time:210}}),[w,z]=i.useState(!1),h=q(x=>{var f;return(f=x.auth)==null?void 0:f.user});i.useEffect(()=>{h!=null&&h._id&&a(Y(h._id)).then(x=>{x!==null&&l(x.highscores)})},[h==null?void 0:h._id]),i.useEffect(()=>{a(D())},[]);const u=()=>{a(ve())},_=async x=>{x.preventDefault(),g(!0),a(y(pe[r],!1,8)),await a(ge(E,j,"en")).then(()=>{v(""),m(""),g(!1)}).catch(f=>{var A,R;(R=(A=f.response)==null?void 0:A.data)!=null&&R.message?a(y(f.response.data.message,!0,8)):f.code==="ERR_BAD_REQUEST"?a(y(`${M.en}: ${f.response.data.message}`,!0,8)):f.code==="ERR_NETWORK"&&a(y(`${M.en}: ${f.message}`,!0,8)),g(!1)})};return e.jsx("div",{className:"login-wrap",children:h?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsxs("span",{children:[de[(h==null?void 0:h.language)??"en"]," ",h!=null&&h.name?h==null?void 0:h.name:h.username," "]}),e.jsx(Ke,{to:"/edit",children:`${he[h==null?void 0:h.language]}`}),e.jsxs("button",{onClick:u,id:"logout",className:"logout danger",children:[ue[(h==null?void 0:h.language)??"en"]," ×"]})]}),e.jsx("button",{onClick:()=>z(!w),className:c.showHighscores,children:`${w?"hide":"show"} highscores`}),w&&e.jsx(Os,{language:r,easy:d.easy,medium:d.medium,hard:d.hard})]}):e.jsx(e.Fragment,{children:e.jsxs(Je,{language:r,className:"accordion-login login-to-save",wrapperClass:"login-to-save-wrap",text:Z[r],ref:S,setIsFormOpen:n,hideBrackets:!0,children:[e.jsx("h2",{children:Z[r]}),e.jsxs("form",{onSubmit:_,className:`login ${c.login}`,children:[e.jsx("div",{className:"input-wrap",children:e.jsxs("label",{htmlFor:"quiz-username",children:[e.jsx("input",{id:"quiz-username",name:"username",type:"text",value:E,required:!0,autoComplete:"email",onChange:({target:x})=>v(x.value.trim())}),e.jsxs("span",{children:[me[r],": "]})]})}),e.jsx("div",{className:"input-wrap",children:e.jsxs("label",{children:[e.jsx("input",{name:"password",type:"password",required:!0,autoComplete:"current-password",value:j,onChange:({target:x})=>m(x.value.trim())}),e.jsxs("span",{children:[fe[r],": "]})]})}),e.jsx("button",{type:"submit",disabled:p,id:"login",className:"login",children:xe[r]})]})]})})})},Ds=({language:s,user:t,highscoresLocal:o,text:r})=>{const n=N(),[a,p]=i.useState(!1),[g,E]=i.useState(!1),[v,j]=i.useState(""),[m,S]=i.useState(""),[d,l]=i.useState(""),[w,z]=i.useState(""),[h,u]=i.useState(!1),_=x=>{if(x.preventDefault(),u(!0),m.trim()!==d.trim()){n(y(je[s],!0,8)),u(!1);return}n(Ee({name:w,username:v,password:m,language:"en"})).then(async()=>{n(y(_e[s],!1,8)),u(!1)}).catch(f=>{var A,R;console.error(f),(R=(A=f.response)==null?void 0:A.data)!=null&&R.message?n(y(f.response.data.message,!0,8)):n(y(`${M[s]}: ${f.message}`,!0,8)),u(!1)})};return e.jsxs("div",{className:`quiz-register-login-wrap register-login-wrap ${c["register-login-wrap"]}`,children:[e.jsx("div",{className:`${a?"open":""} ${t?"logged":""}`,children:e.jsx(Is,{setIsFormOpen:p,language:s,easy:o.easy,medium:o.medium,hard:o.hard})}),e.jsx("div",{className:`${g?"open":""}`,children:e.jsx(Ze,{sending:h,setIsFormOpen:E,language:s,handleRegister:_,username:v,setUsername:j,password:m,setPassword:S,confirmPassword:d,setConfirmPassword:l,name:w,setName:z,text:r})})]})},ie=Object.freeze(Object.defineProperty({__proto__:null,default:Ds},Symbol.toStringTag,{value:"Module"})),Hs=({language:s})=>{const{answer:t,index:o,points:r}=q(n=>n.questions);return e.jsxs("header",{className:`${c.progress}`,children:[e.jsx("progress",{max:"15",value:o+ +(t!==null)}),e.jsxs("p",{children:[Be[s],"  ",e.jsx("b",{children:o+1})," / 15"]}),e.jsxs("p",{children:[e.jsxs("b",{children:[ee[s],": ",r]})," ","/ 300"]})]})},Us=Object.freeze(Object.defineProperty({__proto__:null,default:Hs},Symbol.toStringTag,{value:"Module"})),Bs=()=>{const{secondsRemaining:s}=q(a=>a.questions),t=s%60,o=Math.floor(s/60),r=N(),n=L();return i.useEffect(()=>{s===0&&(r(oe()),r(re()),r(hs()),n("/portfolio/quiz/results"))},[s]),i.useEffect(()=>{const a=setInterval(()=>{r(ds())},1e3);return()=>clearInterval(a)},[]),e.jsxs("div",{className:`${c.timer}`,children:[o<10&&"0",o,":",t<10&&"0",t]})},Gs=Object.freeze(Object.defineProperty({__proto__:null,default:Bs},Symbol.toStringTag,{value:"Module"}));export{dt as Q,lt as a,ht as b,ut as c,at as d,ct as q};
