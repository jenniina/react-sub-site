const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TodoList-C-jeWj6u.js","assets/react-A9DAvxly.js","assets/hoist-non-react-statics-D5aJipOz.js","assets/index-BM0FeXIF.js","assets/react-dom-CxfJ6lHP.js","assets/scheduler-CzFDRTuY.js","assets/react-redux-C4cSaZU-.js","assets/react-is-DUDD-a5e.js","assets/use-sync-external-store-DEc9BFqZ.js","assets/@reduxjs-DhFEcpJw.js","assets/immer-C0GRqQ_d.js","assets/redux-CE3tqztX.js","assets/@babel-DF5_wy6Y.js","assets/redux-thunk-CY0Q9z1Q.js","assets/axios-CCb-kr4I.js","assets/react-icons-RHjzyHVQ.js","assets/react-router-dom-CYs6befe.js","assets/react-router-S1Hdk0kP.js","assets/@remix-run-DTnHqtaE.js","assets/index-sJB6WPre.css"])))=>i.map(i=>d[i]);
import{K as ue,bu as he,bQ as ye,bR as g,W as p,bS as Te,bT as K,bU as f,bV as Se,bW as F,bX as xe,bY as we,bZ as Ee,bl as M,S as _,b_ as Ne,b$ as be,c0 as je,c1 as ve,c2 as Ce,c3 as ge,c4 as _e,c5 as ke,ag as U,c6 as Oe,c7 as Y,c8 as q,c9 as B,ca as V,cb as Ae,cc as $e,cd as Ie,ce as De,cf as J,cg as Pe,ch as Fe,ci as Je}from"./index-BM0FeXIF.js";import{r as l,j as n}from"./react-A9DAvxly.js";import{a as k}from"./react-redux-C4cSaZU-.js";import{W as Le}from"./react-icons-RHjzyHVQ.js";import{v as We}from"./uuid-Dv1xt2bl.js";import"./react-dom-CxfJ6lHP.js";import"./hoist-non-react-statics-D5aJipOz.js";import"./scheduler-CzFDRTuY.js";import"./@reduxjs-DhFEcpJw.js";import"./immer-C0GRqQ_d.js";import"./redux-CE3tqztX.js";import"./@babel-DF5_wy6Y.js";import"./redux-thunk-CY0Q9z1Q.js";import"./axios-CCb-kr4I.js";import"./react-router-dom-CYs6befe.js";import"./react-router-S1Hdk0kP.js";import"./@remix-run-DTnHqtaE.js";import"./react-is-DUDD-a5e.js";import"./use-sync-external-store-DEc9BFqZ.js";const ze=l.lazy(()=>Oe(()=>import("./TodoList-C-jeWj6u.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),b=300;function nt({language:r}){const o=ue(),a=k(e=>{var t;return(t=e.auth)==null?void 0:t.user});l.useEffect(()=>{o(he())},[]);const i=k(e=>e.todos.todos),O=k(e=>e.todos.status),L=k(e=>e.todos.error),[j,H]=l.useState("low"),[W,Re]=l.useState(""),[A,Q]=l.useState("other"),[x,X]=l.useState("all"),[w,Z]=l.useState("all"),T="ReactTodos",G=i==null?void 0:i.some(e=>e.complete);l.useEffect(()=>{if(i.length===0&&!a){const e=JSON.parse(window.localStorage.getItem(T)||"[]"),t=new Set(i.map(s=>s.key));e.forEach(s=>{t.has(s.key)||o(ye(s))})}},[o,i,a]),l.useEffect(()=>{window.localStorage.setItem(T,JSON.stringify(i))},[i]);const ee=e=>{const t=new Set,s=[];return e.forEach(d=>{t.has(d.key)?s.push(d):t.add(d.key)}),s},te=e=>{if(!e){o(p("Error: no key",!0,8));return}if(a!=null&&a._id)o(Y(a._id,e));else{o(q(e));const t=i.filter(s=>s.key!==e);window.localStorage.setItem(T,JSON.stringify(t))}};l.useEffect(()=>{const e=ee(i),t=new Set;e.forEach(s=>{t.has(s.key)||(te(s.key),t.add(s.key))})},[i]);const[E,se]=l.useState([]),$=i.filter(e=>{const t=x==="all"||e.priority===x,s=w==="all"||e.category===w;return t&&s});l.useEffect(()=>{const e=$==null?void 0:$.slice().sort((t,s)=>(t.order??0)-(s.order??0)).map(t=>({...t,id:t.order,status:"todos"}));se(e)},[i,x,w]);const oe=["all","low","medium","high"],re=["all","work","personal","shopping","other"],ae=["low","medium","high"],ie=["work","personal","shopping","other"],I=g(oe,r),D=g(re,r),v=g(ae,r),C=g(ie,r);l.useEffect(()=>{O==="failed"&&o(p(`There was an error: ${L}`,!0,8))},[O,L,o]);const[z,u]=l.useState(!1);l.useEffect(()=>{a!=null&&a._id&&o(Te(a._id)).then(()=>{o(K(a._id))}).catch(e=>{var t,s;console.error(e),(s=(t=e.response)==null?void 0:t.data)!=null&&s.message?o(p(e.response.data.message,!0,8)):o(p(`${e.message}`,!0,8))})},[a==null?void 0:a._id]);function ne(e){const t=i.find(s=>s.key===e);if(t){const s={...t,complete:!t.complete};o(a?B(a._id,e,s):V(s))}}const ce=async(e,t,s,d,y)=>{if(u(!0),!e){o(p("Error: no key",!0,8)),u(!1);return}const m=i.find(c=>c.key===e);if(m){const c={...m,name:t,priority:s,deadline:d,category:y};if(a)await o(B(a._id,e,c)).then(()=>{o(p(`${Ae[r]}`,!1,3)),u(!1)}).catch(h=>{var N,R;console.error(h),(R=(N=h.response)==null?void 0:N.data)!=null&&R.message?o(p(h.response.data.message,!0,8)):o(p(`${h}`,!0,8)),u(!1)});else{o(V(c));const h=i.map(N=>N.key===e?c:N);window.localStorage.setItem(T,JSON.stringify(h)),u(!1)}}},de=e=>{var t,s;if(a)o(async d=>{var y,m;try{await $e(a._id,e).then(()=>{d(K(a._id))})}catch(c){console.error(c),(m=(y=c.response)==null?void 0:y.data)!=null&&m.message?d(p(c.response.data.message,!0,8)):d(p(`${c}`,!0,8))}});else try{o(Ie(e))}catch(d){console.error(d),(s=(t=d.response)==null?void 0:t.data)!=null&&s.message?o(p(d.response.data.message,!0,8)):o(p(`${d}`,!0,8))}finally{window.localStorage.setItem(T,JSON.stringify(i))}},P=l.useRef(null),[S,le]=l.useState(""),fe=e=>{if(e.preventDefault(),u(!0),S===""){u(!1),o(p(F[r],!0,3));return}if(S.length>b){u(!1),o(p(`${M[r]} (${b} max)`,!0,8));return}const t=We(),s=i.reduce((m,c)=>c.order>m?c.order:m,0),d=i.reduce((m,c)=>c.order<m?c.order:m,0);let y;if(j==="high"?y={key:t,name:S,complete:!1,order:d-1,priority:j,deadline:W,category:A}:y={key:t,name:S,complete:!1,order:s+1,priority:j,deadline:W,category:A},a)o(De(a._id,y)),u(!1);else{const m=[...i,y].sort((c,h)=>c.order-h.order).map((c,h)=>({...c,order:h}));o(J(m)),window.localStorage.setItem(T,JSON.stringify(m)),J(m),u(!1)}P.current&&(P.current.value="")};async function me(e){if(e.preventDefault(),window.confirm(Pe[r]))if(a)await o(Fe(a._id));else{o(Je());const t=i.filter(s=>!s.complete);window.localStorage.setItem(T,JSON.stringify(t))}}function pe(e){if(!e){o(p("Error: no key",!0,8));return}if(a!=null&&a._id)o(Y(a._id,e));else{o(q(e));let t=i.filter(s=>s.key!==e);t=t.map((s,d)=>({...s,order:d+1})),o(J(t)),window.localStorage.setItem(T,JSON.stringify(t))}}return n.jsxs(n.Fragment,{children:[n.jsx("form",{onSubmit:fe,className:f.form,children:n.jsxs("fieldset",{children:[n.jsx("legend",{className:"scr",children:Se[r]}),n.jsxs("div",{className:f["todo-input-area"],children:[n.jsx("label",{htmlFor:"taskinput",children:F[r]}),n.jsx("textarea",{ref:P,id:"taskinput",className:"bg",rows:3,name:"task",value:S,onChange:e=>le(e.target.value),required:!0,autoComplete:"off",placeholder:`${xe[r]}...`}),n.jsxs("p",{className:f.small,children:[b-S.length," ",we[r]," (",Ee[r],":"," ",b,")"," ",S.length>b&&n.jsx("span",{className:f.warning,children:M[r]})]}),n.jsx(_,{z:E.length+5,id:"category",className:`${f.select} ${f["category-select"]}`,hideDelete:!0,instructions:Ne[r],value:C.find(e=>e.value===A)||C[0],onChange:e=>Q(e==null?void 0:e.value),options:C,language:r}),n.jsx(_,{id:"priority",className:f.select,hideDelete:!0,instructions:be[r],value:v.find(e=>e.value===j)||v[0],onChange:e=>H(e==null?void 0:e.value),options:v,language:r,z:E.length+4}),n.jsxs("button",{id:f["submit-todo"],className:f["submit-todo"],type:"submit",disabled:z,children:[F[r]," ",n.jsx(Le,{})]})]})]})}),n.jsxs("div",{className:f["controls-wrap"],children:[n.jsx(_,{id:"category-filter",className:`${f.select} ${f["category-select"]}`,hideDelete:!0,instructions:je[r],value:D.find(e=>e.value===w)||D[0],onChange:e=>Z(e==null?void 0:e.value),options:D,language:r,z:E.length+3}),n.jsx(_,{id:"priority-filter",className:f.select,hideDelete:!0,instructions:ve[r],value:I.find(e=>e.value===x)||I[0],onChange:e=>X(e==null?void 0:e.value),options:I,language:r,z:E.length+2}),n.jsx("button",{className:`danger ${f["clear-completed"]}`,disabled:!G,onClick:e=>me(e),children:Ce[r]})]}),n.jsxs("div",{className:f["list-wrap"],children:[n.jsxs("p",{className:f["left-to-do"],children:[i==null?void 0:i.filter(e=>!(e!=null&&e.complete)).length," ",ge[r]]}),(x!=="all"||w!=="all")&&n.jsxs("p",{className:f["filter-notification"],children:[_e[r]," ",ke[r]]}),n.jsx(l.Suspense,{fallback:n.jsxs("p",{className:"flex center margin0auto textcenter",children:[U[r],"..."]}),children:n.jsx(ze,{sending:z,todosWithIdAndStatus:E,toggleTodo:ne,deleteTodo:pe,language:r,modifyTodo:ce,modifyTodoOrder:de,priorityOptions:v,categoryOptions:C})}),O==="loading"&&n.jsxs("p",{className:"flex center margin0auto textcenter",children:[U[r],"..."]})]})]})}export{nt as default};
