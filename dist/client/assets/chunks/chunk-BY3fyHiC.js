import{a as e,j as t}from"./chunk-CAff-kf5.js";import{s as o}from"./chunk-mrHSz1EB.js";import{L as a,b as s,E as r,j as n,u as i,a as c,q as l,av as u}from"../entries/src_pages.8IG4k9ME.js";import{u as m,g as p}from"./chunk-Cg8Cl3x4.js";import{Q as h,P as g,g as d}from"./chunk-Dci1X-t5.js";import"./chunk-BmSI4Fww.js";import"./chunk-CVevwmbB.js";import"./chunk-CNpwfz3n.js";import"../entries/entry-client-routing.Bbnd9vHe.js";import"./chunk-VF2LHfxc.js";/* empty css              *//* empty css              */import"./chunk-D3Yr0q6g.js";import"./chunk-CKSHq_s9.js";import"./chunk-GmA6ITIw.js";import"./chunk-DFDIFHTJ.js";import"./chunk-BvVqAYuT.js";import"./chunk-Xgiuglox.js";import"./chunk-CmA2CWkd.js";import"./chunk-Cgv-mfVR.js";import"./chunk-fiALBYsU.js";import"./chunk-DbeWnEfh.js";import"./chunk-BurK_taE.js";import"./chunk-BVvUx4OK.js";import"./chunk-B3S1iNVp.js";import"./chunk-ei4kQ0Q2.js";import"./chunk-B_VbuTrp.js";import"./chunk-DAUSXQgp.js";import"./chunk-RtNBUybj.js";import"./chunk-CrSVf9D1.js";import"./chunk-Cgo1rCBn.js";import"./chunk-DQcwr13S.js";/* empty css              */import"./chunk-ITMKy72C.js";import"./chunk-e2Lvd1W2.js";/* empty css              */import"./chunk-CFcfonrM.js";import"./chunk-CblELM-r.js";import"./chunk-CEm4-sWZ.js";import"./chunk-CeuMhN-M.js";/* empty css              */const j=({image:i,language:c,handleDownload:l,searchTerm:u,textType:j})=>{const{t:k}=e.useContext(a),w=s(),{tooltip:f,handleMouseMove:y,handleMouseLeave:x}=m(),[b,L]=e.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[v,C]=e.useState({title:"",author:"",lines:[],linecount:"0"});return e.useEffect(()=>{if("poem"===j){const e=Math.floor(5*Math.random())+1;(async()=>{const t=await d(c,e);C(t[0])})()}else if("quote"===j){(async()=>{if(c=r.fi){const e=await p(r.en,u);e.quote?L(e.quote):w(n(e.message??k("Error"),!0,8))}else{const e=await p(c,u);e.quote?L(e.quote):w(n(e.message??k("Error"),!0,8))}})()}else{if(1===Math.floor(2*Math.random())+1){(async()=>{const e=Math.floor(5*Math.random())+1,t=await d(c,e);C(t[0])})()}else{(async()=>{const e=await p(c,u);e.quote?L(e.quote):w(n(e.message??k("Error"),!0,8))})()}}},[c,u,j]),t.jsxs("div",{onMouseMove:e=>{const t=e.currentTarget.getBoundingClientRect(),o=e.clientX-t.left+10,a=e.clientY-t.top+10;y(o,a)},onMouseLeave:x,children:[t.jsxs("div",{className:`tooltip-wrap ${o["image-wrap"]} ${o["image-modal"]}`,children:[t.jsxs("button",{onClick:l,className:"reset",children:[t.jsx("img",{src:i.largeImageURL,alt:i.tags,loading:"lazy",style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer",position:"relative"}})," "]}),f.visible&&t.jsx("span",{className:"tooltip narrow",style:{top:f.y,left:f.x,right:"unset"},children:k("ClickToLoadImage")})]}),"quote"===j?t.jsx(h,{quote:b,language:c}):t.jsx(g,{poem:v,language:c})]})},k=({image:r,language:m,show:p,searchTerm:h,textType:g})=>{const d=i(),k=c(),{t:w}=e.useContext(a),f=l(),y=s(),x=async()=>{if(d&&k&&await f({message:w("Download")+"?"})){const t=await fetch(r.largeImageURL,{mode:"cors"});if(!t.ok)throw new Error("Network response was not ok");try{const e=await t.blob(),o=k.URL.createObjectURL(e),a=r.largeImageURL.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i),s=a?a[1].toLowerCase():"jpg",n=null==document?void 0:document.createElement("a");n.href=o,n.download=`${u(`${r.id}`)}-${u(r.user)}.${s}`,n.target="_blank",n.rel="noreferrer",null==document||document.body.appendChild(n),n.click(),null==document||document.body.removeChild(n),k.URL.revokeObjectURL(o)}catch(e){y(n(`${w("Error")}: ${e}`,!0,5))}}},b=()=>{p({title:r.tags,className:o["image-modal"],children:t.jsx(j,{image:r,language:m,handleDownload:x,searchTerm:h,textType:g})})};return t.jsxs("div",{className:`tooltip-wrap ${o["image-wrap"]}`,children:[t.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":w("ClickToOpenLargeImage"),onClick:b,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),b())},children:t.jsx("img",{src:r.webformatURL,alt:r.tags,title:r.tags,loading:"lazy",className:`${o["image-small"]}`,tabIndex:0,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"},onClick:b,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||b()}})}),t.jsx("span",{className:"tooltip above narrow2",children:w("ClickToOpenLargeImage")}),t.jsx("p",{children:t.jsx("small",{children:t.jsxs("a",{href:r.pageURL,target:"_blank",rel:"noreferrer",children:[w("ImagePage")," (",w("Author"),": ",r.user,")"]})})})]},r.id)};export{k as default};
