import{a as e,j as o}from"./chunk-CAff-kf5.js";import{s as t}from"./chunk-mrHSz1EB.js";import{L as r,b as s,E as n,j as a,u as i,a as c,q as u}from"../entries/src_pages.8IG4k9ME.js";import{u as l,g as m}from"./chunk-Cg8Cl3x4.js";import{Q as d,P as h,g as p}from"./chunk-Dci1X-t5.js";import"./chunk-BmSI4Fww.js";import"./chunk-CVevwmbB.js";import"./chunk-CNpwfz3n.js";import"../entries/entry-client-routing.Bbnd9vHe.js";import"./chunk-VF2LHfxc.js";/* empty css              *//* empty css              */import"./chunk-D3Yr0q6g.js";import"./chunk-CKSHq_s9.js";import"./chunk-GmA6ITIw.js";import"./chunk-DFDIFHTJ.js";import"./chunk-BvVqAYuT.js";import"./chunk-Xgiuglox.js";import"./chunk-CmA2CWkd.js";import"./chunk-Cgv-mfVR.js";import"./chunk-fiALBYsU.js";import"./chunk-DbeWnEfh.js";import"./chunk-BurK_taE.js";import"./chunk-BVvUx4OK.js";import"./chunk-B3S1iNVp.js";import"./chunk-ei4kQ0Q2.js";import"./chunk-B_VbuTrp.js";import"./chunk-DAUSXQgp.js";import"./chunk-RtNBUybj.js";import"./chunk-CrSVf9D1.js";import"./chunk-Cgo1rCBn.js";import"./chunk-DQcwr13S.js";/* empty css              */import"./chunk-ITMKy72C.js";import"./chunk-e2Lvd1W2.js";/* empty css              */import"./chunk-CFcfonrM.js";import"./chunk-CblELM-r.js";import"./chunk-CEm4-sWZ.js";import"./chunk-CeuMhN-M.js";/* empty css              */const j=({video:t,language:i,searchTerm:c,textType:u,handleDownload:j})=>{const{t:k}=e.useContext(r),g=s(),{tooltip:v,handleMouseMove:w,handleMouseLeave:x}=l(),[f,y]=e.useState({id:0,content:"",originator:{name:"",id:0,description:"",language_code:"en",master_id:0,url:""},tags:[""],url:"",language_code:"en"}),[b,C]=e.useState({title:"",author:"",lines:[],linecount:"0"}),L=async e=>{const o=await p(i,e);C(o[0])},M=async()=>{if(i=n.fi){const e=await m(n.en,c);e.quote?y(e.quote):g(a(e.message??k("Error"),!0,8))}else{const e=await m(i,c);e.quote?y(e.quote):g(a(e.message??k("Error"),!0,8))}};e.useEffect(()=>{const e=Math.floor(5*Math.random())+2;if("poem"===u)L(e);else if("quote"===u)M();else{1===Math.floor(2*Math.random())+1?L(e):M()}},[i,c,u]);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"tooltip-wrap",onMouseMove:e=>{const o=e.currentTarget.getBoundingClientRect(),t=e.clientX-o.left+10,r=e.clientY-o.top+10;w(t,r)},onMouseLeave:x,children:[o.jsx("video",{src:Number(t.videos.large.size)>0?t.videos.large.url:t.videos.medium.url,title:t.tags,style:{width:"100%",height:"auto",maxHeight:"100%",borderRadius:"8px",cursor:"pointer"},onClick:j,tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||j()},controls:!0}),v.visible&&o.jsx("span",{className:"tooltip center narrow",style:{top:v.y,left:v.x,right:"unset"},children:k("ClickToLoadVideo")})]}),"quote"===u?o.jsx(d,{quote:f,language:i,url:t.pageURL,title:o.jsxs(o.Fragment,{children:[k("VideoPage")," (",k("Author"),": ",t.user,")"]})}):o.jsx(h,{poem:b,language:i})]})},k=({video:s,language:n,show:a,searchTerm:l,textType:m})=>{const d=i(),h=c(),{t:p}=e.useContext(r),k=u(),g=async()=>{if(d&&h&&await k({message:""+(p("Download")+"?")})){const e=await fetch(s.videos.large.url,{mode:"cors"});if(!e.ok)throw new Error("Network response was not ok");const o=await e.blob(),t=h.URL.createObjectURL(o),r=s.videos.large.url?s.videos.large.url.match(/\.(mp4)$/i):s.videos.medium.url.match(/\.(mp4)$/i),n=r?r[1].toLowerCase():"mp4",a=null==document?void 0:document.createElement("a");a.href=t,a.download=`video_${s.id}.${n}`,a.target="_blank",a.rel="noreferrer",null==document||document.body.appendChild(a),a.click(),null==document||document.body.removeChild(a)}},v=()=>{a({title:s.tags,className:t["video-modal"],children:o.jsx(j,{video:s,language:n,searchTerm:l,textType:m,handleDownload:g})})};return o.jsxs("div",{className:`tooltip-wrap ${t["video-wrap"]}`,children:[o.jsx("button",{type:"button",style:{background:"none",border:"none",padding:0,cursor:"pointer",width:"100%"},"aria-label":p("ClickToOpenLargeVideo"),onClick:v,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),v())},children:o.jsx("img",{src:s.videos.small.thumbnail,alt:s.tags,className:`${t["video-small"]}`,style:{width:"100%",height:"auto",borderRadius:"8px",cursor:"pointer"}})}),o.jsx("span",{className:"tooltip above narrow2",children:p("ClickToOpenLargeVideo")}),o.jsx("p",{children:o.jsx("small",{children:o.jsxs("a",{href:s.pageURL,target:"_blank",rel:"noreferrer",children:[p("VideoPage")," (",p("Author"),": ",s.user,")"]})})})]},s.id)};export{k as default};
